<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Azure Identity Support Blog</title>
  
  <subtitle>日本マイクロソフトの Azure Active Directory と AD FS に関するサポート情報のブログです。</subtitle>
  <link href="https://jpazureid.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpazureid.github.io/blog/"/>
  <updated>2023-12-09T07:21:28.544Z</updated>
  <id>https://jpazureid.github.io/blog/</id>
  
  <author>
    <name>Azure Identity Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Microsoft Entra の更新情報 (2023 年 11 月)</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra-2023-11/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra-2023-11/</id>
    <published>2023-12-03T01:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.544Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2023 年 11 月 30 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/what-s-new-in-microsoft-entra/ba-p/3796394">What’s new in Microsoft Entra</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>Microsoft はこのほど、組織のセキュリティ態勢の改善を支援することを目的として、Microsoft Entra 製品ファミリーにさまざまな新しいセキュリティ ツールと機能を導入しました。サイバー攻撃がますます巧妙化し、クラウドベースのサービスやモバイル デバイスの利用が増加する中、組織には自らのセキュリティを管理するための効果的なツールの導入が不可欠となっています。</p><p>進化する脅威を先取りし、AI の時代に安全なアクセスを実現するために、今月の <a href="https://ignite.microsoft.com/en-US/home">Microsoft Ignite</a> では、いくつかの重要な発表を行いました:</p><ul><li>ID のリスクへの迅速な対応を支援する Microsoft Entra + Security Copilot。</li><li>Microsoft Defender for Cloud と Microsoft Entra Permissions Management を統合し、マルチクラウド基盤の ID とアクセス許可に関する情報を統合。</li><li>Microsoft マネージド条件付きアクセス ポリシーの自動展開によるお客様の保護</li><li>Microsoft の Security Service Edge (SSE) 製品 (Microsoft Entra Internet Access および Microsoft Entra Private Access) の進化。</li><li>Microsoft Entra 証明書ベース認証 (CBA)。</li></ul><p>詳細は、ブログ「<a href="https://jpazureid.github.io/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/">Microsoft Ignite における ID: AI 時代におけるアクセスのセキュリティ保護</a>」をご覧ください。</p><p>本日は、過去 2 ヶ月間 (2023 年 10 月～ 11 月) の新機能リリースと、2023 年 11 月の変更管理を発表いたします。また、これらの変更点は <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/whats-new">リリース ノート</a> や電子メールでもお知らせしています。弊社では、お客様が新しい <a href="https://entra.microsoft.com/">Entra 管理センター</a> 内でも、非推奨、廃止、およびサービスの破壊的変更を含むライフサイクルの変更を管理しやすくするため、継続して取り組んでおります。</p><p>これらの最近のアップデートは、Microsoft Entra の製品エリアごとに整理しておりますので、最新のアップデートをすばやく見つけてアクセスいただけると存じます。これらの新機能が、より良い ID およびアクセス ソリューションの提供につながれば幸いです。</p><h2 id="製品の更新情報のまとめ"><a href="#製品の更新情報のまとめ" class="headerlink" title="製品の更新情報のまとめ"></a>製品の更新情報のまとめ</h2><ul><li>Microsoft Entra ID</li><li>Microsoft Entra ID Governance</li><li>Microsoft Entra Workload ID</li><li>Microsoft Entra External ID</li><li>Microsoft Entra Permissions Management</li></ul><h2 id="Microsoft-Entra-ID"><a href="#Microsoft-Entra-ID" class="headerlink" title="Microsoft Entra ID"></a>Microsoft Entra ID</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://jpazureid.github.io/blog/azure-active-directory/advancing-modern-strong-authentication/">macOS および iOS におけるネイティブアプリでの FIDO2 サポート</a></li><li><a href="https://techcommunity.microsoft.com/t5/windows-it-pro-blog/what-s-new-with-windows-at-microsoft-ignite-2023/ba-p/3980507#2">AVD と Windows 365 での SSO とパスワードレス認証</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/concept-conditional-access-cloud-apps#microsoft-admin-portals">Microsoft 管理ポータルでの条件付きアクセスのサポート</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/custom-security-attributes-overview">Microsoft Entra ID におけるカスタム セキュリティ属性</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available!/">Microsoft Entra ID を用いた Windows Local Administrator Password ソリューション</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new#general-availability---enhanced-devices-list-management-experience">デバイスを一覧して管理する機能の改善</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/how-to-app-protection-policy-windows">Windows MAM</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new#general-availability---users-cant-modify-gps-location-when-using-location-based-access-control">場所ベースのアクセス管理を利用している場合に GPS の場所の書き変え不可</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions">有料ライセンスを持つテナントのみ Microsoft Entra ID テナントを作成可能に</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new">Android 版 Authenticator が FIPS-140 に準拠</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/whats-new">Chrome の CloudAPAuthEnabled をデバイスベースの条件付きアクセスで利用可能に</a></li></ul><h3 id="変更のアナウンス"><a href="#変更のアナウンス" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="条件付きアクセス-ポリシーの自動展開"><a href="#条件付きアクセス-ポリシーの自動展開" class="headerlink" title="条件付きアクセス ポリシーの自動展開"></a>条件付きアクセス ポリシーの自動展開</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 11 月初めに、リスク情報、ライセンス、および使用状況に基づいて、お客様のテナントを自動的に保護する条件付きアクセス ポリシーの展開を <a href="https://www.microsoft.com/en-us/security/blog/2023/11/06/automatic-conditional-access-policies-in-microsoft-entra-streamline-identity-protection/">発表</a> しました。これは、Microsoft マネージド条件付きアクセス ポリシーと呼ばれるもので、お客様を自動的に保護することをお知らせするものです。このポリシーは、Microsoft が作成し、お客様のテナントで有効になるポリシーです。以下のポリシーが対象となる一部のテナントに展開されます:</p><table><thead><tr><th align="left">ポリシー</th><th align="left">対象のユーザー</th><th align="left">生じる動作</th></tr></thead><tbody><tr><td align="left">Require multifactor authentication for admin portals</td><td align="left">管理者ユーザー</td><td align="left">このポリシーは、特権ロールを持つ管理者を対象とし、それら管理者が Microsoft 管理者ポータルにサインインするときに多要素認証を要求します。</td></tr><tr><td align="left">Require multifactor authentication for per-user multifactor authentication users</td><td align="left">“ユーザーごとの MFA” 機能を使用しているユーザー</td><td align="left">このポリシーは、”ユーザーごとの MFA” 機能を使用しているユーザーに適用され、すべてのクラウド アプリに多要素認証を要求します。これにより “ユーザーごとの MFA” 機能から条件付きアクセスへの移行を促進します。</td></tr><tr><td align="left">Require multifactor authentication for high-risk sign-ins</td><td align="left">Microsoft Entra ID Premium P2 を十分な数お持ちのお客様</td><td align="left">このポリシーはテナントのすべてのユーザーを対象とし、リスクの高いサインイン時に多要素認証と再認証を要求します。</td></tr></tbody></table><p>対象となるすべてのテナントに対して、事前に通知の上、これらのポリシーを段階的に展開していきます。テナントでポリシーが表示されるようになったら、90 日以内にポリシーを確認し、カスタマイズするか、無効にするようご対応ください。この 90 日間は、ポリシーはレポート専用モードとなります。つまり、条件付きアクセスはポリシーを適用することなく、ポリシーが仮に適用された場合の結果をログに記録します。詳細については、ブログ「<a href="https://www.microsoft.com/en-us/security/blog/2023/11/06/automatic-conditional-access-policies-in-microsoft-entra-streamline-identity-protection/">Automatic Conditional Access policies in Microsoft Entra streamline identity protection</a>」を参照ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>サポート チームによる訳注: Microsoft マネージド条件付きアクセス ポリシーの詳細については、サポート チームより日本語のブログ記事である <a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-managed-conditional-access-policies/">Microsoft マネージド条件付きアクセス ポリシー</a> を公開しております。併せてご参照ください。</p></div><h4 id="Azure-AD-Graph-の廃止に関する更新情報"><a href="#Azure-AD-Graph-の廃止に関する更新情報" class="headerlink" title="Azure AD Graph の廃止に関する更新情報"></a>Azure AD Graph の廃止に関する更新情報</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 6 月、弊社は Azure AD Graph API サービスの非推奨化に関する 3 年にわたる事前通知の期間が完了したことを <a href="https://jpazureid.github.io/blog/azure-active-directory/important-azure-ad-graph-retirement-and-powershell-module/">発表</a> しました。このサービスは現在、廃止サイクルに入っており、廃止 (シャットダウン) は段階的に行われる予定です。弊社は、この廃止とMicrosoft Graph への移行に際しお客様を可能な限りサポートするようお約束するとともに、この変更に取り組む中で高い透明性と対話の取り組みを進めて参ることをお約束します。</p><h5 id="Azure-AD-Graph-の廃止-第一段階"><a href="#Azure-AD-Graph-の廃止-第一段階" class="headerlink" title="Azure AD Graph の廃止: 第一段階"></a>Azure AD Graph の廃止: 第一段階</h5><p>Azure AD Graph の廃止の第一段階は、2024 年後半に開始される予定です。具体的な日付は、最低 3 ヶ月前に予告し、その後のアップデートで共有します。</p><p>この第一段階に入ると、特定の日付以降に作成されたアプリケーションは、Azure AD Graph API (<a href="https://graph.windows.net/">https://graph.windows.net</a>) へのリクエスト時にエラーが生じるようになります。弊社ではこの時点で Microsoft Graph への移行が完了していないアプリケーションがまだ存在する可能性があることも承知しておりますので、この時点以降に作成されたアプリケーションが Azure AD Graph API をしばらくの期間延長して利用できるようにするための <strong>オプション設定</strong> を提供する予定です。インストールやセットアップの一環としてアプリケーションを作成および登録するようなソフトウェアをお客様が開発または配布しており、さらにこれらのアプリケーションが Azure AD Graph API にアクセスする必要がある場合は、廃止の影響を避けるために、速やかに移行作業を開始ください。このオプション設定は、アプリケーションの作成後に設定することができ、構成の変更は <a href="https://learn.microsoft.com/ja-jp/graph/applications-authenticationbehaviors?tabs=http">AuthenticationBehaviors</a> のインターフェイスを通して行います。</p><p>この計画の実施時期とオプション設定の構成に関するより詳細なガイダンスは、次回の更新でお知らせする予定です。</p><h5 id="Azure-AD-Graph-API-を使用しているテナント内のアプリケーションを見つけるにはどうしたらよいか？"><a href="#Azure-AD-Graph-API-を使用しているテナント内のアプリケーションを見つけるにはどうしたらよいか？" class="headerlink" title="Azure AD Graph API を使用しているテナント内のアプリケーションを見つけるにはどうしたらよいか？"></a>Azure AD Graph API を使用しているテナント内のアプリケーションを見つけるにはどうしたらよいか？</h5><p>Azure AD Graph API を使用しているテナント内のアプリケーションを特定するための新しい機能の提供に取り組んでいます。この機能は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/monitoring-health/howto-use-recommendations">Microsoft Entra の推奨事項</a> の機能を通じて利用可能になる予定です。この機能は、2024 年初頭に利用可能になる予定です。</p><h5 id="その他に利用可能なツール"><a href="#その他に利用可能なツール" class="headerlink" title="その他に利用可能なツール"></a>その他に利用可能なツール</h5><ul><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-overview">Azure AD Graph から Microsoft Graph にアプリを移行する</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-planning-checklist">Azure AD Graph アプリ移行計画のチェックリスト</a></li><li><a href="https://github.com/microsoft/AzureADGraphApps">Azure AD Graph を使用している可能性のあるアプリを特定するためのスクリプト</a></li><li><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/azuread-msoline-cmdlet-map?view=graph-powershell-1.0">Microsoft Graph PowerShell SDK の PowerShell コマンドレットへの対応表</a></li></ul><h4 id="カスタム-セキュリティ属性に関する監査ログの動作変更"><a href="#カスタム-セキュリティ属性に関する監査ログの動作変更" class="headerlink" title="カスタム セキュリティ属性に関する監査ログの動作変更"></a>カスタム セキュリティ属性に関する監査ログの動作変更</h4><p>[お客様によっては対応が必要です]</p><p>2023 年 10 月より、一般公開に際してカスタム セキュリティ属性の監査ログに変更が加えられます。これにより監査ログを確認しているお客様においては日常業務に影響が出る可能性があります。プレビュー中にカスタム セキュリティ属性の監査ログを参照していた場合、監査ログの確認に関わる運用作業が中断されないようにするため、<strong>2024 年 2 月まで</strong> に以下の対応を実行する必要があります:</p><ul><li>監査ログの新しい出力場所を使用する。</li><li>監査ログを確認するユーザーに「Attribute Log」のロールを割り当てる。</li><li>監査ログをエクスポートする場合は新しい診断設定を作成する。</li></ul><p>詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/custom-security-attributes-manage?tabs=admin-center#changes-to-audit-logs-behavior">監査ログの動作に対する変更</a> を参照ください。</p><h4 id="新規アプリケーションにおける-signInAudience-プロパティの既定値の変更"><a href="#新規アプリケーションにおける-signInAudience-プロパティの既定値の変更" class="headerlink" title="新規アプリケーションにおける signInAudience プロパティの既定値の変更"></a>新規アプリケーションにおける signInAudience プロパティの既定値の変更</h4><p>[お客様による対応は不要です]</p><p>2024 年 3 月以降、Microsoft Graph のアプリケーション API を使用して作成された新しいアプリケーションでは、アプリケーション登録時の「signInAudience」プロパティの既定値が「AzureADandPersonalMicrosoftAccount」から「AzureADMyOrg」に変更されます。弊社の分析によると、ほとんどの新規アプリケーションでは、アプリケーションがテナント外のユーザーに利用されることはありません。この対応により、アプリケーションの応答速度とセキュリティが向上します。アプリケーションの signInAudience についての詳細は、ドキュメント <a href="https://learn.microsoft.com/ja-jp/graph/api/resources/application?view=graph-rest-1.0#signinaudience-values">アプリケーション リソースの種類 - Microsoft Graph v1.0 | Microsoft Learn</a> を参照ください。</p><h4 id="アプリ-インスタンス-ロックが既定で有効になる"><a href="#アプリ-インスタンス-ロックが既定で有効になる" class="headerlink" title="アプリ インスタンス ロックが既定で有効になる"></a>アプリ インスタンス ロックが既定で有効になる</h4><p>[お客様による対応は不要です]</p><p>2024 年 3 月以降、Microsoft Graph のアプリケーション API を使用して作成された新しいアプリケーションでは、既定で「アプリ インスタンス ロック」が有効になります。2023 年 9 月よりワークロード ID 用にアプリ インスタンス ロックと呼ばれる機能が提供されました。この機能により、アプリ開発者は、重要なプロパティを改竄しようとする攻撃者からマルチテナント アプリを保護できます。Entra ID ポータルを使用して作成されたアプリケーションは、すでにこの設定が既定で有効になっておりますので、今後は、MS Graph、PowerShell、SDK などの他のアプリ作成機能でも有効になる予定です。詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/identity-platform/howto-configure-app-instance-property-locks">アプリケーションでアプリ インスタンス プロパティ ロックを構成する方法 - Microsoft identity platform | Microsoft Learn</a> を参照ください。</p><h4 id="従来のプロフィール-ページがマイ-アカウントに置き換わる"><a href="#従来のプロフィール-ページがマイ-アカウントに置き換わる" class="headerlink" title="従来のプロフィール ページがマイ アカウントに置き換わる"></a>従来のプロフィール ページがマイ アカウントに置き換わる</h4><p>[お客様による対応は不要です]</p><p>本年 6 月に、従来のプロフィール ページが新しいページに置き換えられることを <a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-new-feature-and-change-announcements/">発表</a> しました。今後、<strong>2024 年 1 月</strong> までに既存のプロフィール ページ (<a href="https://account.activedirectory.windowsazure.com/r#/profile">https://account.activedirectory.windowsazure.com/r#/profile</a>) がマイ アカウント (<a href="https://www.myaccount.microsoft.com/">https://www.myaccount.microsoft.com</a>) に置き換えられます。マイ アカウントでは、アカウントの詳細、言語、プライバシー設定、セキュリティ情報などを管理することが可能です。マイ アカウントは数年前から利用可能であり、従来のプロフィール ページのすべての機能を備えています。今回の廃止により、お客様はより良く、より先進的な体験に移行されます。自動的に新しいマイ アカウントに遷移するため、お客様による操作は必要ありません。</p><h2 id="Microsoft-Entra-ID-Governance"><a href="#Microsoft-Entra-ID-Governance" class="headerlink" title="Microsoft Entra ID Governance"></a>Microsoft Entra ID Governance</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/app-provisioning/inbound-provisioning-api-concepts">API 駆動型のインバウンドプロビジョニング</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/api/resources/privilegedidentitymanagement-for-groups-api-overview?view=graph-rest-1.0">グループ用の PIM の API</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/hybrid/cloud-sync/exchange-hybrid">Microsoft Entra Cloud 同期が Exchange ハイブリッドの書き戻しをサポート</a></li></ul><h2 id="Microsoft-Entra-Workload-ID"><a href="#Microsoft-Entra-Workload-ID" class="headerlink" title="Microsoft Entra Workload ID"></a>Microsoft Entra Workload ID</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/enterprise-apps/restore-application?tabs=http&pivots=aad-powershell">マネージド サービス ID のソフト デリート機能</a></li></ul><h2 id="Microsoft-Entra-External-ID"><a href="#Microsoft-Entra-External-ID" class="headerlink" title="Microsoft Entra External ID"></a>Microsoft Entra External ID</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/identity/users/clean-up-stale-guest-accounts#monitor-guest-accounts-at-scale-with-inactive-guest-insights-preview">ゲストに対するガバナンス - 利用されていないゲストのレビュー</a></li></ul><h2 id="Microsoft-Entra-Permissions-Management"><a href="#Microsoft-Entra-Permissions-Management" class="headerlink" title="Microsoft Entra Permissions Management"></a>Microsoft Entra Permissions Management</h2><p>新機能の発表は以下のとおりです。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/entra/permissions-management/how-to-configure-servicenow-application">Microsoft Entra Permissions Management と ServiceNow の連携</a></li></ul><p>以上の内容が参考になれば幸いです。</p><p>Shobhit Sahay</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 11 月 30 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommun</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Ignite における ID: AI 時代におけるアクセスのセキュリティ保護</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/</id>
    <published>2023-12-03T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.248Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 五十嵐 です。</p><p>本記事は、2023 年 11 月 15 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/ba-p/2747279">Identity at Microsoft Ignite: Securing access in the era of AI</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>デジタルの世界が拡大し続けるにつれ、サイバーセキュリティのリスクと課題も拡大しています。サイバー攻撃のスペシャリストを抱える悪意ある組織が、国家や犯罪組織から資金提供を受ける一方、我々が守るべき ID、エンドポイント、アプリ、データは増え続けています。また、AI の新時代では、悪意のある攻撃者 (内部犯を含む) が組織に損害を与える方法は数えきれないぐらい存在するでしょう。</p><p>弊社が <a href="https://www.microsoft.com/ja-jp/security/business/microsoft-entra?rtc=1">Microsoft Entra</a> に追加する機能はすべて、進化する脅威の状況を先取りできるようにするためのものです。すべては、お客様が自身の環境をより容易に安全に保てるようにするという 1 つの原則に帰着します。攻撃からの防御を担当するチームを擁する大企業であれ、IT 部門をまったく持たない中小企業であれ、適切なツールを導入し、適切なポリシーを設定するお手伝いをしたいと考えています。<a href="https://ignite.microsoft.com/en-US/home">Microsoft Ignite 2023</a> では、Microsoft Entra の新機能と機能強化を発表しました:</p><p><strong>発表:</strong></p><ul><li>Microsoft Entra + Security Copilot</li><li>Security Service Edge - Microsoft Entra Internet Access および Microsoft Entra Private Access ですべてのアプリケーションとリソースへのアクセスを保護</li><li>Microsoft マネージド条件付きアクセス ポリシーの自動展開</li><li>より強固な権限管理のための機能の統合</li></ul><h2 id="Microsoft-Entra-Security-Copilot"><a href="#Microsoft-Entra-Security-Copilot" class="headerlink" title="Microsoft Entra + Security Copilot"></a>Microsoft Entra + Security Copilot</h2><p>アクセスを保護するには、テクノロジーだけでなく、ビジネス ポリシーや規制についても深く理解する必要があり、時にこれがセキュリティ専門家に過大な業務を負わせることにつながります。この度、<a href="https://www.microsoft.com/ja-jp/security/business/ai-machine-learning/microsoft-security-copilot?rtc=1">Microsoft Security Copilot</a> が Microsoft Entra に追加され、一般的なタスクの自動化、迅速なトラブルシューティング、複雑なポリシーの解釈、ワークフローの設計を支援できるようになりました。</p><p>Microsoft Entra 管理センターでは、Security Copilot に対し、その条件付きアクセス ポリシーが何を行うものなのか、なぜ MFA がトリガーされたのかを、簡単な会話形式で説明してもらうことができます。Security Copilot を使用して、ユーザーがサインインできなかった理由など、ID 関連のトラブルシューティングを行うこともできます。また、組み込みの Security Copilot エクスペリエンスでは、リスクのある各 ID について、リスクの概要、修復手順、推奨ガイダンスが表示され、ID のリスクに迅速に対応できます。ワークフローの作成支援機能を使用して、新入社員のオンボーディングなど、入社、異動、退職のシナリオで ID ガバナンスのライフサイクル ワークフローを構築する際に、より効率的に操作が可能となります。</p><p>セキュリティ インシデントを調査する場合、関連するサインイン ログと監査ログについて Security Copilot に尋ねることで、文脈に基づいた分析情報を得ることができます。そして、特定のユーザー、グループ、ワークロード、サインイン、ロール、セキュリティ アラートなどの詳細を取得することも可能です。Security Copilot の <a href="https://forms.office.com/pages/responsepage.aspx?id=v4j5cvGGr0GRqy180BHbR2sE-_D9S11Ir8rACvMiWdVUREM4TUg1TzNNS0MzNlNBOVQxVEdQV1VLRi4u">プライベート プレビュー</a> に今すぐ登録すると共に、今後のすべての開発に関する最新情報を入手するために、<a href="https://info.microsoft.com/ww-landing-security-ai-interest-form.html?LCID=EN-US">こちらにサインアップ</a> ください。さらに、Microsoft Security Copilot を自社のソリューションで使用したいと考えているセキュリティ パートナーの皆様は、<a href="https://forms.microsoft.com/pages/responsepage.aspx?id=v4j5cvGGr0GRqy180BHbR7GkZxmcvGdGql1aVgLqRR1UNEk0MTVPVjg1VjhPMUJHVTZETlRXSk1RQy4u">Security Copilot パートナー エコシステム</a> にご登録ください。</p><p><img src="/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai1.jpg" alt="Microsoft Entra 管理センターでは、Microsoft Security Copilot が、その条件付きアクセス ポリシーは何をするためのものなのか、なぜ MFA が要求されたのかなどを、簡単な会話形式で説明してくれます。"></p><h2 id="Security-Service-Edge-ですべてのアプリケーションとリソースへのアクセスを保護"><a href="#Security-Service-Edge-ですべてのアプリケーションとリソースへのアクセスを保護" class="headerlink" title="Security Service Edge ですべてのアプリケーションとリソースへのアクセスを保護"></a>Security Service Edge ですべてのアプリケーションとリソースへのアクセスを保護</h2><p>Microsoft の Security Service Edge (SSE) ソリューションは <a href="https://entra.microsoft.com/#view/Microsoft_Azure_Network_Access/Welcome.ReactView">現在プレビュー中</a> で、Microsoft Entra Internet Access と Microsoft Entra Private Access により、ユーザーとデバイスがどこにいようと、あらゆるアプリケーションやリソースへのアクセスを保護します。</p><p>Microsoft の SSE ソリューションと Microsoft Entra 製品群の統合により、あらゆるアプリケーションや Web サイトへのアクセスを許可する前に、ID、デバイス、アプリケーション、さらに今後はネットワークの条件を考慮した、統合された条件付きアクセス ポリシーを適用することが可能になります。これは、アプリケーションがどの ID プロバイダーを使用しているかに関係なく、さらにアプリケーションに変更を加えることなく機能します。</p><p><img src="/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai2.png"></p><p>皆様の多くが既にお試しの <a href="https://www.microsoft.com/ja-jp/security/business/identity-access/microsoft-entra-internet-access?rtc=2">Microsoft Entra Internet Access</a> は、Microsoft 365 トラフィックを安全に保つための ID 中心のセキュア Web ゲートウェイ (SWG) です。弊社は、2023 年末までにすべてのインターネット アプリとリソースを含むようにパブリック プレビューを拡張し、次のような新しいコア機能を追加する予定です:</p><ul><li><strong>アクセスの文脈を考慮した SWG</strong>: Web コンテンツフィルタリング機能を備えたもので、エンド ユーザーによる安全でないコンテンツやコンプライアンス違反のコンテンツへのアクセスを制限します。</li><li><strong>ユニバーサル条件付きアクセス</strong>: 外部 Web サイトやフェデレーション連携していない SaaS アプリケーションなど、あらゆるネットワークの宛先に適応型のアクセス制御を拡張します。</li><li><strong>準拠済みネットワークのチェック機能</strong>: これは条件付きアクセスにて利用できる、管理のしやすい追加機能です。この機能により、Microsoft Entra に統合された統合クラウド アプリケーションをトークンの盗難から保護し、ユーザーを重要なクラウド サービスにアクセスさせつつ、テナント固有のネットワーク セキュリティ ポリシーを確実に適用できるようにします。</li><li><strong>アクセス元 IP の復元機能</strong> が ID Protection と条件付きアクセスの場所のポリシーで利用可能となります。これにより、各ユーザーの本来のアクセス元 IP を維持し、信頼できる場所のチェックと継続的なアクセス評価、ID リスクの検出、およびログ記録の下位互換性が可能となります。</li></ul><p><a href="https://www.microsoft.com/ja-jp/security/business/identity-access/microsoft-entra-private-access?rtc=1">Microsoft Entra Private Access</a> は、あらゆる社内アプリケーションやリソースのための、ID を中心としたゼロ トラスト ネットワーク アクセス (ZTNA) です。プライベート プレビューの新機能は以下のとおりです:</p><ul><li>TCP に加えて、UDP やプライベート DNS などより多くのプロトコルをサポートします。これにより、従来の仮想プライベート ネットワーク (VPN) から最新の ZTNA ソリューションに移行が可能となります。</li><li>条件付きアクセス制御に加え、多要素認証 (MFA) などの最新の認証方式により、リモート ユーザーとオンプレミス ユーザーによるすべての社内アプリケーションおよびリソースへのアクセスを保護します。</li></ul><p>当社の SSE ソリューションは、Microsoft のセキュリティ スタックおよびオープン パートナー エコシステム全体にわたる統合を通じて、お客様の既存のセキュリティおよびネットワーク ソリューションと連携が可能です。弊社では、<a href="https://docs.netskope.com/en/netskope-help/integrations-439794/solution-guides/microsoft-security-and-netskope-integration-solution-guide/microsoft-and-netskope-sse-coexistence/">Netskope</a> を始めとするこの分野の他のベンダーと提携し、同じ環境でのシームレスな相互運用を実証中です。お客様の環境のネットワーク トラフィックに対し、最適な SSE ソリューションを柔軟に選択できるようにすることをお約束します。併せて、Internet Access と Private Access の両方について、Windows と Android に対するクロス OS のクライアントサポートが現在パブリックプレビューにあること、また MacOS と iOS のサポートもプライベート プレビューにあることも発表しました。SSE ソリューションは現在、中国とロシアを除く全世界で利用可能であり、将来的には SSE のエッジ ロケーションも提供される予定です。</p><p>近日開催予定の <a href="https://techcommunity.microsoft.com/t5/tech-community-live/microsoft-security-tech-accelerator/ec-p/3968748#M20">Tech Accelerator Ask Microsoft Anything (AMA) セッション</a> に是非参加し、Microsoft の SSE ソリューションに関するあらゆる疑問について製品のエキスパートにご相談ください。</p><h2 id="Microsoft-マネージド条件付きアクセス-ポリシーの自動ロールアウトなど"><a href="#Microsoft-マネージド条件付きアクセス-ポリシーの自動ロールアウトなど" class="headerlink" title="Microsoft マネージド条件付きアクセス ポリシーの自動ロールアウトなど"></a>Microsoft マネージド条件付きアクセス ポリシーの自動ロールアウトなど</h2><p>昨年、弊社では約 700 万の既存テナントに対して Microsoft Entra ID (旧 <a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/new-name">Azure Active Directory</a>) のセキュリティの既定値群を有効にし、これらのテナントにおける侵害の件数を 80% 削減しました。お客様からの好意的なフィードバックに基づき、弊社ではさらに、お客様のリスク情報、現在の使用状況、およびライセンスに基づいて、対象となるテナントに条件付きアクセス ポリシーを自動的に作成することで、より多くの Microsoft Entra ID のお客様が自身を保護できるよう支援してまいります。<strong>Microsoft マネージド条件付きアクセス ポリシー</strong> が展開されると、リスクが高いと想定されるシナリオにて多要素認証 (MFA) を実施する 3 つのポリシーが作成されます。詳細については、Alex Weinert の最近のブログ記事 <a href="https://www.microsoft.com/en-us/security/blog/2023/11/06/automatic-conditional-access-policies-in-microsoft-entra-streamline-identity-protection/">Automatic Conditional Access policies in Microsoft Entra streamline identity protection</a> をご覧ください。</p><p><img src="/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai3.png" alt="こちらが Microsoft マネージド条件付きアクセス ポリシーが作成されたテナントです。ポリシーの詳細が右側のコンテキスト ウィンドウに表示されています。選択されているポリシーでは、特定の管理者ロールが Microsoft 管理ポータルにアクセスする際に多要素認証の実施を必須とすることが示されています。"></p><p>しかし、すべての MFA の方法が同等にユーザーを保護するわけではありません。FIDO2 セキュリティ キー、Windows Hello、**Microsoft Entra 証明書ベース認証 (CBA)**、パスキーなど、より効果的な MFA の方法では暗号技術が使用されており、認証にフィッシング耐性が付与されます。Microsoft Entra CBA のプレビューでは、証明書、リソースの種類、ユーザーおよびグループごとに認証ポリシーを調整することが可能です。これらのフィッシングに強い認証方式により、パスワードを完全に排除することが可能になり、パスワードの推測、傍受、フィッシングを防ぐことが可能となります。</p><p>Microsoft は、Windows 11 を皮切りに、エコシステム全体でパスキーのサポートに取り組んでいます。Windows Hello を使用して Web サイト、アプリケーション、またはサービスのパスキーを作成すると、顔、指紋、またはデバイスの PIN を使用してデバイスからサインイン可能となります。これにより、企業や政府機関のお客様は、物理的な FIDO2 セキュリティ キーに代わる、フィッシングに強い新たな選択肢を得ることができます。Microsoft Entra ID ユーザーは、まもなく <strong>Microsoft Authenticator アプリ</strong> にて管理されるパスキーを使用してサインインできるようになります。</p><p><img src="/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai4.png"></p><p>最後に、<a href="https://www.microsoft.com/ja-jp/security/business/identity-access/microsoft-entra-id-protection?rtc=1">Microsoft Entra ID Protection</a> では、トークンの有効期間が異常に長い場合や、なじみのない場所からトークンが再生された場合などの異常を検出するようになりました。アラートが上がると、条件付きアクセスを用いて直ちにトークンを失効させ、パスワードのリセットやステップアップ MFA などの他の対策とともに、管理者による手動での介入を必要とせずに再認証を強制することができます。また、ユーザーがオンプレミスでパスワードを変更した場合に、Entra ID Protection は <a href="https://jpazureid.github.io/blog/azure-active-directory/Remediate-User-Risks-in-Microsoft-Entra-ID-Protection-Through-On-premises-Password-Changes/">自動的にリスクを修復</a> できるようになりました。これにより、ハイブリッド組織はユーザー リスク ポリシーをより簡単に利用できるようになります。</p><h2 id="より強固な権限管理のための機能の統合"><a href="#より強固な権限管理のための機能の統合" class="headerlink" title="より強固な権限管理のための機能の統合"></a>より強固な権限管理のための機能の統合</h2><p><a href="https://www.microsoft.com/ja-jp/security/business/identity-access/microsoft-entra-permissions-management?rtc=1">Microsoft Entra Permissions Management</a> は、このたび権限リスクに関する分析情報を提供する 2 つの重要な統合機能を備えました。これにより、お客様はよりセキュリティ態勢を改善できるようになります。</p><p><a href="https://learn.microsoft.com/ja-jp/entra/permissions-management/permissions-management-for-defender-for-cloud">Microsoft Defender for Cloud (MDC) 統合</a> のプレビューは、ID とアクセス許可に関する分析情報を他のクラウド セキュリティ情報と統合し、単一のインターフェイスで表示します。このビューでは、権限リスクに対処するための実用的な推奨事項やアクセス許可のクリープ インデックスが表示され、Azure、Amazon Web Services (AWS)、Google Cloud のクラウド リソースに対して最小権限でのアクセスを簡単に実施できるようになります。</p><p><img src="/blog/azure-active-directory/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai/identity-at-microsoft-ignite-securing-access-in-the-era-of-ai5.png" alt="Microsoft Entra Permissions Management と Microsoft Defender for Cloud (MDC) (現在パブリック プレビュー中) の統合により、他のクラウドのセキュリティ態勢に関する分析情報を単一のインターフェイスに統合して効率的に確認できるようになります。"></p><p>このたび一般提供が開始された <a href="https://learn.microsoft.com/ja-jp/entra/permissions-management/how-to-configure-servicenow-application">2 つ目の統合</a> により、ServiceNow のお客様は、ServiceNow ポータルを介してマルチクラウド環境 (Azure、AWS、Google Cloud) に対し、期限付きのオンデマンド許可を要求できるようになりました。IT サービス管理 (ITSM) ソリューションは多くのお客様で利用されているため、ServiceNow の既存の承認ワークフローにアクセス許可要求を追加することで、ゼロ トラストの体制より強化することが可能となります。ユーザーがアクセス承認を要求すると、ServiceNow のプラグインが Permissions Management から最新のデータを取得し、要求されたユーザー権限を要求者のロールに基づく期限付きの承認とともに ServiceNow に送り返します。</p><h2 id="進化するセキュアな-ID-とネットワーク-アクセス"><a href="#進化するセキュアな-ID-とネットワーク-アクセス" class="headerlink" title="進化するセキュアな ID とネットワーク アクセス"></a>進化するセキュアな ID とネットワーク アクセス</h2><p>包括的な機能を備えた Microsoft Entra という単一の統合ソリューションを採用することで、管理者のアクセス セキュリティを簡素化し、エンドユーザにより良い体験を提供することができます。</p><p>Microsoft Entra の製品群は互いに連携し、お客様の ID、デバイス、ネットワーク、およびワークロードのセキュリティを保護してまいります。これは、特定のユーザーの種類に限らず、お客様、パートナー、デジタル ワークロードなど、あらゆる種類に対応が可能です。そして今、Microsoft Entra は SSE ソリューションによって、ID とネットワークのアクセス制御を単一のポリシー エンジンに統合させようと取り組んでいます。</p><p>Microsoft Entra の最新のイノベーションにより、すべての人のあらゆるものへのアクセスを簡単に保護できるようになることを願っています。</p><p>最近の発表の詳細については、Ignite 2023 での私のセッション <a href="https://ignite.microsoft.com/en-US/sessions/07952ef8-8603-4a94-8185-975ae95e53bb?source=sessions">Secure access in the AI era: What’s new in Microsoft Entra</a> をご覧ください。</p><h2 id="詳細はこちら"><a href="#詳細はこちら" class="headerlink" title="詳細はこちら"></a>詳細はこちら</h2><p>Microsoft のセキュリティ ソリューションの詳細については、<a href="https://www.microsoft.com/ja-jp/security/?rtc=1">当社の Web サイト</a> をご覧ください。<a href="https://www.microsoft.com/en-us/security/blog/">セキュリティ ブログ</a> をブックマークしておくと、セキュリティに関する最新情報をチェックできます。また、<a href="https://twitter.com/MSFTSecurity">@MSFTSecurity</a> でサイバーセキュリティに関する最新ニュースや最新情報をフォローください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 五十嵐 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 11 月 15 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommu</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ID に必要な通信先エンドポイントのまとめ</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/azure-ad-endpoints/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/azure-ad-endpoints/</id>
    <published>2023-12-01T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.952Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure &amp; Identity サポート チームの大庭です。</p><p>今回はよくご質問をいただく Microsoft Entra ID をご利用いただく際に必要となるエンドポイント (URL/IP アドレス) について案内します。Microsoft Entra ID においては認証からアカウント管理、アカウント同期に至るまで複数のサービスを提供しており、ご利用いただく機能によってアクセス先のエンドポイントが異なります。お客様によっては、ネットワーク プロキシにて厳密に接続可能なエンドポイント (URL) 先を制御されている場合があり、そういった制御を行われているお客様では、正常にサービスを利用するために個別にエンドポイント (URL/IP アドレス) への通信を許可する必要があります。</p><p>本記事においては、現時点で提供している Microsoft Entra ID の各サービスに関し、必要となるエンドポイントを記載した公開資料へのリンクをまとめます。これにより、「どのエンドポイントに対してアクセス許可をすればいいのかまとめて知りたい！」といったご要望にお応え出来たら幸いです。</p><div class="alert is-info"><p class="alert-title">Note</p><p>サポート チームにて可能な限り迅速かつ網羅的な情報の更新に努めておりますが、本記事にてすべての情報の網羅ができているわけではありません。サービスが利用するエンドポイントはドキュメントの更新とともに変化する可能性があります。正式な案内については各公開情報を参照いただくか、弊社サポート サービスまでお問い合わせください。</p></div><h2 id="Microsoft-Entra-ID-で基本的に利用されるエンドポイント"><a href="#Microsoft-Entra-ID-で基本的に利用されるエンドポイント" class="headerlink" title="Microsoft Entra ID で基本的に利用されるエンドポイント"></a>Microsoft Entra ID で基本的に利用されるエンドポイント</h2><p>まず初めに Microsoft Entra ID を利用いただく際に基本的に必要となるエンドポイントは、<a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide#microsoft-365-common-and-office-online">Office 365 の URL と IP アドレスの範囲</a> に記載されている ID 56 , ID 59 そして ID 125 になります。こちらは Microsoft 365 を利用する際に Micorosft Entra ID を利用するシナリオで最低限必要となるエンドポイントをまとめたものです。Microsoft Entra ID をご利用いただく際は、認証を行うクライアントからこれらのエンドポイントについてネットワークの疎通を確保ください。</p><h2 id="Microsoft-Entra-ID-でデバイス管理に利用するエンドポイント"><a href="#Microsoft-Entra-ID-でデバイス管理に利用するエンドポイント" class="headerlink" title="Microsoft Entra ID でデバイス管理に利用するエンドポイント"></a>Microsoft Entra ID でデバイス管理に利用するエンドポイント</h2><p>Entra ID では Microsoft Entra ハイブリッド参加、Microsoft Entra 参加そして Microsoft Entra 登録、という 3 つの方法でデバイスを登録することができます。いずれの方法を利用する場合でも、<a href="https://learn.microsoft.com/ja-jp/entra/identity/devices/how-to-hybrid-join#network-connectivity-requirements">Microsoft Entra ハイブリッド参加を構成する</a> のページに記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Entra-ID-にて利用規約を利用するエンドポイント"><a href="#Microsoft-Entra-ID-にて利用規約を利用するエンドポイント" class="headerlink" title="Microsoft Entra ID にて利用規約を利用するエンドポイント"></a>Microsoft Entra ID にて利用規約を利用するエンドポイント</h2><p>Microsoft Entra ID にて利用規約を利用する場合は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/terms-of-use#frequently-asked-questions">Microsoft Entra の利用規約のよく寄せられる質問</a> のページにある “Q: 利用規約サービスにはどのエンドポイントが認証に使用されますか？” に記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Entra-Connect-に関連するエンドポイント"><a href="#Microsoft-Entra-Connect-に関連するエンドポイント" class="headerlink" title="Microsoft Entra Connect に関連するエンドポイント"></a>Microsoft Entra Connect に関連するエンドポイント</h2><p>Microsoft Entra Connect を利用して、ハイブリッド ID ソリューション (オンプレミスからのアカウントの同期) を利用される際に必要な URL と IP アドレスの一覧については上記の「Microsoft Entra ID で基本的に利用されるエンドポイント」の節をご覧ください。また併せて、<a href="https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/tshoot-connect-connectivity">Microsoft Entra Connect の接続に関する問題のトラブルシューティング</a> のページも参照をお勧めします。開放が必要なネットワーク ポートとプロトコルについては、<a href="https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/reference-connect-ports">ハイブリッド ID で必要なポートとプロトコル</a> のページにも説明がありますのでご覧ください。</p><h2 id="Microsoft-Entra-Connect-Health-Service-に利用するエンドポイント"><a href="#Microsoft-Entra-Connect-Health-Service-に利用するエンドポイント" class="headerlink" title="Microsoft Entra Connect Health Service に利用するエンドポイント"></a>Microsoft Entra Connect Health Service に利用するエンドポイント</h2><p>Microsoft Entra Connect Health Service を利用する場合は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/how-to-connect-health-agent-install#outbound-connectivity-to-azure-service-endpoints">Microsoft Entra Connect Health エージェントのインストール</a> ページに記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Entra-アプリケーション-プロキシ-コネクタにて利用されるエンドポイント"><a href="#Microsoft-Entra-アプリケーション-プロキシ-コネクタにて利用されるエンドポイント" class="headerlink" title="Microsoft Entra アプリケーション プロキシ コネクタにて利用されるエンドポイント"></a>Microsoft Entra アプリケーション プロキシ コネクタにて利用されるエンドポイント</h2><p>Microsoft Entra アプリケーション プロキシ コネクタを利用される際は、<a href="https://docs.microsoft.com/ja-jp/azure/active-directory/app-proxy/application-proxy-add-on-premises-application#prepare-your-on-premises-environment">アプリケーション プロキシを使用してオンプレミス アプリを追加する</a> ページに記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Entra-プロビジョニング-サービスを利用する-IP-アドレスの範囲"><a href="#Microsoft-Entra-プロビジョニング-サービスを利用する-IP-アドレスの範囲" class="headerlink" title="Microsoft Entra プロビジョニング サービスを利用する IP アドレスの範囲"></a>Microsoft Entra プロビジョニング サービスを利用する IP アドレスの範囲</h2><p>Microsoft Entra プロビジョニング サービスを利用する場合は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/app-provisioning/use-scim-to-provision-users-and-groups#ip-ranges">チュートリアル: Microsoft Entra ID の SCIM エンドポイントのプロビジョニング</a> に記載されている IP アドレスの範囲を参照ください。</p><h2 id="オンプレミスにある-Multi-Factor-Authentication-Server-が利用するエンドポイント"><a href="#オンプレミスにある-Multi-Factor-Authentication-Server-が利用するエンドポイント" class="headerlink" title="オンプレミスにある Multi-Factor Authentication Server が利用するエンドポイント"></a>オンプレミスにある Multi-Factor Authentication Server が利用するエンドポイント</h2><p>2024 年 9 月 30 日にサービスの提供終了がアナウンスがされていますが、オンプレミスの MFA サーバーを利用する場合は、<a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/howto-mfaserver-deploy#azure-multi-factor-authentication-server-firewall-requirements">Azure Multi-Factor Authentication Server のファイアウォールの要件</a> に記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Private-Access-用にアプリケーション-プロキシ-コネクタにて利用されるエンドポイント"><a href="#Microsoft-Private-Access-用にアプリケーション-プロキシ-コネクタにて利用されるエンドポイント" class="headerlink" title="Microsoft Private Access 用にアプリケーション プロキシ コネクタにて利用されるエンドポイント"></a>Microsoft Private Access 用にアプリケーション プロキシ コネクタにて利用されるエンドポイント</h2><p>Microsoft Entra Private Access 用にアプリ プロキシ コネクタについては、<a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-configure-connectors#allow-access-to-urls">Microsoft Entra Private Access 用にアプリ プロキシ コネクタを構成する方法</a> に記載されているエンドポイントを許可ください。</p><h2 id="Microsoft-Azure-管理センターおよび一般的なサービスに利用されるエンドポイント"><a href="#Microsoft-Azure-管理センターおよび一般的なサービスに利用されるエンドポイント" class="headerlink" title="Microsoft Azure 管理センターおよび一般的なサービスに利用されるエンドポイント"></a>Microsoft Azure 管理センターおよび一般的なサービスに利用されるエンドポイント</h2><p>Microsoft Entra ID の認証ではないですが、Azure ポータルや一般的なアカウント サービスに必要となるエンドポイントは、<a href="https://learn.microsoft.com/ja-jp/azure/azure-portal/azure-portal-safelist-urls?tabs=public-cloud">ファイアウォールまたはプロキシ サーバーで Azure portal の URL を許可する</a> のページに記載されているエンドポイントを許可ください。</p><p>今後、Entra ID をご利用いただく際に本ブログの内容が少しでも参考となりますと幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure &amp;amp; Identity サポート チームの大庭です。&lt;/p&gt;
&lt;p&gt;今回はよくご質問をいただく Microsoft Entra ID をご利用いただく際に必要となるエンドポイント (URL/IP アドレス) について案内します。Microsof</summary>
      
    
    
    
    
    <category term="Entra ID" scheme="https://jpazureid.github.io/blog/tags/Entra-ID/"/>
    
    <category term="Network" scheme="https://jpazureid.github.io/blog/tags/Network/"/>
    
  </entry>
  
  <entry>
    <title>エンタイトルメント管理におけるカスタム拡張機能の利用方法</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/access-package-with-custom-extension/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/access-package-with-custom-extension/</id>
    <published>2023-11-26T01:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.880Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>今回は、Microsoft Entra ID のエンタイトルメント管理 (アクセス パッケージ) の機能をより活用できる、カスタム拡張機能について紹介します。</p><p>今回の記事は、アクセス パッケージを既にご利用いただいており、基本的な操作を理解いただいている方をターゲットとした、中級者向けの案内です。アクセス パッケージを初めて触るお客様や、これから導入を検討されているお客様などで基本的な概要を確認されたい場合、以前公開いたしました以下の記事を先にご覧ください。</p><p><a href="https://jpazureid.github.io/blog/azure-active-directory/access-management-with-access-package/">アクセス パッケージを利用した一括でのアクセス権の管理</a></p><p>今回は、カスタム拡張機能を利用した操作の例を紹介します。次回の記事にて、ライフサイクル ワークフローとこのアクセス パッケージのカスタム拡張機能を利用した上級編シナリオのご紹介を予定しております。まずは本記事にて基本的な手順や利用方法を確認いただければと思います。</p><h2 id="カスタム拡張機能とは"><a href="#カスタム拡張機能とは" class="headerlink" title="カスタム拡張機能とは"></a>カスタム拡張機能とは</h2><p>アクセス パッケージに対する要求や割り当て期限が迫っている時など特定のイベントについて、事前に設定したカスタム タスクを実行する機能です。アクセス パッケージを作成するときに、任意項目なのでスキップしてしまいがちですが、以下のように「カスタム拡張機能」を指定するよう構成することができます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension1.png"></p><p>たとえば上記スクリーンショットでは、アクセス パッケージの割り当てが行われたことを E メールで通知するようにカスタム拡張機能を構成しています。その他にもカスタム拡張機能の実行のタイミングとして以下を選択可能です。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension2.png"></p><p>カスタム拡張機能自体は「カタログ」内に項目があり、以下から新しい拡張機能を作成することができます。また、以下の例では PackageTask1 というロジック アプリにカスタム拡張機能を紐づけ、カスタム拡張機能が呼び出されるとこのロジック アプリが実行される仕組みになっています。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension3.png"></p><p>ロジック アプリを呼び出した後、具体的にどんな処理を行わせたいかは、お客様側で自由に記載することができます。また、プログラミング スキルがなくても、以下のようなデザイナーを使って、どのような処理を行いたいかを GUI 上で構成することが可能です。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension4.png"></p><h2 id="事前に理解いただきたいこと"><a href="#事前に理解いただきたいこと" class="headerlink" title="事前に理解いただきたいこと"></a>事前に理解いただきたいこと</h2><ul><li>ロジック アプリと連携するためには、事前に Azure サブスクリプションの用意が必要です。</li><li>ロジック アプリ側で課金が発生します。<strong>コスト面も必ず評価のうえご利用ください。</strong></li><li>アクセス パッケージの機能については、 Microsoft Entra ID Premium P2 ライセンスが必要ですが、カスタム拡張属性も利用したい場合、<strong>新しい Microsoft Entra ID Governance ライセンスが必要です。</strong></li><li>スクリプト作成支援と同様、<strong>ロジック アプリの具体的な記載方法などについてはサポートでは支援が難しい場合があります。</strong> ロジック アプリの作成方法などはロジック アプリの観点で支援が可能ですが、具体的にデザイナーにどのような処理を記載すればよいのか、コードとしてどのような記載を行えばよいのかといった支援は、スクリプト代行と同等となりますため、ロジックアプリ観点、アクセス パッケージ観点の双方でも案内が難しいことが考えられます。「ユーザーを取得したいが、利用する Microsoft Graph API はどれか？」といったご質問であれば対応可能です。</li></ul><p>可能な限り本ブログで機能については解説いたしておりますが、基本的には <a href="https://learn.microsoft.com/ja-jp/entra/id-governance/entitlement-management-logic-apps-integration">エンタイトルメント管理でカスタム拡張機能を使用して Logic Apps をトリガーする</a> を参考いただき、まずはお客様側で実装いただけますと幸いです。</p><h2 id="実際の構成例"><a href="#実際の構成例" class="headerlink" title="実際の構成例"></a>実際の構成例</h2><p>アクセス パッケージを割り当てた時に追加で実施したいタスクとして、「割り当てられたユーザーのプロパティ変更」や「割り当てられたユーザーへの E メール送信」などが挙げられます。今回は、アクセス パッケージが割り当てられたら「割り当てられたユーザーの部署 (department 属性) および ExtenrionAttribute1 属性を変更する」、「変更された旨と、パッケージ内のリソース リンクをユーザーに E メール通知する」といった拡張機能を実装してみたいと思います。手順は大きく分けて 4 つあります。</p><ol><li>カタログにカスタム拡張機能を追加し、ロジック アプリを作成する</li><li>カスタム拡張機能をアクセス パッケージに紐づける</li><li>マネージド ID を用意し、権限を付与する</li><li>ロジック アプリ内でどのような操作をするか記載する</li></ol><p>順に以下に案内しておりますが、手順は下記公開情報と同様になりますので、併せて参考となれば幸いです。</p><p><a href="https://learn.microsoft.com/ja-jp/entra/id-governance/entitlement-management-logic-apps-integration">エンタイトルメント管理でカスタム拡張機能を使用して Logic Apps をトリガーする</a></p><h3 id="1-カタログにカスタム拡張機能を追加しロジック-アプリを作成する"><a href="#1-カタログにカスタム拡張機能を追加しロジック-アプリを作成する" class="headerlink" title="1. カタログにカスタム拡張機能を追加しロジック アプリを作成する"></a>1. カタログにカスタム拡張機能を追加しロジック アプリを作成する</h3><ol><li><p>Azure ポータルにサインインし、[Azure Active Directory] - [Identity Governance] - [カタログ] - [新しいカタログ] よりカタログを作成します。名前と説明を入力し、作成ください。カタログはアクセス パッケージに含めることが出来るリソース (グループ、アプリケーション、SPO サイト) を纏めるために利用します。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension5.png"></p></li><li><p>作成したカタログについて、メニューから [カスタム拡張機能] を選択し [カスタム拡張機能の追加] をクリックします。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension6.png"></p></li><li><p>カスタム拡張機能に名前と説明を付けます。どのようなカスタム タスクが実行されるかを説明に記載しておくと分かりやすいです。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension7.png"></p></li><li><p>アクセス パッケージにこの拡張機能を紐づける時、どのようなタイミングでトリガーされるかを指定します。今回は「要求ワークフロー」を指定します。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension8.png"></p></li><li><p>ロジック アプリの実行中に、アクセス パッケージの割り当て処理などを一時停止するかを指定します。今回は department 属性を正しく変更し E メールが送信できたら処理を再度開始したいので、「起動して待機」を指定します。待機時間などは既定値のままですが、任意に変更できます。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension9.png"></p></li><li><p>このカスタム拡張機能に紐づけるロジック アプリを作成します。サブスクリプションとリソース グループを選択し、ロジック アプリの名前を指定して、「ロジック アプリの作成」をクリックします。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension10.png"></p></li><li><p>ロジック アプリのデプロイが完了するのを待機します。以下のように成功メッセージが表示されれば次へ進みます。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension11.png"></p></li><li><p>最終確認画面で作成をクリックすれば完了です。</p></li><li><p>下記のように、一覧に表示されていることを確認します。</p><p> <img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension12.png"></p></li></ol><h3 id="2-カスタム拡張機能をアクセス-パッケージに紐づける"><a href="#2-カスタム拡張機能をアクセス-パッケージに紐づける" class="headerlink" title="2. カスタム拡張機能をアクセス パッケージに紐づける"></a>2. カスタム拡張機能をアクセス パッケージに紐づける</h3><p>既存のパッケージ ポリシーを開き、上記で作成したカスタム拡張機能を紐づけます。具体的には、ポリシーの作成/編集画面において、ステージ (いつ実行するか) とカスタム拡張機能 (何を実行するか) を指定します。今回は、「割り当てが付与されたときに customextension1 というタスクを実行する」ようにしました。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension13.png"></p><h3 id="3-マネージド-ID-を用意し権限を付与する"><a href="#3-マネージド-ID-を用意し権限を付与する" class="headerlink" title="3. マネージド ID を用意し権限を付与する"></a>3. マネージド ID を用意し権限を付与する</h3><p>今回のロジック アプリでは「割り当てられたユーザーの部署 (department 属性) および ExtenrionAttribute1 属性を変更する」、「変更された旨と、パッケージ内のリソース リンクをユーザーに E メール通知する」という 2 つのタスクを Microsoft Graph API を利用して実現します。呼び出されたロジック アプリで Graph API クエリを実行するためには、ロジック アプリ内で認証を構成する必要があります。Microsoft Entra ID にアプリを作成してクライアント シークレットなどを利用して認証を行うこともできますが、今回はマネージド ID を利用する方法を紹介します。</p><p>上記で作成されたロジック アプリにアクセスし、 ID を開くと、マネージド ID の状態が表示されます。既定ではオフになっています。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension14.png"></p><p>オンに変更すると、以下のメッセージが表示されるので「はい」を選択します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension15.png"></p><p>システム割り当てマネージド ID が有効化されたことを確認します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension16.png"></p><p>有効になると、マネージド ID のオブジェクト ID が表示されるので確認し、ID を控えます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension17.png"></p><p>Microsoft Entra ID - [エンタープライズ アプリケーション] を開き、「アプリケーションの種類」フィルターを “マネージド ID” にしたうえで先ほどの ID を入力し、アプリがあることを確認します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension18.png"></p><p>グローバル管理者の権限で PowerShell を開き、以下のコマンドを実行して マネージド ID に Graph API の権限を付与します。実際にこのマネージド ID でどのような操作を行わせたいかによって、付与する権限は変わりますが、今回はユーザーのプロパティ更新と E メールの送付をしたいので、ここではそれぞれ必要となる権限である Directory.ReadWrite.All と Mail.Send を付与します。</p><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># グローバル管理者でサインインします。</span></span><br><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Scopes</span> <span class="string">&quot;Application.Read.All&quot;</span>,<span class="string">&quot;AppRoleAssignment.ReadWrite.All&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$graph</span>= <span class="built_in">Get-MgServicePrincipal</span> <span class="literal">-Filter</span> <span class="string">&quot;AppId eq &#x27;00000003-0000-0000-c000-000000000000&#x27;&quot;</span></span><br><span class="line"><span class="variable">$directoryReadWritePermission</span>= <span class="variable">$graph</span>.AppRoles | <span class="built_in">Where-Object</span> Value <span class="operator">-eq</span> <span class="string">&quot;Directory.ReadWrite.All&quot;</span>| <span class="built_in">Where-Object</span> AllowedMemberTypes <span class="operator">-contains</span> <span class="string">&#x27;Application&#x27;</span> | <span class="built_in">Select-Object</span> <span class="literal">-First</span> <span class="number">1</span></span><br><span class="line"><span class="variable">$mailSendPermission</span> = <span class="variable">$graph</span>.AppRoles | <span class="built_in">Where-Object</span> Value <span class="operator">-eq</span> <span class="string">&quot;Mail.Send&quot;</span> | <span class="built_in">Where-Object</span> AllowedMemberTypes <span class="operator">-contains</span> <span class="string">&#x27;Application&#x27;</span> | <span class="built_in">Select-Object</span> <span class="literal">-First</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上の手順で確認したマネージド ID の Object ID を以下の &lt;ObjectID&gt; 部分に代入します。</span></span><br><span class="line"><span class="variable">$msi</span>= <span class="built_in">Get-MgServicePrincipal</span> <span class="literal">-ServicePrincipalId</span> &lt;ObjectID&gt; </span><br><span class="line"></span><br><span class="line"><span class="built_in">New-MgServicePrincipalAppRoleAssignedTo</span> <span class="literal">-ServicePrincipalId</span> <span class="variable">$graph</span>.Id <span class="literal">-AppRoleId</span> <span class="variable">$directoryReadWritePermission</span>.Id <span class="literal">-ResourceId</span> <span class="variable">$graph</span>.Id <span class="literal">-PrincipalId</span> <span class="variable">$msi</span>.Id</span><br><span class="line"><span class="built_in">New-MgServicePrincipalAppRoleAssignedTo</span> <span class="literal">-ServicePrincipalId</span> <span class="variable">$graph</span>.Id <span class="literal">-AppRoleId</span> <span class="variable">$mailSendPermission</span>.Id <span class="literal">-ResourceId</span> <span class="variable">$graph</span>.Id <span class="literal">-PrincipalId</span> <span class="variable">$msi</span>.Id</span><br></pre></td></tr></table></figure><p>マネージド ID に権限が割り当てられると、以下のように [アクセス許可] タブに権限が表示されますので確認します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension19.png"></p><p>次に、ユーザー管理者ロールをマネージド ID に付与しておきます。Microsoft Entra ID の [ロールと管理者] から「ユーザー管理者」ロールを検索します (ユーザーの属性を編集するために本ロールが必要なためです)。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension20.png"></p><p>メンバーの選択の項目をクリックし、マネージド ID と同じ名前のアプリケーションを選択します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension21.png"></p><p>アプリケーションのロール割り当てに関しては、アクティブな割り当てのみがサポートされています。この警告は気にせずに先に進んで問題ありません。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension22.png"></p><p>アクティブが選択されていることを確認のうえ、ロールを付与します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension23.png"></p><h3 id="4-ロジック-アプリ内でどのような操作をするか記載する"><a href="#4-ロジック-アプリ内でどのような操作をするか記載する" class="headerlink" title="4. ロジック アプリ内でどのような操作をするか記載する"></a>4. ロジック アプリ内でどのような操作をするか記載する</h3><p>上記までできたら、実際にロジック アプリで、カスタム拡張機能が呼び出されたときにどうするかを記載していきます。</p><ol><li>Identity Governance - カタログ - 該当のカタログを選択 - カスタム拡張機能より、以下の画面を開きます。</li><li>以下のように「ロジック アプリ」列がリンクになっているので、以下の例では Governance_ExtensionApp1 のリンクをクリックします。</li></ol><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension24.png"></p><ol start="3"><li>以下のような画面が開きます。既定の設定はそのままにします。</li></ol><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension25.png"></p><ol start="4"><li>表示されているステップの間の矢印の上にあるプラス ボタンをクリックし、[アクションの追加] をクリックします。</li></ol><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension26.png"></p><ol start="5"><li>追加できるアクションの数々が表示されるので各処理を記述していきます。</li></ol><p>今回は以下のようなアクションを追加していきます。</p><ol><li>アクセス パッケージから渡された情報をもとに変数に格納</li><li>ユーザーの情報を取得</li><li>ユーザーの部署 (department) 属性と ExtensionAttribute1 の属性を更新する</li><li>メールの送付先となるアドレスを準備する</li><li>パッケージ内のリソース リンクをユーザーにメール通知する</li></ol><h4 id="1-アクセス-パッケージから渡された情報をもとに変数に格納"><a href="#1-アクセス-パッケージから渡された情報をもとに変数に格納" class="headerlink" title="1. アクセス パッケージから渡された情報をもとに変数に格納"></a>1. アクセス パッケージから渡された情報をもとに変数に格納</h4><p>アクセス パッケージから渡された情報が triggerBody の中に含まれています。渡された情報の中の、「パッケージが割り当てられたターゲットの ObjectID」を取得すると、割り当てられたユーザーを特定することができます。そこで、ここではまず $userID という変数に「パッケージが割り当てられたターゲットの ObjectID」を代入しています。アクセス パッケージの割り当て情報の中の Target 内 ObjectID に記載されているという点を示すために、値にあたる部分は動的なコンテンツとして記載します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension28.png"></p><p>動的なコンテンツの追加は、値のボックスをクリックしたときに表示される選択肢の中から以下を選ぶと、上のように埋め込むことができます。式としては、triggerBody()?[‘Assignment’]?[‘Target’]?[‘ObjectId’] となります。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension29.png"></p><h4 id="2-ユーザーの情報を取得"><a href="#2-ユーザーの情報を取得" class="headerlink" title="2. ユーザーの情報を取得"></a>2. ユーザーの情報を取得</h4><p>ユーザーの情報を取得するためには、 <a href="https://learn.microsoft.com/ja-jp/graph/api/user-get?view=graph-rest-1.0&tabs=http">ユーザーの取得 - Microsoft Graph v1.0</a> を使用します。アクセス パッケージが割り当てられたユーザーの情報は、先ほど $userID 属性に格納したので、以下のように記載します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension30.png"></p><p>また、 Add new parameter を開き、認証のチェックをオンにします。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension31.png"></p><p>先ほど事前にマネージド ID を構成し権限を割り当てたので、以下のように、システム割り当てマネージド ID を選択します。対象ユーザーの項目には、<a href="https://graph.microsoft.com/">https://graph.microsoft.com</a> を入力してください。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension32.png"></p><h4 id="3-ユーザーの部署-department-属性と-ExtensionAttribute1-の属性を更新する"><a href="#3-ユーザーの部署-department-属性と-ExtensionAttribute1-の属性を更新する" class="headerlink" title="3. ユーザーの部署 (department) 属性と ExtensionAttribute1 の属性を更新する"></a>3. ユーザーの部署 (department) 属性と ExtensionAttribute1 の属性を更新する</h4><p>次に、もう一つ HTTP アクションを追加し、ユーザーを更新するための API を記載します。更新するユーザー情報は、 $userID の変数から利用します。具体的な更新 API は <a href="https://learn.microsoft.com/ja-jp/graph/api/user-update?view=graph-rest-1.0&tabs=http">ユーザーを更新する - Microsoft Graph v1.0</a> に記載がありますので、こちらをもとに必要な情報を埋めていきます。例えば本文内に、「どの部署名に更新したいのか」部署の名前を指定しておきます。今回は、IT という部署に移動したいので以下のように記載します。なお、上記と同様に「認証」のチェックを有効化し、マネージド ID を指定ください。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension33.png"></p><h4 id="4-メールの送付先となるアドレスを準備する"><a href="#4-メールの送付先となるアドレスを準備する" class="headerlink" title="4. メールの送付先となるアドレスを準備する"></a>4. メールの送付先となるアドレスを準備する</h4><p>最後に、E メールをユーザー本人に送付したいので、$mail という変数を作り、事前に取得したユーザー情報の中から Mail 属性の値を取得して格納します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension34.png"></p><p>アクセス パッケージの割り当てによって初めて E メールボックスが作成される場合、アクセス パッケージ割り当て直後にメールを送付するとエラーになる可能性が考えられるため、10 分ほど待機するフローを挿入します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension35.png"></p><p>E メールの送付元となるユーザーを $MailSender という変数に定義します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension36.png"></p><h4 id="5-パッケージ内のリソース-リンクをユーザーにメール通知する"><a href="#5-パッケージ内のリソース-リンクをユーザーにメール通知する" class="headerlink" title="5. パッケージ内のリソース リンクをユーザーにメール通知する"></a>5. パッケージ内のリソース リンクをユーザーにメール通知する</h4><p>E メールの送付は <a href="https://learn.microsoft.com/ja-jp/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http">user: sendMail - Microsoft Graph v1.0</a> の API で実行できますので、以下のように実行します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension37.png"></p><p>本文は以下のように記載し、受信者 (toRecipients) のアドレスに送信先となる $mail を指定します。ここでアクセス パッケージで割り当てたリソース (グループ、アプリケーション、SPO サイト) のリンク先も記載しておきます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension38.png"></p><p>先に記載した HTTP と同様に、認証のチェックをオンに変更し、マネージド ID を指定します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension39.png"></p><p>本文の記載が少々見にくいかと思いますので、以下が参考となりますと幸いです。</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;message&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;body&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;IT 部門へようこそ！\n 異動処理と権限の付与が完了しましたので、メールでお知らせします。\n IT 部門用のチームやSPO サイトが用意されていますので、下記リンクよりアクセスできるか確認してください。\n\n ▼ IT 部門のページ\n SPO サイト\n &#x27;SPO サイトのリンク&#x27; \n\n  チーム\n &#x27;チームのリンク&#x27; \n\n もしアクセスできない場合は、CC に記載されているアドレス宛にメールにてご連絡ください。\n&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;contentType&quot;</span>: <span class="string">&quot;Text&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;ccRecipients&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;emailAddress&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;admin@contoso.onmicrosoft.com&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;subject&quot;</span>: <span class="string">&quot;IT 部門へようこそ！&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;toRecipients&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;emailAddress&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;user@contoso.onmicrosoft.com&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;saveToSentItems&quot;</span>: <span class="string">&quot;false&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ちなみに、ロジック アプリの記載においては、デバッグやトラブル シューティングをしながら進めることが多いと思います。ロジック アプリの概要画面を確認すると、成功もしくは失敗の一覧が表示されているので、処理状況の確認が可能です。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension40.png"></p><p>失敗のログをクリックすると、処理のどこでエラーになったのかも分かります。そのため、たとえば以下の場合だと、 HTTP 3 のアクションを見直せばよいことが分かります。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension41.png"></p><p>必要に応じて、<a href="https://jpazinteg.github.io/blog/LogicApps/Integration-graphApi/">Logic Apps 観点のブログ</a> もご確認ください。</p><h3 id="実際の動作"><a href="#実際の動作" class="headerlink" title="実際の動作"></a>実際の動作</h3><p>ユーザーにアクセス パッケージのリンクへアクセスしてもらいます。要求ポリシーが複数ある場合はどちらか選択します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension42.png"></p><p>必要に応じて、期間や理由を記載のうえパッケージを要求します。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension43.png"></p><p>ポリシーの内容にもよりますが、承認などを経てパッケージが割り当てられます。割り当てられると「割り当て」画面にユーザーが表示されます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension44.png"></p><p>パッケージが割り当てられたので、カスタム タスクが発動します。ユーザーの属性が変更されるなどし、最後に以下のような E メールが送付されます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension45.png"></p><p>実行履歴を確認すると、すべて成功しているかどうかなどを確認いただけます。</p><p><img src="/blog/azure-active-directory/access-package-with-custom-extension/access-package-with-custom-extension46.png"></p><p>今回は、アクセス パッケージとカスタム拡張機能を利用したサンプルについて紹介しました。上記内容を参考とし、お客様側のご要件およびご要望に合うカスタム拡張機能を実装いただければ幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;今回は、Microsoft Entra ID のエンタイトルメント管理 (アクセス パッケージ) の機能をより活用できる、カスタム拡張機能について紹介します。&lt;/p&gt;
&lt;p&gt;今回の記事は、アクセス パッケージ</summary>
      
    
    
    
    
    <category term="Entitlement Management" scheme="https://jpazureid.github.io/blog/tags/Entitlement-Management/"/>
    
    <category term="Access Package" scheme="https://jpazureid.github.io/blog/tags/Access-Package/"/>
    
  </entry>
  
  <entry>
    <title>条件を利用した Azure RBAC のロール割り当て</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/rbac-role-assignment-using-conditions/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/rbac-role-assignment-using-conditions/</id>
    <published>2023-11-26T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.464Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は、2023 年 10 月 25 日に公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/delegate-azure-role-assignment-management-using-conditions/ba-p/3954216">Delegate Azure role assignment management using conditions</a> をもとに、日本語に分かりやすくおまとめした記事となります。ご不明点などございましたら、お気軽にサポートまでお問い合わせください。</p><hr><p>今回、 Azure ロールを割り当てる時に条件を指定する機能がパブリック プレビューとして公開されました。</p><p>これまでは、他の人にロールを割り当て可能な権限を委譲する際は、所有者もしくはユーザー アクセス管理者のロールを割り当てる必要がありました。具体的には、例えばこの記事を読んでいらっしゃる皆様がサブスクリプションの所有者を持っていると仮定して、社内の開発者から「開発で利用したいのでサブスクリプションのロールを他の人に割り当てる権限が欲しい」という要望をいただいたとします。このとき、これまでサブスクリプションの所有者として社内の開発者にできることとしては、「開発者に、所有者もしくはユーザー アクセス管理者を付与する」という操作でした。</p><p>しかし、開発者に所有者もしくはユーザー アクセス管理者を付与をしてしまうと、開発者が以下のようなこともできてしまいます。これは開発者に付与するには大きすぎる権限です。</p><ul><li>所有者となった場合、サブスクリプションを削除したり、開発に関係のないリソースを変更したりできる</li><li>いずれのロールの場合も、自身に追加でロールを割り当てて権限を昇格することができる</li></ul><p>一方で、開発者から依頼があったときだけロールを付与する形にすると、スムーズな開発を妨げたり、承認フローで余計な時間がかかったりということとなります。</p><p>今回のパブリック プレビューでは、特定の条件を指定してロールの割り当てを作成する権限を付与できるようになりました。具体的には以下の 2 つの方法がありますので、それぞれ案内します。 </p><ul><li>条件を利用して制約されたロールを割り当てる</li><li>条件を組み込んだ新しい組み込みロールを作成する</li></ul><h2 id="条件を使用してロールの割り当て管理を委任する方法"><a href="#条件を使用してロールの割り当て管理を委任する方法" class="headerlink" title="条件を使用してロールの割り当て管理を委任する方法"></a>条件を使用してロールの割り当て管理を委任する方法</h2><p>この方法は、アクセス許可を委任するユーザーに対し、ロールが利用できる条件を細かく指定するものです。例えば、以下の Alice という管理者は、ユーザー アクセス管理者を持っていますので、誰に対してもロールを割り当てられます。今回、Dara というユーザーに、ロール割り当て操作を委任することにしましたが、Alice が持っているユーザー アクセス管理者ロールのように、誰にでも自由にロールを割り当てられる構成にはしたくありません。</p><p>この時に今回の「条件を利用した Azure RBAC のロール割り当て」が活用できます。今回 Alice は Dara に対し、以下の条件を付けて「Role Based Access Control Administrator (Preview)」というロールを付与しました。</p><ul><li>AcrPull と AcrPush ロールは付与してもよいが、その他のロールは他のユーザーに付与できない</li><li>ユーザーやグループに対してはロールを付与できないが、サービス プリンシパルになら付与できる</li></ul><p>すると、Dara は ① のようにサービス プリンシパルに対して、 AcrPull や AcrPush のロールを付与することができます。一方、② や ③ では、ユーザーに対してロールを付与しようとしているため、条件に合わず割り当てができません。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions1.png"></p><p>Role Based Access Control Administrator (Preview) の付与方法は下記のとおりです。この操作を行うのは上記画面例ですと Alice になります。</p><ol><li><p>サブスクリプション - アクセス制御（IAM） - 役割の画面を開き、ロール名を検索します。ポータルが日本語の場合でも、現時点ではロール名は英語のため、英語で検索ください。下記のように、ロールが表示されていることを確認します。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions2.png"></p></li><li><p>上記画面の [追加] - [ロールの割り当ての追加] をクリックし、割り当ての追加画面を開きます。</p></li><li><p>下記の画面が表示されるので、 [特権管理者ロール] のメニューを選択のうえロール名を検索し、クリックします。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions3.png"></p></li><li><p>このロールを割り当てたいユーザー（上記画面例ですと Dara にあたるユーザー）を指定します。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions4.png"></p></li><li><p>次の画面に進み、委任の種類が “制約あり (おすすめ)” となっていることを確認します。さらに、その下にある「条件を追加する」をクリックします。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions5.png"></p></li><li><p>下記の画面が表示されるので、追加したい条件によって選択します。今回は、ロールとプリンシパルのタイプを指定したいので、真ん中を指定します。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions6.png"></p></li><li><p>右側に下記のような画面が表示されるので、許可してもよいロールやプリンシパルを指定します。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions7.png"></p></li><li><p>選択が完了すると、下記のように「構成済み」となる点を確認します。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions8.png"></p></li><li><p>下記画面にて最終確認を行い、ロールの割り当てを実施すれば完了です。</p><p> <img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions9.png"></p></li></ol><h2 id="条件を組み込んだ新しい組み込みロールを使用してロールの割り当て管理を委任する方法"><a href="#条件を組み込んだ新しい組み込みロールを使用してロールの割り当て管理を委任する方法" class="headerlink" title="条件を組み込んだ新しい組み込みロールを使用してロールの割り当て管理を委任する方法"></a>条件を組み込んだ新しい組み込みロールを使用してロールの割り当て管理を委任する方法</h2><p>この方法は、新しく利用できるようになった組み込みロールを使う方法です。具体的には、Virtual Machine Data Access Administrator (preview) というロールや、Key Vault Data Access Administrator (preview) というロールが利用できるようになりました。こちらのロールを利用することで、関連するロールのみをユーザーに割り当てることができるようになります。</p><p>具体的に以下の図のとおりに説明いたしますと、Virtual Machine Data Access Administrator (preview) が割り当てられたユーザー Dara は、② や ③ のように、仮想マシンの管理者ログイン ロールや、仮想マシンのユーザー ログイン ロールを付与することができます。一方、① のように仮想マシンのアクセスに関連のないロールについては付与できないため、① の割り当ては失敗します。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions10.png"></p><p>割り当て方法は通常のロール割り当てと同様で、ロール割り当て画面で上記 2 つのロールのいずれかを指定する形になります。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions11.png"></p><p>ロールを割り当てるユーザー（上記例ですと Dara にあたるユーザー）を指定してロールを割り当てます。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions12.png"></p><p>もし、割り当て可能なプリンシパルを制限したい場合は、先の例と同様に条件を指定することも可能です。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions13.png"></p><p>条件を使用した場合は、下記のように構成済みと表示されているかを確認し、割り当てを完了します。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions14.png"></p><p>Data Access Administrator という文字列が含まれているロールには、既定で条件が組み込まれています。下記のように、ロールのアクセス許可を確認する画面で JSON タブを開き、condition と記載されている部分を確認すれば条件を確認可能です。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions15.png"></p><p>今後、一般的なシナリオを想定して、条件を組み込んだロールを追加していく予定です。簡単なロールの割り当てでリソースの管理ができるようになりますので、今後のアップデートをお待ちください。詳細につきましては、 <a href="https://learn.microsoft.com/ja-jp/azure/role-based-access-control/delegate-role-assignments-examples?tabs=template">条件 (プレビュー) を使用して Azure ロールの割り当てを委任する例</a> の公開情報も参考となりますと幸いです。</p><p>本機能に関するフィードバックにつきましては、下記画面の右上にございます「フィードバック」から承っております。お客様のご意見・ご要望をお待ちいたしております。</p><p><img src="/blog/azure-active-directory/rbac-role-assignment-using-conditions/rbac-role-assignment-using-conditions16.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 25 日に公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blo</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Authenticator の新機能によるセキュリティの改善</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/emphasizing-security-by-default-with-advanced-microsoft/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/emphasizing-security-by-default-with-advanced-microsoft/</id>
    <published>2023-11-21T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.120Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2023 年 11 月 6 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/emphasizing-security-by-default-with-advanced-microsoft/ba-p/3773130">Emphasizing Security by Default with Advanced Microsoft Authenticator Features</a> の抄訳です。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>弊社では、これまで多要素認証 (MFA) の重要性を強調し、MFA の方法によって認証の強度に違いがあること、特に Microsoft Authenticator は電話認証 (そろそろ使うのやめましょう！) よりもかなり安全性が高いことを繰り返し申し上げてきました。またこれまでの取り組みとして、Microsoft Authenticator における番号の一致機能を実装することで、MFA 疲労攻撃を行う悪意ある攻撃者の阻止に取り組んできました。</p><p>この番号の一致機能は非常に効果的であるものの、MFA 疲労攻撃を仕掛けてくる攻撃者の影響をユーザーが受けてしまう余地はまだあります。というのも、モバイル デバイス上に表示される認証のポップアップ通知が (ユーザーにとっては非常に便利な機能ではあるのですが) 攻撃者によるフィッシングの “きっかけ” を与えてしまうことがあるのです。この対応として、通常とは異なると判断された認証要求に関しては、Authenticator アプリのポップアップ通知を抑制するという追加の対応を取ることといたしました。これらの変更は 9 月末に完了し、信頼性の低いポップアップ通知の数を減らすことに成功しました。この展開が始まって以来、<strong>600 万件以上のパスワードレスおよび MFA 通知</strong> を防ぐことができました。これら抑制した通知の大部分は、顧客にとって価値のないハッカーによる通知でした。</p><h2 id="危険な-Authenticator-通知の抑制"><a href="#危険な-Authenticator-通知の抑制" class="headerlink" title="危険な Authenticator 通知の抑制"></a>危険な Authenticator 通知の抑制</h2><p>この機能の展開後、現在では、認証要求の発信元が見知らぬ場所である場合や、その他の異常が見られる場合など、潜在的なリスクが検出された場合に Authenticator によるポップアップ通知を抑制しています。この対応により、お客様にとって価値のない認証ポップアップを排除することとなり、ユーザーの不便さを大幅に軽減しました。</p><p>認証要求に問題がなければ、以下のようにモバイル　デバイスに通知が届きます。</p><p><img src="/blog/azure-active-directory/emphasizing-security-by-default-with-advanced-microsoft/pic1.png"></p><p>危険と思われる認証要求があった場合、<strong>ユーザーにポップアップ通知が表示されません</strong>。代わりに、Authenticator アプリを開き、表示された番号を入力してサインインするよう求められます。</p><p>ユーザーが Authenticator アプリを開けば、認証要求が表示され、ユーザーはそれを承諾もしくは拒否することが可能となります。</p><p><img src="/blog/azure-active-directory/emphasizing-security-by-default-with-advanced-microsoft/pic2.png"></p><p>ユーザーが Authenticator アプリを開けば、その内容をユーザーが確認可能です。</p><p><img src="/blog/azure-active-directory/emphasizing-security-by-default-with-advanced-microsoft/pic3.png"></p><h2 id="Authenticator-の通知の取得"><a href="#Authenticator-の通知の取得" class="headerlink" title="Authenticator の通知の取得"></a>Authenticator の通知の取得</h2><p>通知が勝手に削除されるわけではないのでご安心ください。単に通知が抑制されるだけであり、Authenticator アプリを開けばユーザーが認証要求を確認することが可能です。ユーザーが通常とは異なる場所から、実際に自身で認証要求を行った場合も、Authenticator アプリを開くことで通知を取得することができます。Authenticator アプリはすべての認証通知をまとめる箇所として機能しますので、見逃した要求があっても簡単にそれを確認できるはずです。</p><h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>この機能の実装により、ユーザーによりスムーズで安全な体験が提供できたと考えています。テクノロジーの進化に伴い、ユーザーの利便性を高めると同時にセキュリティを強化することは極めて重要です。この <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-authenticator-app">新しいアプローチ</a> はその良い例といえるでしょう。</p><p>Alex Weinert<br>VP Director of Identity Security, Microsoft</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 11 月 6 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommuni</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>パブリック プレビュー Microsoft Entra Internet Access のご紹介</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-internet-access/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-internet-access/</id>
    <published>2023-11-16T01:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.344Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は、2023 年 9 月 18 日に公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/microsoft-entra-internet-access-an-identity-centric-secure-web/ba-p/3922548">Microsoft Entra Internet Access: An Identity-Centric Secure Web Gateway Solution</a> の記事を日本語に分かりやすくおまとめしなおした記事となります。ご不明点などございましたら、お気軽にサポートまでお問い合わせをいただけますと幸いです。</p><p>なお、本記事は 下記記事の続編となりますので、併せてご確認ください。</p><ol><li><a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-expands-into-securityserviceedge-with-two-new-offerings/">Microsoft Entra - Security Service Edge へ拡大するための新機能</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-private-access-an-identity-centric-zero-trust-network-access-solution/">Microsoft Entra Private Access: ID を中心としたゼロ トラスト ネットアーク アクセス ソリューション</a></li></ol><p>ご不明点などございましたら、お気軽にサポートまでお問い合わせください。</p><hr><h2 id="これまでのシリーズ記事"><a href="#これまでのシリーズ記事" class="headerlink" title="これまでのシリーズ記事"></a>これまでのシリーズ記事</h2><p>多くのお客様では、ネットワークの境界にファイアウォールなどを設置し、内部ネットワークへのアクセスには VPN を使うなどしていると思います。こうした方法は、ネットワーク内にリソースとユーザーを囲い込み、外部からのリモート アクセスを許可するという従来のシナリオでは有益でしたが、クラウド化やリモート ワークおよびハイブリッド ワークの広がりにより現代のセキュリティ要件やビジネス要件を満たせなくなってきつつあります。</p><p>また、内部ネットワークにさえは入れれば権限管理が厳密に行われてないことも多く、ユーザーの資格情報が 1 人漏洩するだけで、攻撃の横展開を許し、機密情報など重要な情報が流出してしまう危険などもあります。従業員が様々な場所からインターネットを介し、より安全に情報にアクセスできるよう、Microsoft では、2023 年 7 月に、2つの新しい機能が利用できるようになりました。</p><ul><li>Microsoft Entra Internet Access</li><li>Microsoft Entra Private Access</li></ul><p>この概要を、上記 1. のブログにて以前紹介し、Microsoft Entra Private Access の詳細な紹介を 2. にておまとめしております。今回は残りの、 Microsoft Entra Internet Access の機能について紹介します。</p><h2 id="Microsoft-Entra-Internet-Access"><a href="#Microsoft-Entra-Internet-Access" class="headerlink" title="Microsoft Entra Internet Access"></a>Microsoft Entra Internet Access</h2><p>Microsoft Entra Internet Access は、ID を中心とした Secure Web Gateway (SWG) と呼ばれる機能です。悪意のあるインターネット通信、安全でないコンテンツ、コンプライアンス違反のコンテンツなどの脅威から保護します。一部のシナリオ向けに先にパブリック プレビューが開始されておりましたが、現在まだご利用いただけていないシナリオにおいても、間もなくパブリック プレビューが開始されます。この機能は、以前ご案内した Microsoft Entra Private Access やその他の Microsoft Entra 製品と連動しています。例えば、条件付きアクセスを利用して、Microsoft 365 を含む様々なインターネット上の情報と SaaS アプリケーションへのアクセス ポリシーを一本化可能です。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access1.png"></p><p>セキュリティ担当者は、ユーザー、デバイス (エンドポイント)、ネットワークなどに対し、きめ細やかなアクセス制御を行うことができます。Web フィルタリング、クロステナント保護、データ損失防止、パケット インスペクションなど高度な機能によって、ユーザーやアプリ、リソースを保護できます。</p><h2 id="特徴"><a href="#特徴" class="headerlink" title="特徴"></a>特徴</h2><ol><li><p>ID 中心のアクセス制御と Microsoft Entra との連携</p><p> Microsoft Entra と深く紐づいている機能のため、条件付きアクセスにてより多くの対象を保護できるようになります。あらゆる外部通信、インターネット リソース、およびクラウド アプリケーションの指定などが可能です。「継続的なアクセス評価」も含まれるようになるため、例えば ID への攻撃が検出された場合など、条件が変われば即座にアクセスを取り消すことができるようになります。</p><p> この条件付きアクセスとの統合により、SWG、CASB、ファイアウォールの各種ポリシーを適用しながら、デバイス、ユーザー、場所、およびリスクなどきめ細かな条件を活用して、企業の状況に応じたセキュリティ要件を実現することができます。</p></li><li><p>高いパフォーマンスと柔軟性</p><p> マイクロソフトのプライベート広域ネットワークやマイクロソフトのグローバルネットワーク、ユーザーに最も近い PoP (Points of Presence) を利用したグローバル分散プロキシを利用することで、余分なホップを排除してアプリやリソースへのルーティングを最適化しています。これにより、離れた場所からのアクセスでも高速で利用できます。</p><p> また、ユーザーの所在地からわずかミリ秒しか離れていないエッジを通じて、リモートで働く従業員と支社をシームレスに接続できるようになりました。これにより、インターネットとの往来におけるトラフィックの無用な往復や単一障害点を回避することができます。</p></li><li><p>Microsoft 365 アプリケーションのセキュリティとデータ監視の強化</p><p> Microsoft 365 向けに、独自のセキュリティと監視機能を多数提供しています。Microsoft 365 向けのデータ保護の仕組みとしては、きめ細かな適応型アクセス制御、トークンの盗難やデータの流出に対する保護が含まれます。また、ユーザー、デバイス、および場所に関するほぼリアルタイムなログ取得を通じて、セキュリティ上重要な活動を監視しています。</p></li><li><p>サードパーティの SSE ソリューションとのサポート</p><p> Microsoft Entra Internet Access は、すべてのインターネット リソース、SaaS、Microsoft 365 へのアクセスを保護するメインのソリューションとして導入することも、他の SSE ソリューションと並行して導入することもできます。たとえば Microsoft Entra Internet Access は Microsoft 365 向けのセキュリティと監視機能に利用し、それ以外のインターネット トラフィックと SaaS アプリは、選択した他の SSE ソリューションで保護するような構成も可能です。お客様の環境に応じて、Microsoft Entra Internet Access のみを利用するか、現在利用している他のサービスと併用するか柔軟に決めることができます。</p><p> トラフィックは、エンドユーザーのデバイスからクライアント ベースのアプローチで取得することも可能ですし、またはリモート ネットワークから Ipsec トンネルを実行する方法でも取得可能です。Microsoft Entra の管理センターで、Microsoft 365 トラフィックへのセキュアなアクセスを簡単に有効にすることができます。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access2.png"></p></li></ol><h2 id="Internet-Access-の主要な機能"><a href="#Internet-Access-の主要な機能" class="headerlink" title="Internet Access の主要な機能"></a>Internet Access の主要な機能</h2><ol><li><p>条件付きアクセスのカバー範囲の拡大</p><p> これまで条件付きアクセスでは、ターゲット リソースとしてアプリケーションを明示的に指定したり、アプリ フィルターを用いて特定のカスタム セキュリティ属性をもつアプリを対象にするような構成としていたかと思います。この新機能を利用すると、下記の画面にてインターネット トラフィックを選択できるようになるため、ポリシーの対象として、アプリだけでなく、アクセス先のネットワーク自体を指定できるようになり、より広くきめ細かな範囲にポリシーを適用できるようになります。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access3.png"></p><p> ※ 2023/10/19 現在、インターネット トラフィックおよびプライベート アクセス  トラフィックへの条件付きアクセスの適用はサポートされていません。それぞれ下記の公開情報をもとに、代替案やプライベート プレビューへの申請をご検討ください。</p><p> <a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/concept-universal-conditional-access#known-limitations">Global Secure Access 経由のユニバーサル条件付きアクセスについて説明します</a></p><ul><li>プライベート アクセス トラフィックへの条件付きアクセス ポリシーの適用は現在サポートされていません。 この動作をモデル化するために、クイック アクセスと Global Secure Access アプリに対してアプリケーション レベルで条件付きアクセス ポリシーを適用できます。 詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-target-resource-private-access-apps">Private Access アプリに条件付きアクセス ポリシーを適用する</a> を参照ください。</li><li>インターネット トラフィックへの条件付きアクセス ポリシーの適用は現在サポートされていません。 インターネット トラフィックはプライベート プレビュー段階です。 プライベート プレビューへのアクセスを要求するには、[こちらの Forms](<a href="https://forms.office.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7Lm8YtbKDdHu3wnC0DGKg5UQUhPRU44R0RLVEwySTJYVUVGNEwyVjVIVi4u%5D">https://forms.office.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR7Lm8YtbKDdHu3wnC0DGKg5UQUhPRU44R0RLVEwySTJYVUVGNEwyVjVIVi4u]</a> から申請ください。</li></ul></li><li><p>データ流出の防止</p><p> テナント制限 v2 は強力なデータ流出防止機能であり、管理対象デバイスや指定されたネットワークからの外部アクセスのリスクを管理できます。 Microsoft Entra Internet Accessでは、企業側でプロキシを使用することなく、すべての OS およびブラウザ プラットフォームで一括してテナント制限の機能を適用できるため、より柔軟できめ細かな制御が可能になります。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access4.png"></p></li><li><p>トークンの窃取からの保護</p><p> Internet Access 機能では、条件付きアクセスに統合された構成として、準拠済みネットワークの概念を導入しています。この制御により、Microsoft Entra と統合されたクラウド アプリケーションをトークンの盗難から保護し、ユーザーが重要なクラウド サービスにアクセスする際に、テナント固有のネットワーク セキュリティポリシーを迂回しないようにすることができます。また、トークンの盗難が検出された場合は、継続的なアクセス評価を使用して Microsoft 365 アプリやリソースへのアクセスを即座にブロックすることもできます。</p><p> なお、Microsoft 365 トラフィックに対する条件付きアクセスについては、継続的アクセス評価が現在サポートされていないため、今後のアップデートをお待ちください。</p><p> <a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/concept-universal-conditional-access#known-limitations">Global Secure Access 経由のユニバーサル条件付きアクセスにおける既知の制限事項</a></p></li><li><p>ソース IP アドレスを維持する</p><p> 一般的なプロキシは、ユーザーの元のソース IP を隠蔽し、条件付きアクセスの場所ポリシーの適用を困難にしてしまいます。そのため、リスク検出とアクティビティログの精度に影響を与えていました。Microsoft Entra Internet Access は、ユーザーの元のソース IP が維持されるようにすることで、条件付きアクセス、継続的なアクセス評価、ID のリスク検出、およびログにおける信頼できる場所の確認において、下位互換性を提供します。</p><p> 関連する設定箇所については以下をご覧ください。まず、グローバル設定 - セッション管理 内の下記画面にてチェックをオンにします。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access5.png"></p><p> 下記にて場所ポリシーを厳密に管理するよう条件付きアクセスを構成することで、場所に関するポリシーがより厳密に動作します。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access6.png"></p></li><li><p>条件付きアクセスでネットワーク アクセス制御を統一的に管理 </p><p> ユーザー、デバイス、場所、リスク構成など、条件付きアクセスで利用可能な豊富な条件に基づいて、あらゆるインターネットの宛先にネットワーク セキュリティ ポリシーを適用できるようになります。条件付きアクセスのセッション タブに「Global Secure Access Policy を利用する」の設定が追加され、今後利用できるようになります。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access7.png"></p></li><li><p>エンド ユーザーによる安全でないコンテンツへのアクセスを制限します。</p><p> 条件付きアクセスにおける、ユーザー、デバイス、場所の制御により、Web コンテンツ フィルタリング (URL、FQDN、Web カテゴリ) をもちいたアクセス制限も可能になります。攻撃対象の領域を減らし、ネットワーク セキュリティの管理体験がよりシンプルになります。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access8.png"></p><p> ※ 本機能は現在プライベート プレビューのため、まだ一般にはご利用いただけません。下記のような画面が表示されますので、パブリック プレビューの展開をお待ちください。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access9.png"></p></li><li><p>製品レポートとダッシュボード</p><p> レポートとダッシュボードにより、環境の全体像を簡単に把握し、組織で共有することが可能となります。導入状況を確認し、新たなリスクを検出し、問題を迅速に修正することもできます。当社のダッシュボードは、マイクロソフトの SSE ソリューションを通じて接続されているユーザー、デバイス、宛先のその時点での全体像を提供します。来年早々には、ポリシーに関する解析情報と推奨事項が強化され、高度なアプリとネットワークの検出機能が提供される予定です。クライアントがインストールされているアクティブなデバイスの数や、どのあて先に通信が多く行われているかなども確認可能です。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access10.png"></p></li><li><p>ネットワーク トラフィック ログに基づくカスタム ビューとダッシュボード</p><p> トラフィック ログのページでは、ソリューションを通じて発生したすべてのリクエストとレスポンスのトランザクションを可視化することができます。これらのログでは、デバイス ID、オペレーティング システム名とバージョンなど、デバイスから収集された情報を見ることもできます。 また、ソース IP とポート、宛先 IP とポート、FQDN などの関連するパケット情報も見ることができます。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access11.png"></p><p> 診断設定で NetworkAccessTrafficLogs にチェックを入れて転送すると、 Log Analytics 側にてログを確認することができます。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access12.png"></p><p> Entra 管理センター上では一覧でしか確認できませんが、クエリを利用すれば、特定の条件のログを抽出することなども可能です。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access13.png"></p></li><li><p>Microsoft 365 のセキュリティ イベントをリアルタイムに可視化</p><p>精細なログから、Microsoft 365 アプリとリソースの脅威を簡単かつ迅速に検出いただけます。インターネット アクセス ソリューションは、Microsoft 365 のログをユーザー、場所、デバイスの豊富な情報で拡張し、ユーザーの利用に影響を与えずに、ほぼリアルタイムに情報を提供します。</p><p><img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access14.png"></p></li></ol><p>下記の機能は現在開発中で、来年早々にリリースされる予定です:</p><ul><li>送受信トラフィックの制限機能: ユーザーの利用形態を考慮したクラウド ファイアウォールを活用することで、たきめ細かなポリシー条件により、IP アドレス、ポート、プロトコルなどに基づいて制限を行えるようにします。</li><li>悪意のあるネットワーク活動の特定とブロック: 侵入検知防御システム (IDPS) と脅威インテリジェンスにより、既知の悪意のある IP/FQDN/URL を特定およびブロックします。</li><li>暗号化されたトラフィックの検査: すべての TCP/UDP トラフィックに対してきめ細かな TLS のインスペクションを行います。</li></ul><h2 id="Microsoft-Entra-Internet-Access-の展開方法"><a href="#Microsoft-Entra-Internet-Access-の展開方法" class="headerlink" title="Microsoft Entra Internet Access の展開方法"></a>Microsoft Entra Internet Access の展開方法</h2><p>下記公開情報に記載の手順を 4 つ実施いただくことで構成が可能です。2 の手順にて、エンド ユーザーのデバイスにクライアントをインストールする手順がございますので、あらかじめ要件を満たす Microsoft Entra 参加済みデバイスもしくはハイブリッド参加済みデバイスをご用意のうえ実施いただけますと幸いです。</p><p><a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-get-started-with-global-secure-access#microsoft-entra-internet-access">Global Secure Access の概要 (プレビュー)</a></p><p>   <img src="/blog/azure-active-directory/microsoft-entra-internet-access/microsoft-entra-internet-access15.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 9 月 18 日に公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog</summary>
      
    
    
    
    
    <category term="Global Secure Access" scheme="https://jpazureid.github.io/blog/tags/Global-Secure-Access/"/>
    
  </entry>
  
  <entry>
    <title>認証に電話網を使うのはそろそろやめよう</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/it-s-time-to-hang-up-on-phone-transports-for-authentication/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/it-s-time-to-hang-up-on-phone-transports-for-authentication/</id>
    <published>2023-11-16T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.296Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2020 年 11 月 10 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752">It’s Time to Hang Up on Phone Transports for Authentication</a> の抄訳です。新着記事ではありませんが、以前より繰り返し様々な記事で参照されており、多くのお客様にとって有用であるため抄訳しました。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>以前のブログ <a href="https://jpazureid.github.io/blog/azure-active-directory/your-password-doesnt-matter/">パスワードで攻撃は防げない - Your Pa$$word doesn’t matter</a> では、パスワードに潜む脆弱性を明らかにしました。加えて、「でもパスワード以外の他の認証方法も侵害される可能性あるでしょ」という無数の DM や E メールに対する答えとして、<a href="https://jpazureid.github.io/blog/azure-active-directory/all-your-creds-are-belong-to-us/">君達の資格情報は全ていただいた！</a> の記事を執筆しました。この <a href="https://jpazureid.github.io/blog/azure-active-directory/all-your-creds-are-belong-to-us/">君達の資格情報は全ていただいた！</a> の記事では、パスワード以外の認証方法にも脆弱性があることを概説し、FIDO、Windows Hello、Authenticator App のようなパスワードレスかつ暗号的に保護された認証方法の有用性をアピールしました。</p><p>本日、皆様が <strong>SMS と音声の多要素認証 (MFA) の仕組みはもう使うべきでない</strong> と確信を持ち、実際にそれを行動に移せるよう、その後押しをしたいと思っています。SMS と音声の仕組みは公衆交換電話網 (PSTN) に基づいており、これは現在利用可能な MFA の方法の中で最も安全性が低いと言えます。MFA の採用が増えるにつれ、攻撃者の関心は MFA をいかに突破するかに向けられつつあります。加えて、特別にデザインされた認証の仕組みがセキュリティと利便性をより高めている中で、SMS と音声の安全性の低さは際立つばかりです。パスワードレスの強力な認証へ今すぐ移行ください。Authenticator アプリを利用すれば、今すぐに安全な認証が行え、しかも進化する脅威にも対応が可能です。</p><p>繰り返しになりますが、<strong>MFA はもはや必須</strong> です。議論は、どの MFA の方法を使用するかであり、MFA を使用すべきかどうかではありません。以前のブログにも書いたとおり「多要素認証 (MFA) は、アカウントの保護を真剣に考えているのであれば、最低限取り組むべきこととして変わりありません。パスワードに加えて何かしらのものを使えば、攻撃者のコストは大幅に増加します。このため、何らか MFA を使用しているアカウントが乗っ取られる率というのは、全体の 0.1% 以下になります。」</p><h2 id="問題が入り込む余地が多すぎ"><a href="#問題が入り込む余地が多すぎ" class="headerlink" title="問題が入り込む余地が多すぎ"></a>問題が入り込む余地が多すぎ</h2><p>PSTN には、資格情報を悪用するあらゆるアプローチが適用出来てしまうのです。OTP のフィッシングも可能ですし、ソーシャル エンジニアリングも可能、アカウントの乗っ取りももちろん可能、デバイスの盗難も可能です。PSTN には他のすべての認証機器の脆弱性があり、加えて PSTN 固有の問題も抱えています。</p><h2 id="適応性がない"><a href="#適応性がない" class="headerlink" title="適応性がない"></a>適応性がない</h2><p>PSTN のメッセージを受信するデバイスは多種多様なため、メッセージのフォーマットが限定されていることが挙げられます。メッセージのフォーマットを多種多様にしたり、長くしたりすることはできず、OTP を短いテキスト メッセージや電話で送信すること以上のことはできません。サービス提供において重要なのは、ユーザーの期待や技術的進歩、および攻撃者の行動にリアルタイムに適応することです。残念ながら、SMS と音声の形式にはこういった適応性がないため、ユーザービリティとセキュリティの観点での技術革新の余地は非常に限られています。</p><h2 id="データが平文で転送されている"><a href="#データが平文で転送されている" class="headerlink" title="データが平文で転送されている"></a>データが平文で転送されている</h2><p>SMS と音声のプロトコルが開発された当初は、暗号化については特に検討なく設計されました。実用的なユーザビリティの観点から、これらのプロトコルに暗号化を組み込むことはできません。なぜなら、ユーザーが暗号化されたメッセージを読めなくなってしまうからです (メッセージのサイズの膨張など、既存のプロトコルにこれらを組み込めない他の理由もあります)。つまり、これは電話交換網にアクセスできる人やデバイスの無線が届く範囲内の人であれば、誰でも傍受できることを意味します。前述の <a href="https://jpazureid.github.io/blog/azure-active-directory/all-your-creds-are-belong-to-us/">君達の資格情報は全ていただいた！</a> の記事で述べたように、攻撃者は <a href="https://www.securitynewspaper.com/2018/02/19/intercept-mobile-communications-calls-messages-easily-without-hacking/">ソフトウェアウェアベースの無線を使用してメッセージを傍受</a> したり、近くの <a href="https://securitywatch.pcmag.com/hacking/314370-black-hat-intercepting-calls-and-cloning-phones-with-femtocells">FEMTO</a> を使用したり、<a href="https://www.theverge.com/2017/6/13/15794292/ss7-hack-dark-web-tap-phone-texts-cyber-crime">SS7 傍受サービス</a> を使用したりして電話網の通信を盗聴することが可能です。これは、PSTN システムに固有の脆弱性であり、周到に準備した攻撃者であればこういった攻撃手法も利用可能なのです。</p><h2 id="ソーシャル-エンジニアリングが容易である"><a href="#ソーシャル-エンジニアリングが容易である" class="headerlink" title="ソーシャル エンジニアリングが容易である"></a>ソーシャル エンジニアリングが容易である</h2><p>ほとんどの PSTN システムはオンラインのアカウントと充実したカスタマー サポートの仕組みに支えられています。残念ながら、カスタマー サポートの担当者は誘惑、強制、賄賂、または恐喝の影響を受ける可能性があります。これらのソーシャル エンジニアリングの攻撃が成功すれば、カスタマー サポート自らが攻撃者に対して SMS または音声チャネルへアクセスさせてしまうことになります。ソーシャル エンジニアリング攻撃は E メールのシステムにも影響を与えますが、主要な E メール システム (例えば、Outlook や Gmail) は、サポート全体をとおしてアカウントの侵害を防ぐための防止策がよりしっかりと準備されています。こういったことで、PSTN システムではメッセージの傍受から、転送攻撃、SIM ジャッキングまで、さまざまなことが引き起こされます。</p><h2 id="モバイル事業者の信頼性に依存する"><a href="#モバイル事業者の信頼性に依存する" class="headerlink" title="モバイル事業者の信頼性に依存する"></a>モバイル事業者の信頼性に依存する</h2><p>残念ながら、PSTN システムには 100% の信頼性はなく、信頼性の報告自体も 100% 一貫しているわけではありません。これは地域やキャリアによりますが、メッセージが手元に届くまでの経路によって、到達までにどれくらいの時間かかるか、またはそもそも届くのか届かないのかが変わってきます。場合によっては、キャリアは配信が失敗したのに配信成功と報告することもあります。メッセージの配信に時間がかかりすぎて、ユーザーからするとメッセージが届いていないと思ってしまうこともあるぐらいです。地域によっては、配信の成功率が 50% 以下というところもあるのです。SMS は「送信したらそれでおしまい」というタイプの配信の仕組みなので、MFA のサービスを提供する事業者はメッセージの配信に関する問題の有無を確認できるようなリアルタイムのデータを持っていません。統計的な配信完了率やヘルプ デスクのコール数から問題の発生状況を類推しているのです。このことから、ユーザーに問題の発生状況を通知したり、電話網以外の代替案をお勧めしたりするのが難しいことがわかります。</p><h2 id="規制当局による変更の影響を受けやすい"><a href="#規制当局による変更の影響を受けやすい" class="headerlink" title="規制当局による変更の影響を受けやすい"></a>規制当局による変更の影響を受けやすい</h2><p>SMS におけるスパムの増加により、規制当局は識別コード、送信レート、メッセージ内容、送信許可、および「STOP」のようなメッセージへの応答に関する規制を要求しています。しかし残念ながら、これらの規制はすぐに変更されますし、地域によって一貫性がなく、大規模な配信停止を引き起こす可能性もあります (実際に引き起こしています)。配信の障害が多ければ多いほど、ユーザーの不満は増すばかりです。</p><h2 id="一連の認証の流れを意識させづらい"><a href="#一連の認証の流れを意識させづらい" class="headerlink" title="一連の認証の流れを意識させづらい"></a>一連の認証の流れを意識させづらい</h2><p>SMS テキストや音声という媒体には、ユーザーに伝えられる情報量に制限があります。SMS は 160 文字、GSM を使用しない場合は 70 文字を配信できますが、エンコーディングが必要な言語になると、メッセージ分割なしではその半分程度しか配信できないのが実際のところです。フィッシングは深刻な脅威であり、ユーザーに可能な限り多くの情報を提供したい (または、Windows Hello や FIDO を使用してフィッシングを不可能にしたい) と考えていますが、SMS や音声形式は、認証が要求された際の一連の流れや詳細情報を提供する機能に制限があるのです。</p><h2 id="他の認証方法が進化してきた"><a href="#他の認証方法が進化してきた" class="headerlink" title="他の認証方法が進化してきた"></a>他の認証方法が進化してきた</h2><p>まとめますと、きっと今後皆さまも MFA を使用するようになると思いますが、問題はどの MFA を使用するのかなのです。モバイル デバイスを使用しているほとんどのユーザーに関しては、適切な答えはアプリベースの認証です。つまり弊社においては、それは <a href="https://www.microsoft.com/authenticator">Microsoft Authenticator</a> を意味します。Microsoft Authenticator は暗号化された通信を使用しており、認証ステータスについての双方向通信を行えます。また、ユーザーが自分自身を安全に保つためのさらなる追加情報と制御機能をアプリに追加するべく開発を進めています (訳注: 2020 年当初)。2019 年だけでも、アプリ ロック、ロック画面からの通知の非表示、アプリ内のサインイン履歴の機能などを追加しました。SMS と音声通話は今後もそのまま進化しませんが、お客様が Microsoft Authenticator アプリを実際に利用しようとした際には、こういった Microsoft Authenticator アプリの新機能はさらに増えて進化し続けているのです。</p><p>PSTN を利用するのはやめて、Microsoft Authenticator を使いましょう。これだけでユーザーはより良い認証の体験がえられ、より安全になるのです。</p><p>安全にお過ごしください！</p><p>Alex (Twitter: <a href="http://twitter.com/alex_t_weinert">@alex_t_weinert</a>))</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2020 年 11 月 10 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommun</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ハイブリッド参加を再構成する (簡易版)</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-hybrid-joined-re-registration-simplified/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-hybrid-joined-re-registration-simplified/</id>
    <published>2023-11-14T03:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.336Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure &amp; Identity サポート チームの長谷川です。</p><p>この記事では、対象デバイスの Microsoft Entra ハイブリッド参加を再構成する手順の簡易版を紹介します。</p><p>完全版は<a href="/blog/azure-active-directory/haadj-re-registration/">こちら</a>に掲載されていますが、完全版ではオンプレミスの Active Directory サーバーへの管理アクセスが必要になります。<br>しかしながら Active Directory サーバーへ管理アクセスしなくても Microsoft Entra ハイブリッド参加を再構成することができる場合があるため、完全版から Active Directory サーバーへの管理アクセスを除いた簡易版の手順を作成しました。<br>まずこの簡易版を利用し、簡易版で状況が変わらなければ完全版を利用する、といった流れで活用いただければと思います。</p><h2 id="1-注意事項"><a href="#1-注意事項" class="headerlink" title="1. 注意事項"></a>1. 注意事項</h2><p>再度 Microsoft Entra ハイブリッド参加を構成するためには、そのデバイス上での管理者権限と、デバイスがオンプレミスの Active Directory およびインターネットの両方にアクセスできる環境 (社外にデバイスがある場合は、オンプレミス AD 環境への VPN 接続) が必要です。</p><h2 id="2-事前準備-Windows-Hello-for-Business-のリセット"><a href="#2-事前準備-Windows-Hello-for-Business-のリセット" class="headerlink" title="2. 事前準備: Windows Hello for Business のリセット"></a>2. 事前準備: Windows Hello for Business のリセット</h2><p><strong>Windows Hello for Business (略称 WHfB) を利用していない場合はこの手順はスキップください。</strong></p><ol><li><p>端末にサインインします。</p></li><li><p><strong>ユーザー権限</strong> でコマンド プロンプトを起動します (管理者として実行から起動しないようご注意ください)。</p></li><li><p>以下のコマンドを実行して、WHfB の情報をリセットします。</p> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil -deletehellocontainer</span><br></pre></td></tr></table></figure></li><li><p>次のコマンドを実行し、<code>NgcSet : NO</code> となっていることを確認します。</p> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsregcmd /status</span><br></pre></td></tr></table></figure></li></ol><h2 id="3-事前準備-Intune-の登録解除"><a href="#3-事前準備-Intune-の登録解除" class="headerlink" title="3. 事前準備: Intune の登録解除"></a>3. 事前準備: Intune の登録解除</h2><p><strong>Intune 登録していなければスキップください。</strong></p><ol><li>[Microsoft Intune 管理センター (intune.microsoft.com)] &gt; [デバイス] &gt; [すべてのデバイス] から該当デバイスを検索し、存在する場合は対象デバイスを開いて [削除] ボタンをクリックして削除します (削除完了するまでに少し時間がかかります)。</li></ol><h2 id="4-Microsoft-Entra-ハイブリッド参加の再構成"><a href="#4-Microsoft-Entra-ハイブリッド参加の再構成" class="headerlink" title="4. Microsoft Entra ハイブリッド参加の再構成"></a>4. Microsoft Entra ハイブリッド参加の再構成</h2><p>Microsoft Entra ID から離脱し Microsoft Entra ハイブリッド参加を解除、その後再構成します。</p><ol><li><p>対象のデバイスに対象のドメイン ユーザーでサインインし、 <strong>管理者権限</strong> でコマンド プロンプトを起動し、次のコマンドで Microsoft Entra ハイブリッド参加を解除します。</p> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsregcmd /leave</span><br></pre></td></tr></table></figure></li><li><p>次のコマンドで <code>AzureAdJoined : NO</code> となっていることを確認します。</p> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsregcmd /status</span><br></pre></td></tr></table></figure></li><li><p>[Azure Portal (portal.azure.com)] &gt; [Microsoft Entra ID] &gt; [デバイス] &gt; [すべてのデバイス] に 結合の種類 が <code>Microsoft Entra hybrid joined</code> の対象のデバイス オブジェクトが存在していることを確認します。もし、対象のデバイス オブジェクトが存在しない場合は Microsoft Entra Connect の同期 (既定では 30 分間隔) を待ちます。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-hybrid-joined-re-registration-simplified/microsoft-entra-hybrid-joined-re-registration-simplified4-3.jpg" alt="Microsoft Entra hybrid joined の対象のデバイス オブジェクトが存在していることを確認"></p></li><li><p>対象のデバイスがオンプレミスの Active Directory およびインターネットの両方にアクセスできるネットワーク環境に接続していることを確認します (社内ネットワーク環境に接続するなど)。</p></li><li><p><strong>管理者権限</strong> でタスク スケジューラを起動し [タスク スケジューラ ライブラリ] &gt; [Microsoft] &gt; [Windows] &gt; [Workplace Join] を開きます。</p></li><li><p>[Automatic-Device-Join] を 右クリックし [実行する(R)] を選択します。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-hybrid-joined-re-registration-simplified/microsoft-entra-hybrid-joined-re-registration-simplified4-6.jpg" alt="Automatic-Device-Join を実行"></p></li><li><p>コマンド プロンプトを起動し次のコマンドを実行し <code>AzureAdJoined : YES</code> となっていることを確認します。</p> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsregcmd /status</span><br></pre></td></tr></table></figure></li><li><p>[Azure Portal (portal.azure.com)] &gt; [Microsoft Entra ID] &gt; [デバイス] &gt; [すべてのデバイス] で対象のデバイス オブジェクトの [登録済み] の項目が日付であることを確認します。</p><p> <img src="/blog/azure-active-directory/microsoft-entra-hybrid-joined-re-registration-simplified/microsoft-entra-hybrid-joined-re-registration-simplified4-8.jpg" alt="すべてのデバイスで登録済みを確認"></p></li><li><p>対象デバイスにて 画面のロック &gt; アンロック をすることでプライマリ更新トークン (PRT) を取得します。(すぐにアンロックしていただいて問題ありません)</p></li><li><p>対象のデバイスにて対象の <strong>ユーザー権限</strong> でコマンド プロンプトを起動し、次のコマンドを実行して <code>AzureAdPrt : YES</code> となっていることを確認します (管理者として実行から起動しないようご注意ください)。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsregcmd /status</span><br></pre></td></tr></table></figure></li></ol><h2 id="5-事後確認-Intune-の登録"><a href="#5-事後確認-Intune-の登録" class="headerlink" title="5. 事後確認: Intune の登録"></a>5. 事後確認: Intune の登録</h2><p><strong>この手順は Intune 登録しなければ不要です。</strong> また、反映に時間がかかることがあります。</p><ol><li> [Azure Portal (portal.azure.com)] &gt; [Microsoft Entra ID] &gt; [デバイス] &gt; [すべてのデバイス] で対象のデバイス オブジェクトの [MDM] の項目に値が入り [準拠している] が「はい」となっていることを確認します。</li><li>[Microsoft Intune 管理センター (intune.microsoft.com)] &gt; [デバイス] &gt; [すべてのデバイス] から該当デバイスを検索し対象デバイスの [対応] の項目が「準拠している」となっていることを確認します。</li></ol><h2 id="6-事後作業-WHfB-の再プロビジョニング"><a href="#6-事後作業-WHfB-の再プロビジョニング" class="headerlink" title="6. 事後作業: WHfB の再プロビジョニング"></a>6. 事後作業: WHfB の再プロビジョニング</h2><p><strong>WHfB を利用していなければ不要です。</strong></p><ol><li>端末を再起動します。</li><li>対象のユーザーでサインインすると WHfB のプロビジョニングが自動的に始まりますのでウィザードに沿ってセットアップします (ウィザードの中で多要素認証が要求されます)。</li></ol><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>Microsoft Entra ハイブリッド参加の再構成の簡易版を紹介しました。手順が運用の助けになると嬉しく思います。製品動作に関する正式な見解や回答については、お客様環境などを十分に把握したうえでサポート部門より提供しますので、ぜひ弊社サポート サービスをご利用ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure &amp;amp; Identity サポート チームの長谷川です。&lt;/p&gt;
&lt;p&gt;この記事では、対象デバイスの Microsoft Entra ハイブリッド参加を再構成する手順の簡易版を紹介します。&lt;/p&gt;
&lt;p&gt;完全版は&lt;a href=&quot;/blog/az</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="Troubleshooting" scheme="https://jpazureid.github.io/blog/tags/Troubleshooting/"/>
    
    <category term="Hybrid Azure AD Join" scheme="https://jpazureid.github.io/blog/tags/Hybrid-Azure-AD-Join/"/>
    
    <category term="Microsoft Entra hybrid join" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Entra-hybrid-join/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft マネージド条件付きアクセス ポリシー</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-managed-conditional-access-policies/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/microsoft-managed-conditional-access-policies/</id>
    <published>2023-11-13T03:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.372Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure &amp; Identity サポート チームです。</p><p>今回は、最近お問い合わせをよくいただく「Microsoft マネージド条件付きアクセス ポリシー」についてです。Microsoft マネージド条件付きアクセス ポリシーについて、概要とよくいただくご質問を Q&amp;A 形式でおまとめいたしました。既存のドキュメントではカバーされていない動作や質問について今後も適宜内容を拡充していきますので、ご参照いただければと思います。</p><p>2020 年に Microsoft Entra ID は「セキュリティの既定値群」の機能を導入し、お客様に無料で多要素認証を提供することでお客様のセキュリティ強化に取り組んできました。そしてこの度、更なるセキュリティ向上のための継続的な取り組みとして、2023 年 11 月から 12 月後半にかけて、「Microsoft マネージド 条件付きアクセス ポリシー」の機能が導入されます。</p><p>Microsoft マネージド条件付きアクセス ポリシーは、Microsoft Entra ID P1 および P2 ライセンスをお持ちのお客様を対象にしたものです。P1 および P2 ライセンスをお持ちであるにもかかわらず、まだ条件付きアクセス ポリシーを有効活用していないと思われるお客様に対して、弊社がお客様テナントに自動的に条件付きアクセス ポリシーを作成します。この機能の有効化対象となったお客様には、以下の 3 つのポリシーがテナントに自動的に作成されます (後述しますように自動的に作成される条件があるため必ずしも 3 つ全てが作成されるわけではありません)。</p><ul><li>Microsoft 管理ポータルへアクセスする管理者に多要素認証を必須とする</li><li>“ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする</li><li>リスクの高いサインインに対して多要素認証と再認証を必須とする</li></ul><p>これらのポリシーはレポート専用モードで作成されます。このため即時にユーザーに影響はなく、アクセスがブロックされたり MFA が要求されたりすることはありません。また、これらのポリシーが仮に有効化された場合に想定されるユーザー影響についてのレポートも生成されます。</p><p>Microsoft マネージド条件付きアクセス ポリシーは、作成されてから 90 日間レポート専用モードの状態が維持されます。その間に管理者がポリシーを有効もしくは無効とすることが可能です。無効化せずにレポート専用モードの状態を維持した場合、90 日間の猶予期間の後に、ポリシーは有効となります。ポリシーが有効になると、ポリシーの対象となるユーザーは各ポリシーの条件に従って多要素認証が要求され、より高いセキュリティで保護されることになります。</p><h1 id="各ポリシーの詳細"><a href="#各ポリシーの詳細" class="headerlink" title="各ポリシーの詳細"></a>各ポリシーの詳細</h1><p>3 つの Microsoft マネージド条件付きアクセス ポリシーは、それぞれ作成条件が異なります。どのポリシーがお客様テナントで作成されるかはテナントの設定や状況に依存します。テナントによっては、3 つのポリシー全てが作成される場合もあれば、一部のポリシーのみ作成される場合や、どのポリシーも作成されない場合もあります。</p><p>それぞれのポリシーについての概要および作成の対象となるテナントに以下におまとめしました。</p><div class="alert is-info"><p class="alert-title">Note</p><p>Microsoft マネージド 条件付きアクセス ポリシーの自動作成は、2023 年 11 月から 12 月後半に順次行われます。このため現時点でこれらのポリシーはお客様のテナントに存在しない可能性があります。ポリシーの作成はシステムにより自動的に行われるため、どのテナントにいつポリシーが作成されるかを弊社からお答えすることは困難です。現時点でポリシーがテナントに存在しなくても、焦らずお待ちください。お客様テナントが以下の条件に合致してポリシーが自動作成されても 90 日の猶予があるため、その間にお客様影響が及ぶことはありません。 </p></div><h2 id="Policy-1-Microsoft-管理ポータルへアクセスする管理者に多要素認証を必須とする"><a href="#Policy-1-Microsoft-管理ポータルへアクセスする管理者に多要素認証を必須とする" class="headerlink" title="Policy 1 : Microsoft 管理ポータルへアクセスする管理者に多要素認証を必須とする"></a>Policy 1 : Microsoft 管理ポータルへアクセスする管理者に多要素認証を必須とする</h2><p>このポリシーは、特権を持つ管理者ロールを対象に、Microsoft 管理ポータルにアクセスする際に多要素認証を要求します。このポリシーでは、以下の 14 の Microsoft Entra ロールが対象となります。</p><ul><li>グローバル管理者</li><li>アプリケーション管理者</li><li>認証管理者</li><li>課金管理者</li><li>クラウド アプリケーション管理者</li><li>条件付きアクセス管理者</li><li>Exchange 管理者</li><li>ヘルプデスク管理者</li><li>パスワード管理者</li><li>特権認証管理者</li><li>特権ロール管理者</li><li>セキュリティ管理者</li><li>SharePoint 管理者</li><li>ユーザー管理者</li></ul><p>また、このポリシーは、以下の管理ポータルへのアクセスが対象となります。</p><ul><li>Azure ポータル</li><li>Exchange 管理センター</li><li>Microsoft 365 管理センター</li><li>Microsoft 365 Defender ポータル</li><li>Microsoft Entra 管理センター</li><li>Microsoft Intune 管理センター</li><li>Microsoft Purview コンプライアンス ポータル</li></ul><p>このポリシーは、以下の 2 つの条件を両方満たすテナントに自動的に作成されます。</p><ul><li>「セキュリティの既定値群」機能が無効である</li><li>月間アクティブ管理者ユーザー分の Microsoft Entra ID P1 または P2 のライセンスがテナントに存在する</li></ul><h2 id="Policy-2-“ユーザーごとの-MFA”-機能を使用しているユーザーに多要素認証を必須とする"><a href="#Policy-2-“ユーザーごとの-MFA”-機能を使用しているユーザーに多要素認証を必須とする" class="headerlink" title="Policy 2 : “ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする"></a>Policy 2 : “ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする</h2><p>このポリシーは、”ユーザーごとの MFA” 機能を使用しているユーザーを対象に、全てのクラウド アプリにアクセスする際に MFA を要求します。このポリシーは、”ユーザーごとの MFA” 機能と同様に動作します。”ユーザーごとの MFA” 機能はレガシーな機能として非推奨であるため、”ユーザーごとの MFA” 機能から「条件付きアクセスを用いた多要素認証を要求する構成」への移行を促すポリシーとなります。</p><p>このポリシーは、以下の 3 つの条件をすべて満たすテナントに自動的に作成されます。</p><ul><li>「セキュリティの既定値群」機能が無効である</li><li>“ユーザーごとの MFA” 機能で MFA が有効/強制されているユーザーが 500 未満である</li><li>上記ユーザー数分の Microsoft Entra ID P1 または P2 ライセンスがテナントに存在する</li></ul><h2 id="Policy-3-リスクの高いサインインに対して多要素認証と再認証を必須とする"><a href="#Policy-3-リスクの高いサインインに対して多要素認証と再認証を必須とする" class="headerlink" title="Policy 3 : リスクの高いサインインに対して多要素認証と再認証を必須とする"></a>Policy 3 : リスクの高いサインインに対して多要素認証と再認証を必須とする</h2><p>このポリシーは、テナント内のすべてのユーザーを対象とし、リスクの高いサインインを検出した場合に多要素認証と再認証を要求します。</p><p>「リスクの高いサインイン」とは、ユーザーのサインインが通常とは異なる場合を意味します。たとえば、通常とは異なる移動、パスワード スプレー攻撃、トークンの問題などが含まれます。これらのリスク定義の詳細については、<a href="https://learn.microsoft.com/ja-jp/entra/id-protection/concept-identity-protection-risks#sign-in-risk-detections">リスク検出とは</a>の記事を参照ください。</p><p>このポリシーは、以下の 2 つの条件を両方満たすテナントに自動的に作成されます。 </p><ul><li>月間アクティブ ユーザー分の Microsoft Entra ID P2 ライセンスがテナントに存在する</li><li>リスク ベースの条件付きアクセス ポリシーが構成されていない  </li></ul><h1 id="よくあるご質問"><a href="#よくあるご質問" class="headerlink" title="よくあるご質問"></a>よくあるご質問</h1><p>以下に、 Microsoft マネージド 条件付きアクセス ポリシーについて、お問い合わせの多いご質問を Q&amp;A 形式でおまとめいたしました。</p><hr><p><span style="color:green">Q</span>. いつ Microsoft マネージド条件付きアクセス ポリシーが作成されますか？</p><p><span style="color:red">A</span>. Microsoft マネージド条件付きアクセス ポリシー (以降ポリシー) は、2023 年 11 月から 12 月後半にかけて作成されます。</p><hr><p><span style="color:green">Q</span>. まだ自社テナントに Microsoft マネージド条件付きアクセス ポリシーがありません。いつ作成されるか具体的な日時を教えてくれますか？</p><p><span style="color:red">A</span>. 恐れ入りますが、いつどのテナントに Microsoft マネージド条件付きアクセス ポリシーが作成されるかをお答えすることは困難です。ポリシーの作成はシステムにより自動的に順次行われます。恐れ入りますが、現時点でポリシーがテナントに存在しなくても、焦らずお待ちください。弊社サポートにお問い合わせをいただいても、確実な答えは致しかねます。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーが作成されると、どのような影響がありますか？</p><p><span style="color:red">A</span>. これらのポリシーは、レポート専用モードで作成されるため、即時に影響はありません。これらのポリシーは、90 日間レポート専用モードの状態が維持され、その間に管理者がポリシーを有効もしくは無効とすることが可能です。レポート専用モードを維持した場合、90 日間の猶予期間の後に、ポリシーは自動的に有効となります。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーを無効化することはできますか？</p><p><span style="color:red">A</span>. はい、ポリシーを無効にすることができます。自動有効化をご要望でない場合は、無効に設定してください。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーを無効化する方法を教えてください。</p><p><span style="color:red">A</span>. 条件付きアクセス ポリシーの設定ページから対象のポリシーを選択し、その状態 (“State”) を [無効] にご変更ください。</p><p><img src="/blog/azure-active-directory/microsoft-managed-conditional-access-policies/1.png"></p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーのポリシー内容を変更することはできますか？</p><p><span style="color:red">A</span>. Microsoft マネージド条件付きアクセス ポリシー自体の設定を変更することはできません。管理者が可能な操作はポリシーの状態の変更 (有効、無効またはレポート専用) と、除外対象として特定のユーザー、グループ、ロールを指定することのみです。ポリシーの内容を変更したい場合、該当のポリシーを複製することで、ご要件に沿って複製したポリシーをカスタマイズすることができます。自動的に作成されたポリシーを無効に設定し、複製を行いカスタマイズしたポリシーを有効とすることで、お客様のご要件に沿った内容のポリシーをご利用いただけます。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーを削除することはできますか？</p><p><span style="color:red">A</span>. いいえ、自動的に作成されたポリシー自体を削除することはできません。ポリシーが適用されないようにするためには、対象のポリシーを無効に設定してください。</p><hr><p><span style="color:green">Q</span>.  自社テナントの条件付きアクセス ポリシーの設定を見直す必要はありますか？</p><p><span style="color:red">A</span>. 必ずしもテナントの条件付きアクセス ポリシーを見直す必要はございませんが、この機会に、お客様のご要件に応じて必要なセキュリティ上の保護が適用されているか確認することをお勧めいたします。また、 Microsoft マネージド条件付きアクセス ポリシーは多くの利用シナリオにおいて、有効化しておくことが望ましい設定となりますので、すでに同様の設定を実施していない環境では、有効とすることを推奨します。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーが作成されるテナントの条件を教えてください。</p><p><span style="color:red">A</span>. それぞれの Microsoft マネージド ポリシーが作成される条件は以下のとおりです。</p><ul><li><p>Microsoft 管理ポータルへのアクセスする管理者に多要素認証を必須とするポリシー<br>セキュリティの既定値群が無効であり、かつ月間アクティブな管理者分の Microsoft Entra ID P1 または P2 のライセンスを持つテナントが対象となります。</p></li><li><p>“ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする Microsoft マネージド条件付きアクセス ポリシー<br>セキュリティの既定値群が無効であり、全てのユーザー分の Microsoft Entra ID P1 または P2 ライセンスを持ち、さらにユーザーごとの MFA が有効/強制されているユーザーが 500 未満のテナントが対象となります。</p></li><li><p>リスクの高いサインインに対して多要素認証と再認証を必須とするポリシー<br>月間アクティブユーザー分の Microsoft Entra ID P2 ライセンスを持ち、リスク ベースの条件付きアクセス ポリシーが構成されていないテナントが対象となります。</p></li></ul><hr><p><span style="color:green">Q</span>.  作成された Microsoft マネージド条件付きアクセス ポリシーはどこで確認できますか？</p><p><span style="color:red">A</span>.  Microsoft Entra ポータルまたは Azure ポータルの条件付きアクセス ポリシーの設定ページから、Microsoft マネージド条件付きアクセス ポリシーと作成数を確認することができます。</p><hr><p><span style="color:green">Q</span>.  テナントやユーザーの設定やライセンスを変更したら Microsoft マネージド条件付きアクセス ポリシーも変更されますか？</p><p><span style="color:red">A</span>. Microsoft マネージド ポリシーは、ポリシーが初めに作成された時点でのテナントの設定に依存します。一度ポリシーが追加されたら、テナントやユーザーの設定が変更されても、ポリシーの内容は変更されません。また、初めにポリシーが作成された時点で追加されなかったポリシーが、それ以降に追加されることもございません。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセス ポリシーが作成されるとライセンスは消費されますか？</p><p><span style="color:red">A</span>. Microsoft マネージド条件付きアクセス ポリシーの対象となるユーザーに自動的にライセンスが割り当てられることはありません。Microsoft マネージド条件付きアクセス ポリシーを利用される場合には、その対象となるユーザーへ Microsoft Entra ID P1 以上 (Policy3 の場合は Microsoft Entra ID P2) のライセンスを割り当てください。</p><hr><p><span style="color:green">Q</span>.  “ユーザーごとの MFA” の機能を現在利用しているかどうか、どうやって確認すればいいでしょうか？</p><p><span style="color:red">A</span>. “ユーザーごとの MFA” を利用しているかは [Azure Portal (portal.azure.com)] &gt; [Microsoft Entra ID (Azure Active Directory)] &gt; [ユーザー] &gt; [ユーザーごとの MFA] からご確認いただけます。対応する公開情報のページは<a href="https://learn.microsoft.com/ja-jp/entra/identity/authentication/howto-mfa-userstates#view-the-status-for-a-user">こちら</a>です。</p><p>一覧に表示されるユーザーの [MULTI-FACTOR AUTHENTICATION の状態] が [有効] もしくは [強制] となっている場合、”ユーザーごとの MFA” の機能により MFA が要求されています。<br>※ [MULTI-FACTOR AUTHENTICATION の状態] についてフィルターを利用した検索が可能です。</p><p><img src="/blog/azure-active-directory/microsoft-managed-conditional-access-policies/2.png"></p><hr><p><span style="color:green">Q</span>.  「”ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする Microsoft マネージド条件付きアクセス ポリシー」は、どのユーザーが対象になりますか？</p><p><span style="color:red">A</span>. このポリシーが作成された時点で、”ユーザーごとの MFA” 機能により多要素認証が有効または強制されている既存のユーザーが、ポリシーの対象となります。「”ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする Microsoft マネージド ポリシー」が追加された後に作成されたユーザーや新たに “ユーザーごとの MFA” を有効化されたユーザーは、このポリシーの対象とはなりません。</p><hr><p><span style="color:green">Q</span>.  「”ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする Microsoft マネージド条件付きアクセス ポリシー」が作成された後、”ユーザーごとの MFA” 機能の設定はどうなりますか？</p><p><span style="color:red">A</span>.  「”ユーザーごとの MFA” 機能を使用しているユーザーに多要素認証を必須とする Microsoft マネージド条件付きアクセス ポリシー」が作成された後も、”ユーザーごとの MFA” 機能の設定は以前の状態のまま維持されます。”ユーザーごとの MFA” 機能はレガシーな非推奨の機能であるため、条件付きアクセス ポリシーによる多要素認証への移行をお勧めします。Microsoft マネージド条件付きアクセス ポリシーの対象となったユーザーについては、”ユーザーごとの MFA” 機能による多要素認証の状態を無効へ変更ください。</p><hr><p><span style="color:green">Q</span>.  Microsoft マネージド条件付きアクセスポリシーは Azure AD B2C テナントに作成されますか？</p><p><span style="color:red">A</span>.  いいえ、Microsoft マネージド条件付きアクセスポリシーは Azure AD B2C テナントには作成されません。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure &amp;amp; Identity サポート チームです。&lt;/p&gt;
&lt;p&gt;今回は、最近お問い合わせをよくいただく「Microsoft マネージド条件付きアクセス ポリシー」についてです。Microsoft マネージド条件付きアクセス ポリシーについて、概要</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>パブリック プレビュー - Microsoft Graph アクティビティ ログが利用できるようになりました</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/graph-activity-log-in-preview/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/graph-activity-log-in-preview/</id>
    <published>2023-11-10T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.160Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID の小出です。</p><p>本記事は、 2023 年 10 月 13 日に公開されました <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/microsoft-graph-activity-log-is-now-available-in-public-preview/ba-p/3848269">Microsoft Graph Activity Log is Now Available in Public Preview</a> を分かりやすく日本語におまとめしなおした記事となります。ご不明点などございましたら、お気軽にサポートまでお問い合わせください。</p><hr><p>Microsoft Graph API に対してアプリケーションが何をしているのか気になったことはありませんでしょうか。今回、その詳細を確認できる Microsoft Graph アクティビティ ログがパブリック プレビューとして今回利用可能となりました。これにより、Microsoft Graph API を通じてテナントに対して行われるすべての要求を可視化できるようになりました。</p><p>パブリック プレビューは直近開始されたばかりです。お客様によってはまだ利用できない可能性もありますが、今後 2 週間以内にすべての地域で利用できるようになりますため、展開を少々お待ちください。</p><h2 id="できること"><a href="#できること" class="headerlink" title="できること"></a>できること</h2><p>現在でも、サインイン ログを収集して Microsoft Graph API に対する認証および認可アクティビティを分析したり、監査ログを収集して重要なリソースの変更を確認したりすることができます。Microsoft Graph アクティビティ ログを使用すると、サインイン ログでのトークン要求と監査ログでの最終的なリソースの変更に加えて、Microsoft Graph API 呼び出しの履歴 (読み取り、書き込み、削除) を調査できるようになります。</p><p>たとえば下記では、Microsoft Graph API に対する要求 URL (requestUrl) に /users が含まれるログを抽出したものになりますが、RequestUri を確認すると、getMemberGroups が呼び出されており、対象ユーザーが所属しているグループの情報を <a href="https://learn.microsoft.com/ja-jp/graph/api/directoryobject-getmembergroups?view=graph-rest-1.0&tabs=http">directoryObject: getMemberGroups</a> を利用して取得したことが分かります。また、実行された時刻や HTTP メソッド、IP アドレスなども確認可能です。</p><p><img src="/blog/azure-active-directory/graph-activity-log-in-preview/graph-activity-log-in-preview1.png"></p><p>Microsoft Graph アクティビティ ログには、リクエストとクライアントアプリケーションに関する情報が含まれます。一般的な使用例としては、次のようなものがあります:</p><ul><li>ユーザー アカウントが侵害された後、影響調査のためテナント内で行ったアクティビティを特定する。</li><li>Microsoft Graph API の不審/異常な使用を特定するための分析環境を構築する (すべてのユーザーを列挙するアプリケーションや、403 エラー多く引き起こしている偵察目的のリクエストの特定など)。</li><li>予期しない、または不必要に特権をもつアプリケーションを調査する。</li><li>テナントの帯域制限を使い果たすほどの極端な呼び出し量など、クライアント アプリケーションの問題または予期しない動作を特定する。</li></ul><p>ログの検索を行うためには、 Log Analytics でのクエリの書き方を理解する必要があります。今回はいくつかサンプルを紹介します。</p><p>過去1日以内にグループの変更または削除を要求したアプリケーションをまとめる: </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs</span><br><span class="line">| where TimeGenerated &gt; ago(1d)</span><br><span class="line">| where RequestUri contains &#x27;/group&#x27;</span><br><span class="line">| where RequestMethod != &quot;GET&quot;</span><br><span class="line">| summarize UriCount=dcount(RequestUri) by AppId, UserId, ServicePrincipalId, ResponseStatusCode</span><br></pre></td></tr></table></figure><p>認証に失敗した最近のリクエストを見る:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs</span><br><span class="line">| where TimeGenerated &gt; ago(1h)</span><br><span class="line">| where ResponseStatusCode == 401 or ResponseStatusCode == 403</span><br><span class="line">| project AppId, UserId, ServicePrincipalId, ResponseStatusCode, RequestUri, RequestMethod</span><br><span class="line">| limit 1000</span><br></pre></td></tr></table></figure><p>リクエスト数が上位 20 のアプリ インスタンスを取得する:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MicrosoftGraphActivityLogs</span><br><span class="line">| where TimeGenerated &gt; ago(1d)</span><br><span class="line">| summarize RequestCount=count() by AppId, IpAddress, UserAgent</span><br><span class="line">| sort by RequestCount</span><br><span class="line">| limit 20</span><br></pre></td></tr></table></figure><p><img src="/blog/azure-active-directory/graph-activity-log-in-preview/graph-activity-log-in-preview2.png"></p><p>Microsoft Graph アクティビティ ログは、上記のとおり Log Analytics にエクスポートして解析することが一般的ですが、診断設定からその他のストレージにもログをエクスポートできます。下記の画面で Microsoft Graph Activity Logs を選択し、エクスポート先となるサービスを選択します。Log Analytics 以外にも、ストレージ アカウントなどにエクスポートすることなども可能です。なお、Log Analytics Workspace に収集されたログでは、ポータル上でのクエリ実行、アラート、クエリの保存機能、ワークブックなど、Azure Monitor Logs の全機能を使用できるため、単にログを保管するだけでなく追跡や監視を行いたい場合に便利です。</p><p><img src="/blog/azure-active-directory/graph-activity-log-in-preview/graph-activity-log-in-preview3.png"></p><p>詳細につきましては、以下の公開情報も併せてご確認ください。</p><p><a href="https://learn.microsoft.com/ja-jp/graph/microsoft-graph-activity-logs-overview">Microsoft Graph アクティビティ ログにアクセスする (プレビュー)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID の小出です。&lt;/p&gt;
&lt;p&gt;本記事は、 2023 年 10 月 13 日に公開されました &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blo</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ID を使用した Windows ローカル管理者パスワードソリューションの一般提供を開始しました！</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available!/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available!/</id>
    <published>2023-11-09T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.860Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 名取 です。</p><p>本記事は、2023 年 10 月 23 日に米国の Azure Active Directory Identity Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/windows-local-administrator-password-solution-with-microsoft/ba-p/3911999">Solution with Microsoft Entra ID now Generally Available!</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>本日、Microsoft Entra ID と <a href="https://learn.microsoft.com/ja-jp/mem/intune/protect/windows-laps-overview">Microsoft Intune</a> を使用した <a href="https://learn.microsoft.com/ja-jp/entra/identity/devices/howto-manage-local-admin-passwords">Windows Local Administrator Password Solution (LAPS)</a> の一般提供を発表できることを嬉しく思います。この機能は、Microsoft Entra 参加済みデバイスと Microsoft Entra ハイブリッド参加済みデバイスの両方で使用できます。これにより、すべての組織が Windows 上のローカル管理者アカウントを保護してセキュリティを確保し、<a href="https://www.microsoft.com/en-us/download/details.aspx?id=36036">Pass-the-Hash(PtH)</a> およびラテラル トラバーサル型の攻撃を軽減できるようになります。</p><p>2023 年 4 月のパブリック プレビューの発表以来、数千のお客様と数百万のデバイスで Windows LAPS の展開と利用が大幅に進んでいることに、感謝申し上げたいと思います。</p><p>この機能は、2023 年 4 月 11 日以降の Windows Update がインストールされた以下の Windows OS プラットフォームで利用可能です:</p><ul><li>Windows 11 22H2 </li><li>Windows 11 21H2 </li><li>Windows 10 20H2, 21H2 and 22H2 </li><li>Windows Server 2022 </li><li>Windows Server 2019 </li></ul><p>Windows LAPS のクライアント側設定を管理するには以下を使用します:</p><ul><li>MDM 管理された Microsoft Entra 参加/ハイブリッド参加デバイス用の <a href="https://learn.microsoft.com/ja-jp/windows/client-management/mdm/laps-csp">Windows LAPS 構成サービス プロバイダー (CSP)</a></li><li>Microsoft Entra ハイブリッド参加デバイス用の <a href="https://learn.microsoft.com/ja-jp/windows-server/identity/laps/laps-management-policy-settings#windows-laps-group-policy">Windows LAPS グループ ポリシー オブジェクト (GPO)</a></li></ul><p>お客様からのフィードバックに基づいて、さらに多くの機能のサポートを追加しています。現在は以下のようなことが可能です:</p><ul><li><strong>Windows LAPS を有効にする</strong> には、テナント全体のポリシーとクライアント側のポリシーを使用します。これによりローカル管理者パスワードが Microsoft Entra ID にバックアップされます。</li><li><strong>クライアント ポリシーを構成する</strong> には Microsoft Intune ポータルを使用し、ローカル管理者のパスワード管理用にアカウント名、パスワードの有効期限、長さ、複雑さ、パスワードの手動リセットなどを設定できます。</li><li><strong>パスワードを回復する</strong> 際は、Microsoft Entra/Microsoft Intune ポータルまたは Microsoft Graph API/PSH を利用できます。</li><li><strong>すべての LAPS 対応デバイスを列挙する</strong> には、Microsoft Entra ポータルまたは Microsoft Graph API/PSH を利用できます。</li><li><strong>Microsoft Entra ID のロールベースのアクセス制御 (RBAC) ポリシーを作成する</strong> ことで、カスタム ロールと管理単位を使用してパスワード回復の権限を付与できます。</li><li><strong>監査ログを確認する</strong> ことで、Microsoft Entra ポータルまたは Microsoft Graph API/PSH 経由で、パスワードの更新および取得イベントを監視できます。</li><li><strong>条件付きアクセス ポリシーを構成する</strong> ことでパスワード回復の権限を持つディレクトリ ロールを保護できます。</li></ul><p><img src="/blog/azure-active-directory/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available!/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available_1.png"></p><p><img src="/blog/azure-active-directory/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available!/Windows-Local-Administrator-Password-Solution-with-Microsoft-Entra-ID-now-Generally-Available_2.png"></p><p>今後提供予定の (ロードマップにある) 機能:</p><ul><li>Windows LAPS が設定された場合にローカル管理者アカウントを自動作成。</li><li>ローカル管理者パスワードが認証に使用された場合にデバイスが Microsoft Entra ID に通知。</li><li>デバイス所有者が自身で (セルフサービスで) ローカル管理者パスワードを必要な時間だけ回復。</li></ul><p>いつものように、皆様からのフィードバック、ご意見、ご提案をお待ちしております！ <a href="https://feedback.azure.com/d365community/forum/22920db1-ad25-ec11-b6e6-000d3a4f0789">Microsoft Entra ID フォーラム</a>でぜひ共有ください。皆様のご意見をお待ちしております。 </p><p>Sandeep Deo (@<a href="https://twitter.com/MsftSandeep">MsftSandeep</a>)<br>Principal Product Manager<br>Microsoft Identity Division</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 名取 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 23 日に米国の Azure Active Directory Identity Blog で公開された &lt;a href=&quot;https://techc</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>AADSTS75011 エラーを回避するための根本対処にはアプリケーション側での対処が必要です!</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/aadsts75011/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/aadsts75011/</id>
    <published>2023-11-06T15:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.868Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの沓澤です。</p><p>SAML 連携をしているアプリケーション (SP) にサインインをしようとした際に、AADSTS75011 エラーが生じるというお問い合わせを定期的にいただきます。</p><p>AADSTS75011 エラーの画面を Microsoft Entra ID が提供しているものの、AADSTS75011 エラーを根本的に回避したい場合には SP 側での対処が必要です。</p><p>本記事では AADSTS75011 エラーの原因と SP 側での対処案について説明します。</p><p>AADSTS75011 エラーについてまとめられた以下の公開情報を基に説明します。</p><p><a href="https://learn.microsoft.com/ja-jp/troubleshoot/azure/active-directory/error-code-aadsts75011-auth-method-mismatch">エラー - サービスで認証されたユーザーが要求された認証方法 AuthnContextClassRef と一致しない AADSTS75011 認証方法</a></p><h2 id="AADSTS75011-エラーの発生原因"><a href="#AADSTS75011-エラーの発生原因" class="headerlink" title="AADSTS75011 エラーの発生原因"></a>AADSTS75011 エラーの発生原因</h2><p>SP で指定された AuthnContext と、サインインを試行したユーザーの AuthnContext が異なる場合に AADSTS75011 エラーが発生します (AuthnContext: 認証方法)。</p><p>例をあげると、SP が機密情報にアクセスするようなアプリケーションであるために証明書ベースの認証を期待しているものの、サインインを試行したユーザーがパスワード ベースでの認証を完了している場合にこのエラーが発生します (下図参照)。<br><img src="/blog/azure-active-directory/aadsts75011/75011_user_password.png" alt="75011-1"></p><p>赤線部分にユーザーが実際に使用した認証方法が記載され、青線部分が SP が期待する認証方法が記載されています。</p><p>他 SP へのサインイン時にパスワード ベースの認証をして SSO を完了させた場合に、この証明書ベースの認証を期待する SP にサインインをするときには対話的な認証が生じずに、パスワード ベースでの認証が済んでいるという状態で非対話的にサインインを試行する動作をします。</p><blockquote><p>[!NOTE]<br>証明書ベースの認証として判定される例としては、以下のような認証方法を使用した場合です</p><ul><li>Microsoft Entra CBA</li><li>AD FS での証明書認証</li><li>Windows Hello for Business を使用した PRT での認証</li><li>Microsoft Authenticator を使用したパスワードレス認証</li></ul></blockquote><h3 id="AADSTS75011-エラーが生じるタイミング"><a href="#AADSTS75011-エラーが生じるタイミング" class="headerlink" title="AADSTS75011 エラーが生じるタイミング"></a>AADSTS75011 エラーが生じるタイミング</h3><p>AADSTS75011 エラーの根本的対処には SP 側での対処が必要であるため、お客様には根本的対処の可否について SP 側へのお問い合わせ等を検討いただいております。</p><p>SP 側へお問い合わせをいただく際により詳細な情報が必要というお客様も多くいらっしゃいましたので、本記事では SAML プロトコルのシーケンスと合わせ、AADSTS75011 エラーが生じるタイミングについて説明します。</p><p>下図は SAML プロトコルのシーケンスです。<br><img src="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/media/single-sign-on-saml-protocol/saml-single-sign-on-workflow.png" alt="SAMLprotocol"></p><p>AADSTS75011 エラーが生じるタイミングは、上図の 4 と 5 の間です。<br>そのため、エラーが生じるまでの流れを説明します。</p><ol><li><code>User</code> が <code>Service Provider</code> (<code>SP</code>) にアクセスします。</li><li><code>SP</code> はユーザーを認証するために Microsoft Entra ID にリダイレクトするよう <code>User</code> に指示します (SP によって Microsoft Entra ID へのリダイレクトが行われるきっかけは異なります)。<br>このとき SP は SAML リクエストを含むリダイレクト先 URL を生成します (<a href="https://login.microsoftonline.com/">https://login.microsoftonline.com/</a><tenantid>/saml2?SAMLRequest=xxx)。</li></ol><p><strong>この SAML リクエストの中に <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/single-sign-on-saml-protocol#requestedauthncontext">RequestedAuthnContext</a> 要素が含まれています。</strong><br>RequestedAuthnContext 要素は、SP がユーザーに対して要求する認証方法を指定するための要素です。<br>つまり、ここで証明書ベースの認証を指定したりなどの認証方法の指定ができます。</p><ol><li><code>User</code> のブラウザーを通して、2. で <code>SP</code> が指示したリダイレクト先 (Microsoft Entra ID) にリクエストが生じます。</li><li>サインインを試行するユーザーの認証状況を確認します。Microsoft Entra ID で認証済みの場合は通常は 5 への進みます。<br>ただ、SAML リクエストの中に RequestedAuthnContext が含まれる際には、直近で使用した認証方法を確認します。</li></ol><p><strong>このとき、直近で使用した認証方法 (<code>User</code> が使用した認証方法) と RequestedAuthnContext で指定された認証方法 (<code>SP</code> が指定した認証方法) とが異なる場合に AADSTS75011 エラーが発生します。</strong></p><p>SP 側で認証方法を指定するのが先であり、Microsoft Entra ID 側で認証方法の一致を判定するのが後です。</p><p>そのため、根本対処としては SP 側での対処が必要であるエラーではあるものの、Microsoft Entra ID 側でエラー画面を表示されます。</p><h2 id="SP-側での-AADSTS75011-エラーの対処案について"><a href="#SP-側での-AADSTS75011-エラーの対処案について" class="headerlink" title="SP 側での AADSTS75011 エラーの対処案について"></a>SP 側での AADSTS75011 エラーの対処案について</h2><p>対処案としては以下 2 つです。</p><ul><li>SAML リクエスト内の “RequestedAuthnContext” 要素 を省略する</li><li>SAML リクエスト内の “ForceAuthn” 要素を true に変更する</li></ul><p>それぞれ説明します。</p><h3 id="SAML-リクエスト内の-“RequestedAuthnContext”-要素-を省略する"><a href="#SAML-リクエスト内の-“RequestedAuthnContext”-要素-を省略する" class="headerlink" title="SAML リクエスト内の “RequestedAuthnContext” 要素 を省略する"></a>SAML リクエスト内の “RequestedAuthnContext” 要素 を省略する</h3><p>SAML リクエストは前項の通り、一般的にはアプリケーション側で生成されます。</p><p>そのため、SAML リクエストの変更可否についてもアプリケーション観点での調査が必要です。</p><p>アプリケーションによっては管理画面から “RequestedAuthnContext” 要素の省略を設定できるものもあります。</p><p>参考 (外部サイト): <a href="https://slack.com/intl/ja-jp/help/articles/203772216-SAML-%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%AB%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%AA%E3%83%B3#enterprise-grid-%E3%83%97%E3%83%A9%E3%83%B3-1">SAML シングルサインオン | Slack</a></p><blockquote><ol start="10"><li>SAML のレスポンスとアサーションに署名するかどうかを選択します。お使いの IDP で End to End Encryption (E2EE) キー が必要な場合には、「AuthnRequest に署名する」の横にあるチェックボックスを選択して、証明書を表示します。「AuthnContextClassRef」の値も環境に応じて設定できます。</li></ol></blockquote><p>AuthnContextClassRef は RequestedAuthnContext 要素内で定義する要素です。</p><p>SP の管理者または利用者からの “RequestedAuthnContext” 要素の変更可否についてはアプリケーション側へのお問い合わせ等をご検討ください。</p><h4 id="▼-省略すべきかの判断について"><a href="#▼-省略すべきかの判断について" class="headerlink" title="▼ 省略すべきかの判断について"></a>▼ 省略すべきかの判断について</h4><p>判断についてはお客様での最終判断が必要です。</p><p>ただ、よくお問い合わせで見かけるパターンとして、SP 側が認証強度が弱い認証方法を指定している状況で、ユーザーが認証強度が SP 側が指定する認証方法よりも高い認証方法を使用したためにエラーが生じるというケースが多く見られます。</p><p>具体的に例を挙げると、 SP 側でパスワード ベースの認証方法を指定しているものの、ユーザーが証明書ベースの認証を使用している場合です。<br>一般的にパスワード ベースの認証よりも証明書ベースの認証の方が認証強度が高いとされています。</p><p>認証強度が高い認証方法を使用中のユーザーをブロックする理由がなければ、”RequestedAuthnContext” の省略について前向きに検討いただくのが良いかと存じます。</p><h3 id="SAML-リクエスト内の-“ForceAuthn”-要素を-true-に変更する"><a href="#SAML-リクエスト内の-“ForceAuthn”-要素を-true-に変更する" class="headerlink" title="SAML リクエスト内の “ForceAuthn” 要素を true に変更する"></a>SAML リクエスト内の “ForceAuthn” 要素を true に変更する</h3><p>SAML リクエスト内に <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/single-sign-on-saml-protocol#authnrequest">ForceAuthn</a> 要素を含め、その値を true とすることで、SP にサインインする度に認証が要求されます。</p><p>認証が要求されましたら、SP が期待するの認証方法で認証を実行ください。</p><p>SAML リクエスト内に ForceAuthn 要素を true として指定できるかどうかについては、RequestedAuthnContext の変更可否同様に、アプリケーション側へお問い合わせ等をご検討ください。</p><p>また、上述のとおり、SP にサインインする都度、対話的な認証が要求されることが想定動作であるため、ユーザーの利便性を考慮した上でのご検討をお願いいたします。</p><h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>本記事では AADSTS75011 エラーの原因と SP 側での対処案について主に説明しました。</p><p>現時点では認証方法の不一致が原因で AADSTS75011 エラーが発生した場合、Microsoft Entra ID 観点で実施できる対処策がないため、上記情報を参考に対処策を検討いただけますと幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの沓澤です。&lt;/p&gt;
&lt;p&gt;SAML 連携をしているアプリケーション (SP) にサインインをしようとした際に、AADSTS75011 エラーが生じるというお問い合わせを定期的にいただきます。&lt;/p&gt;
&lt;p&gt;AADS</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="SAML" scheme="https://jpazureid.github.io/blog/tags/SAML/"/>
    
  </entry>
  
  <entry>
    <title>通知メールにおける優先言語の選定ロジック</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/preferred-language-in-identity-governance/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/preferred-language-in-identity-governance/</id>
    <published>2023-11-06T15:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.436Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は、2023 年 10 月 17 日に公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/entra-id-now-enables-you-to-receive-emails-in-your-preferred/ba-p/3939717">Entra ID now enables you to receive emails in your preferred language.</a> の記事を日本語に分かりやすくおまとめしなおした記事となります。ご不明点などございましたら、お気軽にサポートまでお問い合わせをいただけますと幸いです。</p><hr><p>PIM やアクセス レビューなど、主に Microsoft Entra ID P2 の機能では、ロールの割り当てやアクセス レビューの結果などが E メールにて通知されます。この E メール通知の言語について、「日本語で受信したい」もしくは「英語で受信してしまったが、どの設定で制御されているのか分からない」などのフィードバックやお問い合わせを多くいただいておりました。</p><p>今回、どの言語で通知 E メールを受信するかについて、決定ロジックが明確化されました。このロジックを使用した E メール通知の言語決定は、特権 ID 管理 (PIM)、アクセス レビュー、およびエンタイトルメント管理で利用できます。</p><p><img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language1.png"></p><p>言語が決定されるまでの流れは下記のとおりです。</p><ol><li><p>システムはまずユーザーの通知言語をチェックします。</p><ul><li>Entra ID ユーザーは、myprofile.microsoft.com または myaccount.microsoft.com 経由で自身の言語設定を更新できます。更新する権限がない場合は、管理者が優先言語を更新します。</li><li>システムは、Entra ID ユーザーオブジェクトに優先言語が設定されているかどうかを確認し、指定されていればその言語を使用します。</li></ul><p> My Account の画面では、下記にて言語設定を行えます。</p><p> <img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language2.png"></p><p> また、優先言語の設定はユーザーの preferredLanguage 属性で管理されています。この属性はユーザーのプロファイル画面にて確認できます。</p><p> <img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language3.png"></p></li><li><p>ユーザーごとの言語設定がない場合、ユーザーが E メールボックスを持っていて、その E メールボックスに優先言語が設定されているかどうかをチェックします。両方のチェックが真であれば、システムは E メールボックス設定で設定された優先言語を使用します。これは Exchange Online に E メールボックスを持つユーザーに対してのみ機能します。</p><p> Outlook on the web にて設定を開くと、言語を確認もしくは選択することができます。</p><p> <img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language4.png"></p></li><li><p>上記のいずれも設定されていない場合、システムはテナントの優先言語にテナントの国コードを連結したもの（例: fr-FR や ja-JP）を使用します。</p><p> テナントに優先言語が設定されていて、国コードが設定されていない場合、システムはテナントの優先言語を使用して、ローカライズされたテンプレートから最も近い利用可能なロケールを探します。例えば、fr-CA が見つからない場合、フォールバック先の言語は fr-FR となります。たとえば以下の場合、通知言語は英語になっておりますので、 通知言語としては en、テナントとしての国は JP となります。しかし、en-JP というコードはないため、en- にて利用できる国として en-US にフォールバックし、通知は英語で受信される仕組みとなります。</p><p> <img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language5.png"></p></li><li><p>上記がすべてない場合、システムは既定で en-us (英語) を通知言語として使用します。</p><p> 以上のようなロジックで制御がなされますので、設定により画面左のように英語で受信したり、右のようにスペイン語で受信したりと、言語を制御することができます。</p><p> <img src="/blog/azure-active-directory/preferred-language-in-identity-governance/language6.png"></p></li></ol><p>なお、新規ゲストが My Access でアクセス パッケージをリクエストした際は、リクエスト時のブラウザの言語設定に基づいて希望する言語が記憶されます。これにより、新規ゲストは、自身が理解できる言語で E メールを受信することができます。</p><p>現在、このロジックは上記の機能でのみ利用可能ですが、今後さらに多くの機能でこのロジックが利用できるようになる予定ですので、PIM やエンタイトルメント管理を現在利用されていないお客様も、今後のアップデートをお待ちください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 17 日に公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blo</summary>
      
    
    
    
    
    <category term="Identity Governance" scheme="https://jpazureid.github.io/blog/tags/Identity-Governance/"/>
    
  </entry>
  
  <entry>
    <title>ビジネス ゲスト向けの Microsoft Entra ID Governance ライセンスについて</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/Microsoft-Entra-ID-Governance-licensing-for-business-guests/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/Microsoft-Entra-ID-Governance-licensing-for-business-guests/</id>
    <published>2023-11-04T16:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.856Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 竜 です。</p><p>本記事は、2023 年 11 月 3 日に米国の Azure Active Directory Identity Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/microsoft-entra-id-governance-licensing-for-business-guests/ba-p/3575579">Microsoft Entra ID Governance licensing for business guests</a> を意訳したものになります。</p><hr><p>2023 年 7 月 1 日に Microsoft Entra ID Governance がリリースされて以来、何千ものお客様が従業員の ID を管理することの重要性を実感し、Microsoft Entra ID Governance をテストまたは導入されています。その中で多くのお客様から、このガバナンス機能を請負業者、パートナー、および社外の共同作業者などのビジネス ゲストの ID に拡張し、シームレスなコラボレーションを可能にしながらも、最小特権アクセスの原則に十分に従う方法についてご質問をいただいていました。</p><p>組織がこの状況をより簡単に管理できるようにするために、この度、ビジネス ゲスト向けの新しい ID Governance のライセンス体系を発表いたします。このライセンスは、月間アクティブ ユーザー (MAU: Monthly Active Usage) モデルで運用されます。お客様は、予想されるビジネス ゲスト の MAU に合わせてライセンスを取得することができます。</p><p>お客様がビジネス ゲストへの最小特権アクセスを拡大できるよう、ビジネス ゲスト向け ID Governance ライセンスの価格は MAU あたり0.75 ドルとし、2024 年春に提供を開始する予定です。それまでの間、ID Governance 機能で従業員の ID を管理している組織は、追加のコストなしにビジネス ゲストの ID を管理いただけます。既存の Microsoft Entra External ID のお客様は、Entra ID P1 および P2 に含まれる ID Governance 機能の一部を引き続き使用することができます。</p><h2 id="ビジネス-ゲストの-ID-を管理する理由"><a href="#ビジネス-ゲストの-ID-を管理する理由" class="headerlink" title="ビジネス ゲストの ID を管理する理由"></a>ビジネス ゲストの ID を管理する理由</h2><p>ビジネス ゲストは、特定の目的および期間にて、組織のリソースやアプリケーションへのアクセスを必要とする外部の協力者のことを指します。ビジネス ゲストには、請負業者、コンサルタント、ベンダー、パートナーなどが含まれます。ビジネス ゲストは多くの場合、社内リソースへのアクセスの要件が動的で予測不可能であり、社内のポリシーや標準に従っていない可能性があるため、ID のガバナンスが困難になりがちです。適切なガバナンスがなければ、ビジネス ゲストは過剰な特権アカウント、利用されず放置されたアカウント、不正アクセスなどのアクセス リスクを引き起こす可能性があります。</p><p>Microsoft Entra ID Governance を用いると、以下のような機能により課題に対処できます: </p><ul><li>スポンサー、承認、認証の必要性など、ビジネス ゲストに対するアクセス ポリシーを定義し実施する</li><li>プロジェクトまたは契約期間に基づいて、ビジネス ゲストのアカウントのプロビジョニングとデプロビジョニングを自動化する</li><li>ビジネス ゲストによるアクセス状況や行動を監視および監査し、異常や違反を検出して修復する</li><li>社内スポンサーがリクエストをレビューし、承認する方法を提供する</li></ul><p>このステップにより、お客様は組織内のすべての ID を確実に管理することができます。お客様のデジタル資産を保護するために弊社をお選びくださり感謝申し上げます。</p><p>Kaitlin Murphy<br>Director, Product Marketing</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 竜 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 11 月 3 日に米国の Azure Active Directory Identity Blog で公開された &lt;a href=&quot;https://techcom</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra ID Governance のアクセス レビューを用いて非アクティブなユーザーの棚卸をする方法</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/step-guide-access-review/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/step-guide-access-review/</id>
    <published>2023-10-29T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.512Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは！ Azure ID チームの小出です。</p><p>本記事は、2023 年 10 月 10 日に公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/step-by-step-guide-to-identify-inactive-users-by-using-microsoft/ba-p/3944705">Step-by-Step Guide to Identify Inactive Users by using Microsoft Entra ID Governance Access Reviews</a> をもとに、日本語に分かりやすくおまとめした記事となります。<br>ご不明点などございましたら、お気軽にサポートまでお問い合わせください。</p><hr><p>まず、<a href="https://www.cisecurity.org/controls/cis-controls-navigator">CIS Control V8 Safe guard 5.3</a> によると、利用されていないアカウントについては 45 日経過をもって削除するか無効化することが推奨されています。この推奨事項は、<a href="https://learn.microsoft.com/ja-jp/security/benchmark/azure/security-controls-v3-privileged-access#pa-4-review-and-reconcile-user-access-regularly">Azure Security Benchmark v3 PA-4 Control</a> にも沿ったもので、ユーザー アクセスを定期的にレビューすることが推奨されています。以下の NIST の資料も併せてご参照ください。</p><p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf">NIST SP 800-53 Revision 5 Moderate Baseline - AC-2(3) Control</a></p><p>日本語では、以前ゲストの棚卸方法として <a href="https://jpazureid.github.io/blog/azure-active-directory/GuestUser-Inventory/">ゲスト ユーザーの棚卸をする方法</a> を案内しておりますので、今回はゲストにかかわらず、アクセス レビューを利用して非アクティブなユーザーを抽出および検出する方法について案内いたします。また、以前は Azure ポータルでの手順を案内しておりますが、今回は新しく利用できるようになった Entra 管理センターを利用して設定を行います。</p><h2 id="Microsoft-Entra-管理センターでのアクセス-レビューの作成方法"><a href="#Microsoft-Entra-管理センターでのアクセス-レビューの作成方法" class="headerlink" title="Microsoft Entra 管理センターでのアクセス レビューの作成方法"></a>Microsoft Entra 管理センターでのアクセス レビューの作成方法</h2><ol><li><p>Entra 管理センターを開き、[Identity Governance] 内のアクセス レビューをクリックします。新しいアクセス レビューをクリックし新規レビューの作成を開始します。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review1.png"></p></li><li><p>下記のようにそれぞれ選択します。</p><table><thead><tr><th align="left">項目</th><th align="left">設定</th></tr></thead><tbody><tr><td align="left">レビュー対象を選択する</td><td align="left">チームとグループ</td></tr><tr><td align="left">範囲の確認</td><td align="left">チームとグループの選択</td></tr><tr><td align="left">グループ</td><td align="left">レビュー対象にしたいグループを選択し指定してください</td></tr><tr><td align="left">スコープ</td><td align="left">すべてのユーザー</td></tr><tr><td align="left">★ 非アクティブなユーザー（テナント レベル）のみ</td><td align="left">チェックをオンにします</td></tr><tr><td align="left">★  非アクティブな日数</td><td align="left">既定は 30 日です</td></tr></tbody></table><p> ★  がついている項目を指定するためには、 Azure AD Premium P2 ライセンスでも不十分であり、Microsoft Entra ID Governance の購入が必要です。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review2.png"></p></li><li><p>レビュー担当者と頻度を決定します。設定は環境に応じて任意に実施いただければと存じますが、1 回きりのレビューではなく毎月や毎年などの継続レビューにすると、定期的にレビューを行えます。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review3.png"></p></li><li><p>レビューが完了した時の設定を指定します。こちらも設定は任意ですが、よく設定いただく項目としては、下記がございます。</p><table><thead><tr><th align="left">項目</th><th align="right">設定</th></tr></thead><tbody><tr><td align="left">リソースへの結果の自動適用</td><td align="right">チェックをオンにします</td></tr><tr><td align="left">30 日間サインインなし</td><td align="right">チェックをオンにします</td></tr></tbody></table><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review4.png"></p></li><li><p>レビューに名前を付けて作成します。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review5.png"></p></li><li><p>レビュー担当者に下記のようなメールが届くので、リンクをクリックして開始します。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review6.png"></p></li><li><p>下記画面にて、承認・拒否を決定してレビューを実施します。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review7.png"></p><p> 各ユーザーをクリックすると、推奨事項の詳細メッセージを確認することも可能です。</p><p> <img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review8.png"></p></li></ol><h3 id="補足-非アクティブなユーザーに関するライセンスについて"><a href="#補足-非アクティブなユーザーに関するライセンスについて" class="headerlink" title="補足: 非アクティブなユーザーに関するライセンスについて"></a>補足: 非アクティブなユーザーに関するライセンスについて</h3><p>上記手順にて ★ がついている項目を指定するためには、 Azure AD Premium P2 ライセンスでは不足する旨を案内しました。こちらの設定を行う場合、Microsoft Entra ID Governance のライセンスを購入いただく必要があります。</p><p>この ★ がついているチェックをオンにすると、レビューの対象として画面に表示されるユーザーが、非アクティブなユーザーのみとなります。直近サインインのあるユーザーは、グループのメンバーでもレビューの対象とはなりません。</p><table><thead><tr><th align="left">項目</th><th align="left">設定</th></tr></thead><tbody><tr><td align="left">★ 非アクティブなユーザー（テナント レベル）のみ</td><td align="left">チェックをオンにします</td></tr><tr><td align="left">★ 非アクティブな日数</td><td align="left">既定は 30 日です</td></tr></tbody></table><p>新しいライセンスを購入するのが難しい場合、レビューの対象者自体を絞り込むことはできませんが、代わりに下記設定を Azure AD Premium P2 にて利用可能です。そのため、下記チェックボックスをオンにし、推奨事項の項目を確認しながら、全ユーザーのレビューを実施いただけますと幸いです。</p><p><img src="/blog/azure-active-directory/step-guide-access-review/step-guide-access-review9.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは！ Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 10 日に公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blo</summary>
      
    
    
    
    
    <category term="Identity Governance" scheme="https://jpazureid.github.io/blog/tags/Identity-Governance/"/>
    
    <category term="Access Review" scheme="https://jpazureid.github.io/blog/tags/Access-Review/"/>
    
  </entry>
  
  <entry>
    <title>オンプレミスのパスワード変更で Microsoft Entra ID Protection のユーザー リスクを修復する</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/Remediate-User-Risks-in-Microsoft-Entra-ID-Protection-Through-On-premises-Password-Changes/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/Remediate-User-Risks-in-Microsoft-Entra-ID-Protection-Through-On-premises-Password-Changes/</id>
    <published>2023-10-22T01:00:00.000Z</published>
    <updated>2023-12-09T07:21:27.856Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 竜 です。</p><p>本記事は、2023 年 9 月 28 日に米国の Azure Active Directory Identity Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/remediate-user-risks-in-microsoft-entra-id-protection-through-on/ba-p/3773129">Remediate User Risks in Microsoft Entra ID Protection Through On-premises Password Changes</a> を意訳したものになります。</p><hr><p>ユーザー リスクに基づいてゼロ トラストの考えのもとセキュリティ侵害を防止することが、今日のデジタル環境において大変重要です。しかし、ハイブリッド環境におけるユーザー リスクの管理には、いくつもの課題がありました。この度、ハイブリッド環境におけるユーザー リスクの管理をより容易にするべく、Microsoft Entra ID Protection (旧 Azure AD Identity Protection) において、<strong>オンプレミスのパスワード変更によりユーザー リスクを修復できる</strong> ようになりました。</p><p>これまで、Microsoft Entra ID のパスワード保護機能を活用するために、Microsoft としては Microsoft Entra ID でパスワード変更を管理することを推奨していましたが、一方でこれにより、オンプレミスでパスワード変更を行うハイブリッド環境をご利用のお客様にとっては、ユーザー リスク ポリシーを有効化しづらい状況がありました。というのも、オンプレミスでパスワード変更を行っても Microsoft Entra ID Protection に反映されなかったため、リスクによりユーザーがブロックされた場合にオンプレミスでパスワード リセットしてもリスクをクリアできず、ユーザー自身で自己修復することができない状況でした。オンプレミスでのパスワード変更によりリスク修復ができない結果、リスクがある (リスクが修復されていない) と判断されるユーザーが増えていくため、一部のお客様では Microsoft Entra ID Protection によるリスク検出を利用することや、ハイブリッド環境のテナントを保護するためにリスク ベースのポリシーを活用することが難しい状況でした。</p><p>この課題を解決するため、Microsoft Entra ID Protection に「オンプレミスのパスワード変更によるユーザー リスクのリセットを許可する」 という新しい機能を導入しました。テナントでパスワード ハッシュ同期を有効にしているお客様は、この機能を有効化することができます。本機能を有効化すると、パスワードがオンプレミスで変更された場合に、ユーザーのリスクが自動的に修復されるようになります。このため、お客様はユーザー リスク ポリシーを導入し、ハイブリッドのユーザーを効果的に保護することができます。</p><p><img src="/blog/azure-active-directory/Remediate-User-Risks-in-Microsoft-Entra-ID-Protection-Through-On-premises-Password-Changes/1.png"></p><p>本機能によるセキュリティの向上により、お客様は 2 つの主要な利点を享受いただけます:</p><ul><li>効率的な修復: 本機能により、管理者による手動での操作を必要とせず、リスクの高いハイブリッド ユーザーは効率的に自己修復を行うことができるようになり、管理者の負担が軽減されます。オンプレミスでパスワードが変更されると、ユーザーのリスクは Entra ID Protection 内で自動的に修復され、ユーザーを安全な状態に戻すことができます。</li><li>プロアクティブなセキュリティ: ハイブリッド環境とユーザーを確実に保護するために、組織はパスワードの変更を要求するユーザー リスク ポリシーをプロアクティブに導入できるようになりました。このプロアクティブなアプローチにより、アクセス制御ポリシーによるセキュリティ管理を簡素化させつつ、複雑なハイブリッド環境であってもユーザー リスクに迅速に対処できるようになり、より組織のセキュリティ体制を強化することができます。</li></ul><p>今すぐ <a href="https://entra.microsoft.com/#view/Microsoft_AAD_IAM/IdentityProtectionMenuBlade/~/OverviewNew">Identity Protection - Microsoft Entra 管理センター</a> で 「オンプレミスのパスワード変更によるユーザー リスクのリセットを許可する」設定を有効化ください。詳細については、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/identity-protection/howto-identity-protection-remediate-unblock">リスクを修復してユーザーをブロック解除する</a> もご覧ください。</p><p>弊社は、最善のセキュリティ ソリューションを提供するために、サービスの継続的な改善に取り組んでいます。今後とも Microsoft Entra ID Protection をよろしくお願いいたします。</p><p>Stay safe out there,<br>Alex Weinert (@Alex_T_Weinert)<br>VP Director of Identity Security, Microsoft     </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 竜 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 9 月 28 日に米国の Azure Active Directory Identity Blog で公開された &lt;a href=&quot;https://techcom</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Entra の更新情報</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/what-s-new-in-microsoft-entra/</id>
    <published>2023-10-22T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.544Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Azure Identity サポート チームの 高田 です。</p><p>本記事は、2023 年 10 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/what-s-new-in-microsoft-entra/ba-p/3796395">What’s new in Microsoft Entra</a> を意訳したものになります。ご不明点等ございましたらサポート チームまでお問い合わせください。</p><hr><p>マイクロソフトはこのほど、お客様のセキュリティ態勢の改善を目的として、Microsoft Entra 製品ファミリーにさまざまな新しいセキュリティ ツールと機能を導入しました。サイバー攻撃がますます巧妙化し、クラウドベースのサービスやモバイル デバイスの利用が増加する中、組織がセキュリティを管理するための効果的なツールを導入することは不可欠となっています。</p><p>本日は、前四半期 (2023 年 7 月～ 9 月) の新機能リリースと変更アナウンス (2023 年 9 月の変更管理) を紹介します。また、これらの変更点は <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/whats-new">リリースノート</a> や電子メールでもお知らせしています。弊社では、お客様が新しい <a href="https://entra.microsoft.com/">Entra 管理センター</a> 内でライフサイクルの変更 (非推奨、廃止、サービスの破壊的変更) をより簡単に管理できるように引き続き取り組んでおります。</p><p>これらの最近のアップデートは、Microsoft Entra の製品エリアごとに整理されており、より簡単に最新のアップデートを見つけてアクセス出来るようにいたしました。これらの新機能により、お客様に対し ID およびアクセス ソリューションを提供してまいります。</p><h2 id="製品の更新情報のまとめ"><a href="#製品の更新情報のまとめ" class="headerlink" title="製品の更新情報のまとめ"></a>製品の更新情報のまとめ</h2><ul><li>Microsoft Entra ID</li><li>Microsoft Entra ID Governance</li><li>Microsoft Entra Workload ID</li><li>Microsoft Entra External ID</li></ul><h2 id="Microsoft-Entra-ID"><a href="#Microsoft-Entra-ID" class="headerlink" title="Microsoft Entra ID"></a>Microsoft Entra ID</h2><p>新機能のリリース</p><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/howto-authentication-methods-activity#how-it-works">認証方法アクティビティのダッシュボード</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/advancing-modern-strong-authentication/">iOS および macOS ブラウザーでの FIDO2 サポート</a></li><li><a href="https://learn.microsoft.com/ja-jp/education/windows/federated-sign-in?tabs=intune">Windows 用の Web サインイン</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/conditional-access-overview-and-templates/">条件付きアクセスの概要ダッシュボード</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/conditional-access-overview-and-templates/">条件付きアクセスのテンプレート</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/concept-conditional-access-cloud-apps#microsoft-admin-portals-preview">条件付きアクセスにおける Microsoft 管理ポータルのサポート</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/concept-conditional-access-cloud-apps">条件付きアクセス ポリシーにおける My Apps の対象/対象外</a></li><li><a href="https://learn.microsoft.com/ja-jp/microsoft-365/security/defender/investigate-alerts?view=o365-worldwide">M365 Defender における Identity Protection アラート</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/conditional-access-for-protected-actions/">保護されたアクションのための条件付きアクセス</a></li><li><a href="https://learn.microsoft.com/ja-jp/entra/global-secure-access/how-to-universal-tenant-restrictions">テナント制限 v2</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/how-to-customize-branding">会社のブランドにおけるサインインとサインアップページの先進的な拡張機能</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/how-to-customize-branding">セルフサービス パスワード リセット (SSPR) のハイパーリンクのカスタマイズ機能</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/roles/custom-user-permissions">カスタム ロールを用いたユーザー管理の委任</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/add-users">ユーザー作成とユーザー招待機能の改善</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/manage-apps/manage-application-permissions?pivots=portal#review-and-revoke-permissions">以前に付与されたテナント全体でのアクセス許可の取り消し</a></li><li><a href="https://support.microsoft.com/ja-jp/account-billing/%E3%83%9D%E3%83%BC%E3%82%BF%E3%83%AB%E3%81%A7%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E6%83%85%E5%A0%B1%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B-bc0ca998-6d3a-42ac-acb8-e900fb1174a4">新しい My Groups のユーザー体験</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/reports-monitoring/recommendation-migrate-from-adal-to-msal?tabs=Microsoft-Graph-API">新しい Azure AD 推奨事項: ADAL から MSAL への移行</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/hybrid/connect/how-to-connect-fed-group-claims">Saas アプリ用に SAML トークンにグループ名を埋め込む</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/jwt-claims-customization#claim-transformations">OIDC を用いたエンタープライズ アプリ用のクレームのカスタマイズ</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/manage-apps/delete-recover-faq#how-do-i-restore-deleted-applications-or-service-principals-">削除済みアプリケーションとサービス プリンシパルの復元</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/api/authenticationmethodsroot-list-userregistrationdetails?view=graph-rest-1.0&tabs=http">認証方法のレポート API</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/whats-new#general-availability---microsoft-authentication-library-for-net-4550">Microsoft Authentication Library for .NET 4.55.0</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/fundamentals/whats-new#general-availability---microsoft-authentication-library-for-python-1230">Microsoft Authentication Library for Python 1.23.0</a></li></ul><h3 id="変更のアナウンス"><a href="#変更のアナウンス" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="FIDO2-認証方法の変更"><a href="#FIDO2-認証方法の変更" class="headerlink" title="FIDO2 認証方法の変更"></a>FIDO2 認証方法の変更</h4><p>[お客様によっては対応が必要です]</p><p><strong>2024 年 1 月</strong> より、Microsoft Entra ID は、従来の FIDO2 セキュリティ キーのサポートに加え、パブリック プレビューの認証方法として、コンピューターやモバイル デバイスに保存された <a href="https://passkeys.dev/docs/reference/terms/#device-bound-passkey">デバイスに紐づくパスキー</a> をサポートします。これにより、ユーザーは既に保持しているデバイスを使ってフィッシング耐性のある認証を利用することができるようになります。</p><p>このプレビュー リリースに際し、既存の FIDO2 認証方法ポリシーとエンドユーザー向けの登録エクスペリエンスを拡張する予定です。お客様の組織が物理的なセキュリティ キーのみを使用した FIDO2 認証を必要とする、もしくは要望する場合は、許容できるセキュリティ キー モデルのみを FIDO2 ポリシーにて許可するようキーの制限を実施ください。そうでない場合は、新しいプレビュー機能により、Windows、macOS、iOS、Android に保存されたデバイスに紐づくパスキーの登録が可能になります。FIDO2 キー制限の詳細については、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/howto-authentication-passwordless-security-key">こちら</a> をご覧ください。</p><h4 id="Azure-AD-Graph-の新着情報"><a href="#Azure-AD-Graph-の新着情報" class="headerlink" title="Azure AD Graph の新着情報"></a>Azure AD Graph の新着情報</h4><p>[お客様によっては対応が必要です]</p><p>3 年間の非推奨期間の後、Azure AD Graph API が廃止 (シャットダウン) `のサイクルに入ることを <a href="https://jpazureid.github.io/blog/azure-active-directory/important-azure-ad-graph-retirement-and-powershell-module/">2023 年 6 月に発表</a> しました。これは、API の廃止までに最低 2 年間の非推奨期間を約束するという <a href="https://learn.microsoft.com/ja-jp/graph/versioning-and-support">破壊的変更に関するポリシー</a> に沿ったものです。また 6 月には、この廃止は段階的に行われ、各段階の合間には事前通知を行うと説明しました。最初の段階では、新しく作成されたアプリケーションは既定で Azure AD Graph API を使用できなくなります。</p><p>現時点で共有できる実質的なアップデートは限られていますが、ここで暫定的なアップデートを提供したいと思います。弊社の目標は、このサービス終了を通してお客様と協力しサポートする中で、透明性を保ち、定期的なコミュニケーションの流れを確立することです。</p><h5 id="2023-年-9-月の情報"><a href="#2023-年-9-月の情報" class="headerlink" title="2023 年 9 月の情報"></a>2023 年 9 月の情報</h5><ol><li>一部のお客様から、廃止される Azure AD Graph API を使用しているアプリケーションを特定したり、どのような規模で使用しているのかを確認したりするのが難しいとのご意見をいただいております。弊社では現在、さらなる混乱を避けるために <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/reports-monitoring/overview-recommendations">ID の推奨事項機能</a> を通じて、更新や修正が必要なアプリケーションを特定し、優先順位をつけるために必要な情報を提供する分析機能の提供に取り組んでいます。この機能のリリース予定日は近日中にお知らせします。</li><li>事前の連絡で説明したように、Azure AD Graph API 廃止の第一段階では、新規に作成された <a href="https://learn.microsoft.com/ja-jp/graph/api/resources/application?view=graph-rest-1.0">アプリケーション</a> が既定で Azure AD Graph API を使用できないようにする変更が行われます。この変更が行われる際は最低 3 ヶ月の事前通知を提供します。この最初の段階では、新しく作成されたアプリケーションのみが影響を受け、既存のアプリケーションは影響を受けません。</li></ol><p>近い将来に、Microsoft Graph にまだ移行していない (新規) アプリケーションで混乱が生じないよう必要なタイムラインとアクションの詳細をお知らせします。新規に作成されたアプリケーションが Azure AD Graph API を使用できなくなる日付はまだ決まっていませんが、明確な情報の提供に向けて鋭意努力しております。この終了予定の API サービスからアプリケーションを移行されているお客様を支援する機能を提供してまいります。</p><h5 id="必要なアクション"><a href="#必要なアクション" class="headerlink" title="必要なアクション"></a>必要なアクション</h5><p>Azure AD Graph を使用しているアプリケーションを特定し、同等の Microsoft Graph API を使用するように移行ください。Microsoft Graph は、Microsoft Entra、Exchange、Teams、SharePoint、および Microsoft 365 の全ポートフォリオを含む、多くの Microsoft サービスに統一された機能豊富な API プラットフォームです。</p><p>参考: <a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-overview">Azure Active Directory (Azure AD) Graph から Microsoft Graph への移行</a></p><p>その他のリソース:</p><ul><li><a href="https://learn.microsoft.com/ja-jp/graph/migrate-azure-ad-graph-planning-checklist">Azure AD Graph アプリの移行計画チェックリスト</a></li><li><a href="https://github.com/microsoft/AzureADGraphApps">Azure AD Graph を使用している可能性のあるアプリを特定するスクリプト</a></li></ul><h4 id="Entra-ID-Protection-から-Conditional-Access-にサインイン-リスク-ポリシーとユーザー-リスク-ポリシーを移行"><a href="#Entra-ID-Protection-から-Conditional-Access-にサインイン-リスク-ポリシーとユーザー-リスク-ポリシーを移行" class="headerlink" title="Entra ID Protection から Conditional Access にサインイン リスク ポリシーとユーザー リスク ポリシーを移行"></a>Entra ID Protection から Conditional Access にサインイン リスク ポリシーとユーザー リスク ポリシーを移行</h4><p>[お客様によっては対応が必要です]</p><p>現在 Entra ID Protection (旧 Identity Protection) でユーザー リスク ポリシーまたはサインイン リスク ポリシーを有効にしている場合は、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies#migrate-risk-policies-from-identity-protection-to-conditional-access">これらの手順</a> に従って 条件付きアクセスに移行することをお勧めします。 Entra ID Protection のこれら 2 つのリスク ポリシーの画面は、<strong>2026 年 10 月 1 日</strong> に廃止されます。</p><p>条件付きアクセスでのサインイン リスクとユーザー リスク ポリシーの設定には以下のような利点があります。</p><ul><li>すべてのアクセス ポリシーを 1 か所で管理できます。</li><li>レポート専用モードと Graph API がサポートされます。</li><li>場所などの他の条件と組み合わせて、きめ細かいアクセス制御が可能になります。</li><li>異なるユーザー グループやリスク レベルに対して複数のリスクベースのポリシーを適用して、セキュリティを強化できます。</li><li>サインイン ログでどのリスクベースのポリシーが適用されたかを表示できるため、詳細の把握が容易です。</li></ul><p>今日から移行を開始しください。リスクベースのポリシーについての詳細は <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/identity-protection/concept-identity-protection-policies">Microsoft Entra リスクベースのアクセス ポリシー</a> をご覧ください。</p><h4 id="レガシーな多要素認証-MFA-とセルフサービスパスワードリセット-SSPR-ポリシーでの認証方法の管理の廃止日が更新"><a href="#レガシーな多要素認証-MFA-とセルフサービスパスワードリセット-SSPR-ポリシーでの認証方法の管理の廃止日が更新" class="headerlink" title="レガシーな多要素認証 (MFA) とセルフサービスパスワードリセット (SSPR) ポリシーでの認証方法の管理の廃止日が更新"></a>レガシーな多要素認証 (MFA) とセルフサービスパスワードリセット (SSPR) ポリシーでの認証方法の管理の廃止日が更新</h4><p>[お客様によっては対応が必要です]</p><p><a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-change-announcements-march-2023-train/">2023 年 3 月の変更通知</a> で、レガシーな <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/howto-mfa-mfasettings#verification-methods">MFA</a> および <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-sspr-howitworks#authentication-methods">SSPR</a> ポリシーでの認証方法の管理を 2024 年 9 月 30 日に廃止すると発表しました。この日付は <strong>2025 年 9 月 30 日</strong> に延期されました。</p><p>組織は、パスワードレス、多要素認証、セルフサービス パスワード リセットなど、すべての認証シナリオで認証方法を一元的に管理できる統合された認証方法ポリシーに <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-authentication-methods-manage">移行</a> する必要があります。<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-methods-manage">Azure AD での認証方法の管理</a> について詳しくはこちらをご覧ください。</p><h4 id="登録キャンペーンの改善"><a href="#登録キャンペーンの改善" class="headerlink" title="登録キャンペーンの改善"></a>登録キャンペーンの改善</h4><p>[お客様によっては対応が必要です]</p><p>ユーザーが <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752">SMS や音声などの公衆交換電話網 (PSTN) を極力利用しないようにする</a> ため、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-mfa-registration-campaign">登録キャンペーン機能</a> の改善に取り組んでいます。ユーザーはプロンプトを最大 3 回までスキップできますが、その後は登録操作を実行する必要があります。なお、管理者は、最大 3 回のスキップ設定を無効にするか、エンド ユーザーが無期限にスキップ出来るようにするかを選択可能です。</p><p>次に、Microsoft マネージド状態にある Entra ID テナントについては、MFA に SMS や音声などの PSTN メソッドのみを使用しているユーザーに対して、この登録キャンペーン機能を自動的に有効にします。<strong>2023 年 9 月</strong> から、Entra ID Premium テナント向けにこの変更を段階的に展開していきます。</p><h4 id="ユーザーごとの-MFA-ポリシーにおける-Authenticator-Lite-のサポート"><a href="#ユーザーごとの-MFA-ポリシーにおける-Authenticator-Lite-のサポート" class="headerlink" title="ユーザーごとの MFA ポリシーにおける Authenticator Lite のサポート"></a>ユーザーごとの MFA ポリシーにおける Authenticator Lite のサポート</h4><p>[お客様によっては対応が必要です]</p><p><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-mfa-authenticator-lite">Authenticator Lite</a> は、Microsoft Authenticator のような認証のプッシュ通知を他の Microsoft アプリケーションにも提供する比較的新しい機能です。最初にサポートされるアプリケーションは Outlook モバイルです。電話に別の仕事用アプリをダウンロードできないか、あるいはダウンロードしたくないユーザーいる場合、すでにモバイル デバイスに Outlook を設定していれば、Microsoft Authenticator の代わりとして Outlook Mobile を利用いただけます。</p><p>現在、Authenticator Lite は、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-methods-manage#authentication-methods-policy">新しい認証方法ポリシー</a> で Microsoft Authenticator を管理している組織でのみ利用可能です。今後は、ユーザーごとの MFA ポリシーの「モバイル アプリによる通知」設定の一部としても利用可能になります。<strong>2023 年 9 月中旬</strong> から、「モバイル アプリによる通知」設定をユーザーごとの MFA ポリシーで有効にしていると、Authenticator Lite も有効になるように動作します。Authenticator Lite を使用したくない組織は、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-mfa-authenticator-lite#disabling-authenticator-lite-in-azure-portal-ux">こちらの手順</a> に従って無効にする必要があります。</p><h4 id="WhatsApp-経由の-MFA-OTP-配信の最適化"><a href="#WhatsApp-経由の-MFA-OTP-配信の最適化" class="headerlink" title="WhatsApp 経由の MFA OTP 配信の最適化"></a>WhatsApp 経由の MFA OTP 配信の最適化</h4><p>[お客様によっては対応が必要です]</p><p>現在、Entra ID (Azure AD) MFA は、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-phone-options#sms-message-verification">テキスト メッセージ (SMS)</a> を介してワン タイム パスコード (OTP) を配信しています。これらのテキスト (SMS) は、ユーザーの電話の OS に応じて、電話の既定のメッセージング アプリに送信されます。しかし、国によってはこれらの既定のアプリが必ずしもユーザーがよく使うメッセージ アプリとは限りません。ユーザーがよく使用するメッセージ プラットフォームで OTP を受け取れるようにするため、Entra ID は一部の地域で WhatsApp への OTP 配信を展開します。</p><p><strong>2023 年 9 月中旬</strong> から、インド、インドネシア、ニュージーランドのユーザーは WhatsApp 経由で MFA テキスト メッセージを受け取るようになる可能性があります。以下の基準に当てはまるユーザーには、この新しい変更が適用される可能性がありますが、必ずその動作となるわけではありません。</p><ul><li>認証方法としてテキスト メッセージ/SMS を有効にしている</li><li>すでに WhatsApp を使用している</li><li>上に挙げた国のいずれかの国コードを持つ電話番号を保持している</li></ul><p>上にあげた国にユーザーがいる組織で、ユーザーに WhatsApp 経由で MFA テキスト メッセージを受け取らせたくない場合は、テナント内でテキスト メッセージを認証方法として無効にする必要があります。認証方法を管理する場所によりますが、<a href="https://account.activedirectory.windowsazure.com/UserManagement/MfaSettings.aspx">ユーザーごとの MFA ポリシー</a> をご利用の場合は「電話へのテキスト メッセージ」を無効にし、<a href="https://entra.microsoft.com/#view/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/~/AdminAuthMethods/fromNav/Identity">認証方法ポリシー</a> を利用されている場合は「SMS」の設定を無効にする必要があります。</p><h4 id="My-Groups-管理コントロールの変更"><a href="#My-Groups-管理コントロールの変更" class="headerlink" title="My Groups 管理コントロールの変更"></a>My Groups 管理コントロールの変更</h4><p>[お客様側での対応は不要です]</p><p><strong>2024 年 6 月</strong> から、Microsoft Entra 管理センターにあるグループ管理の設定から「[自分のグループ] でのグループ機能に対するユーザー アクセス権を制限します。」という文言が廃止されます。これは、My Groups を無効にすることができなくなることを意味します。6 月には、My Groups でのセキュリティ グループの表示と管理をエンド ユーザーから出来ないようにする新しい設定が優先されるようになります。</p><p>この変更は自動的に行われます。管理者やユーザーは何もする必要はありません。</p><ul><li>[自分のグループ] からグループ機能に対するユーザー アクセスを制限するという既存の設定が はい に設定されている場合、新しい設定でも、ユーザーが My Groups でセキュリティ グループを表示および編集出来ないように制限します。 既存の設定が いいえ に設定されている場合、新しい設定では、My Groupsでセキュリティ グループが表示されます。</li></ul><p>詳細については、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/enterprise-users/groups-self-service-management#make-a-group-available-for-user-self-service">このドキュメント</a> を参照ください。なお、管理者は引き続き <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/enterprise-users/groups-self-service-management#group-settings">グループ設定</a> から、エンドユーザーが Microsoft 365 およびセキュリティ グループを作成できるかどうかを管理可能です。</p><h4 id="Graph-サービスエンドポイントでの-HTTP-2-の有効化"><a href="#Graph-サービスエンドポイントでの-HTTP-2-の有効化" class="headerlink" title="Graph サービスエンドポイントでの HTTP/2 の有効化"></a>Graph サービスエンドポイントでの HTTP/2 の有効化</h4><p>[お客様によっては対応が必要です]</p><p><a href="https://jpazureid.github.io/blog/azure-active-directory/Microsoft-Entra-change-announcements-September-2022-train/">2022 年 9 月の変更通知</a> で事前にお知らせしたとおり、Microsoft Graph のエンジニアリング チームは、<strong>2023 年 9 月 15 日</strong> から Microsoft Graph サービス エンドポイントで HTTP/2 のサポートを開始する予定です。HTTP/2 のサポートは、既存の HTTP/1.1 バージョンのサポートに加えて行われます。Microsoft Grap hエンドポイントで HTTP/2 が有効になると、HTTP/2 をサポートするクライアントは、Microsoft Graph へのリクエスト時にこのバージョンをネゴシエーションします。HTTP/2 仕様の改善の焦点は、パフォーマンス (特に遅延の改善) やネットワークおよびサービス リソースの使用料の低減 (参照: <a href="https://http2.github.io/">https://http2.github.io</a>) に関するものであり、多重化、並列化、バイナリ エンコーディングやヘッダー圧縮による効率性などが含まれます。これらの利点は、Microsoft Graph のクライアントと顧客にとって大きな価値を提供するものです。HTTP/2 は、HTTP/1.1 と完全に後方互換性があり、クライアント アプリケーションでコードの変更を必要としないことが期待されます。ただし、まれに、アプリケーションがヘッダー キーに関する HTTP 仕様 (大文字小文字を区別しない比較) に従っていない場合、一部のクライアント アプリケーションに悪影響が及ぶ可能性もあります。</p><h2 id="Microsoft-Entra-ID-Governance"><a href="#Microsoft-Entra-ID-Governance" class="headerlink" title="Microsoft Entra ID Governance"></a>Microsoft Entra ID Governance</h2><p>新機能のリリース</p><ul><li><a href="https://jpazureid.github.io/blog/azure-active-directory/entitlement-management-ga/">エンタイトルメント管理での Verified ID のチェック機能</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/entitlement-management-ga/">条件付きアクセスにおけるエンタイトルメント管理のサポート</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-id-governance-introduces-two-new-features-in-access-reviews/">レビュー担当者に対する機械学習に基づく推奨事項の提示</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/microsoft-entra-id-governance-introduces-two-new-features-in-access-reviews/">利用されていないユーザーに対しるアクセス レビュー</a></li><li><a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/microsoft-entra-id-governance-entitlement-management-new/ba-p/2466929">ユーザーによるアクセス要求ではなく自動的にアクセス パッケージを割り当てる</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/entitlement-management-ga/">お客様組織に特化したプロセスとビジネス ロジックでアクセス ライフサイクルを拡張する</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/entitlement-management-ga/">My Access の検索機能の改善</a></li><li><a href="https://learn.microsoft.com/ja-jp/graph/api/resources/entitlementmanagement-overview?view=graph-rest-1.0">エンタイトルメント管理の Graph API</a></li></ul><h2 id="Microsoft-Entra-Workload-ID"><a href="#Microsoft-Entra-Workload-ID" class="headerlink" title="Microsoft Entra Workload ID"></a>Microsoft Entra Workload ID</h2><p>新機能のリリース</p><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/concept-continuous-access-evaluation-workload">Workload ID に対する継続的アクセス評価</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/howto-configure-app-instance-property-locks">Workload ID 用のアプリケーション インスタンスのロック</a></li></ul><h2 id="Microsoft-Entra-External-ID"><a href="#Microsoft-Entra-External-ID" class="headerlink" title="Microsoft Entra External ID"></a>Microsoft Entra External ID</h2><p>新機能のリリース</p><ul><li><a href="https://jpazureid.github.io/blog/azure-active-directory/xtap-new-feature/">カスタムロールの作成とクロステナント アクセス設定管理の保護</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/xtap-new-feature/">クロステナント アクセス設定におけるパートナー数上限の撤廃</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/xtap-new-feature/">B2B 招待がクロステナント アクセスの設定を考慮</a></li></ul><h3 id="変更のアナウンス-1"><a href="#変更のアナウンス-1" class="headerlink" title="変更のアナウンス"></a>変更のアナウンス</h3><h4 id="B2B-サインイン体験の変更"><a href="#B2B-サインイン体験の変更" class="headerlink" title="B2B サインイン体験の変更"></a>B2B サインイン体験の変更</h4><p>[お客様側での対応は不要です]</p><p><strong>2023 年 9 月 30 日</strong> から、B2B コラボレーションを使用してテナントをまたいだサインインを行うエンドユーザーは、テナントのブランドの表示が変更されたことに気づくと思われます。サインイン時に、リソース テナントのブランドではなく、ホーム テナントのブランド（カスタマイズされていいない場合でも）が表示されるようになります。これは、ユーザーが自身のホーム アカウントにサインインしていることを明確にするためのものです。</p><p>この通知はお客様への通知を目的としたものであり、対応は必要ありません。<a href="https://learn.microsoft.com/ja-jp/entra/fundamentals/how-to-customize-branding#user-experience">詳細はこちら</a> をご覧ください。</p><p>よろしくお願いいたします。</p><p>Shobhit Sahay</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Azure Identity サポート チームの 高田 です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 2 日に米国の Microsoft Entra (Azure AD) Blog で公開された &lt;a href=&quot;https://techcommuni</summary>
      
    
    
    
    
    <category term="US Identity Blog" scheme="https://jpazureid.github.io/blog/tags/US-Identity-Blog/"/>
    
  </entry>
  
  <entry>
    <title>登録キャンペーンに関する Q&amp;A</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/registration-campaign-qanda/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/registration-campaign-qanda/</id>
    <published>2023-10-20T03:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.476Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは。Azure Identity サポート チームです。<br>現在、Microsoft Entra ID へのサインイン時に以下のような画面が表示され Microsoft Authenticator アプリのインストールが求められるというお問い合わせを多くいただいております。</p><p><img src="/blog/azure-active-directory/registration-campaign-qanda/registration-campaign-qanda1.png" alt="登録キャンペーンのメッセージ"></p><p>上記の画面は、下記公開情報に記載されている “登録キャンペーン” 機能における [Microsoft マネージド] 値が [有効] に変更されたために表示されています。</p><p><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-mfa-registration-campaign">Microsoft Authenticator を設定してもらうための登録キャンペーンを実行する方法 - Microsoft Authenticator</a></p><blockquote><p>サインイン時に Microsoft Authenticator をセットアップするようにユーザーにナッジすることができます。 ユーザーは通常のサインインを行い、いつもどおりに多要素認証を実行した後に、Microsoft Authenticator を設定するように求められます。</p></blockquote><p>こちらのブログでは、お問い合わせの多い登録キャンペーンに関するご質問について Q&amp;A 形式でおまとめいたしました。既存のドキュメントではカバーされていない動作やご質問について今後も適宜内容を拡充していきますので、ご参照いただけますと幸いです。</p><hr><h2 id="Q-登録キャンペーンの今回のアップデートについてはどこで通知されていますか？"><a href="#Q-登録キャンペーンの今回のアップデートについてはどこで通知されていますか？" class="headerlink" title="Q. 登録キャンペーンの今回のアップデートについてはどこで通知されていますか？"></a>Q. 登録キャンペーンの今回のアップデートについてはどこで通知されていますか？</h2><p>A. <a href="https://go.microsoft.com/fwlink/p/?linkid=2070717">Microsoft 365 管理センターのメッセージセンター</a> で、Microsoft Entra ID P1 または P2 テナントに対しては MC650420 にて、Microsoft Entra ID Free テナントに対しては MC584364 にてアナウンスされております。<br>Microsoft Entra ID Free テナントを対象とした展開は既に完了しておりますため、MC584364 は 2023 年 8 月 14 日に掲載が終了しております。</p><h2 id="Q-登録キャンペーンの今回のアップデートはいつから実施されますか？"><a href="#Q-登録キャンペーンの今回のアップデートはいつから実施されますか？" class="headerlink" title="Q. 登録キャンペーンの今回のアップデートはいつから実施されますか？"></a>Q. 登録キャンペーンの今回のアップデートはいつから実施されますか？</h2><p>A. 登録キャンペーン機能の [Microsoft マネージド] 値を [有効] とする変更は、Microsoft Entra ID P1 または P2 テナントに対しては 2023 年 9 月以降、Microsoft Entra ID Free テナントを対象とした展開は 2023 年 7 月以降より開始しております。<br>Microsoft Entra ID P1 または P2 テナントを対象とした展開は 10 月下旬までに完了することが予定されており、Microsoft Entra ID Free テナントを対象とした展開は既に完了している状態です。</p><h2 id="Q-登録キャンペーンの今回のアップデートはなぜ実施されるのですか？"><a href="#Q-登録キャンペーンの今回のアップデートはなぜ実施されるのですか？" class="headerlink" title="Q. 登録キャンペーンの今回のアップデートはなぜ実施されるのですか？"></a>Q. 登録キャンペーンの今回のアップデートはなぜ実施されるのですか？</h2><p>A. 以前のブログ記事 <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752">“認証に電話網を使うのはそろそろやめよう (It’s Time to Hang Up on Phone Transports for Authentication)”</a> で、SMS や音声などの多要素認証 (MFA) メカニズムの脆弱性について説明しておりました。<br>マイクロソフトの最近の MFA に関する調査研究によると、SMS は Microsoft Authenticator アプリと比較して、悪意のある攻撃者を阻止する効果が 40％ 低いと結論づけています。</p><p>電話ベースの認証から脱却することには明確な利点があるにもかかわらず、未だ MFA 要求の約 44 % が SMS や音声電話によるものとなっています。<br>ユーザーが先進的で強力な認証方法として Microsoft Authenticator アプリを設定できるようにするため、登録キャンペーンの既定の有効化が行われました。</p><h2 id="Q-登録キャンペーンの設定はどこから確認できますか？"><a href="#Q-登録キャンペーンの設定はどこから確認できますか？" class="headerlink" title="Q. 登録キャンペーンの設定はどこから確認できますか？"></a>Q. 登録キャンペーンの設定はどこから確認できますか？</h2><p>A. 登録キャンペーンの設定は、下記の画面よりご確認いただけます。<br><a href="https://portal.azure.com/">Azure ポータル</a> &gt; [Microsoft Entra ID] &gt; [セキュリティ] &gt; [認証方法] &gt; [登録キャンペーン]<br><a href="https://entra.microsoft.com/">Microsoft Entra 管理センター</a> &gt; [保護] &gt; [認証方法] &gt; [登録キャンペーン]</p><h2 id="Q-登録キャンペーンのメッセージをユーザーに表示させないようにするにはどうすればよいですか？"><a href="#Q-登録キャンペーンのメッセージをユーザーに表示させないようにするにはどうすればよいですか？" class="headerlink" title="Q. 登録キャンペーンのメッセージをユーザーに表示させないようにするにはどうすればよいですか？"></a>Q. 登録キャンペーンのメッセージをユーザーに表示させないようにするにはどうすればよいですか？</h2><p>A. Microsoft Authenticator アプリの登録を促すメッセージは、上記の設定画面から登録キャンペーンの [Microsoft マネージド] の状態を [無効] とすることで回避することが可能です。<br>ユーザーが Microsoft Authenticator アプリを利用することが難しい場合は、こちらの設定の変更をご検討いただけますと幸いです。</p><p><img src="/blog/azure-active-directory/registration-campaign-qanda/registration-campaign-qanda2.png" alt="登録キャンペーンの [状態] を変更する画面"></p><h2 id="Q-登録キャンペーンのメッセージの-今はしない-残り-3-回-の上限は変更できますか？"><a href="#Q-登録キャンペーンのメッセージの-今はしない-残り-3-回-の上限は変更できますか？" class="headerlink" title="Q. 登録キャンペーンのメッセージの [今はしない (残り 3 回)] の上限は変更できますか？"></a>Q. 登録キャンペーンのメッセージの [今はしない (残り 3 回)] の上限は変更できますか？</h2><p>A. 3 回まで延期が可能な設定か、無期限に延期が可能な設定のどちらかを選択いただけます。<br>[再通知の回数が制限されています] が [有効] な場合は、登録キャンペーンによる Microsoft Authenticator アプリの登録を 3 回まで延期することが可能です。<br>[無効] な場合は延期する回数に制限はなく [今はしない] という表示となります。</p><p>なお、既定の設定は [有効] となっており、3 回以上延期したユーザーは Microsoft Authenticator アプリを登録するまでサインインが不可となります。<br>[無効] とした場合は [再通知できる日数] で設定した間隔で再度メッセージが表示され続ける動作となりますが、延期する回数に制限はないため、サインインが不可となることはございません。</p><p><img src="/blog/azure-active-directory/registration-campaign-qanda/registration-campaign-qanda3.png" alt="登録キャンペーンの [再通知の回数が制限されています] を変更する画面"></p><h2 id="Q-登録キャンペーンのメッセージで-Microsoft-Authenticator-アプリを登録した後も-SMS-や音声電話は使用できますか？"><a href="#Q-登録キャンペーンのメッセージで-Microsoft-Authenticator-アプリを登録した後も-SMS-や音声電話は使用できますか？" class="headerlink" title="Q. 登録キャンペーンのメッセージで Microsoft Authenticator アプリを登録した後も SMS や音声電話は使用できますか？"></a>Q. 登録キャンペーンのメッセージで Microsoft Authenticator アプリを登録した後も SMS や音声電話は使用できますか？</h2><p>A. Microsoft Authenticator アプリの登録後に要求される MFA については、Microsoft Authenticator アプリのプッシュ通知に限らず、既に登録済みの SMS や音声電話による認証方法もご使用いただけます。</p><hr><h2 id="関連リンクまとめ"><a href="#関連リンクまとめ" class="headerlink" title="関連リンクまとめ"></a>関連リンクまとめ</h2><h3 id="本記事で引用・ご紹介した公開情報-再掲"><a href="#本記事で引用・ご紹介した公開情報-再掲" class="headerlink" title="本記事で引用・ご紹介した公開情報 (再掲)"></a>本記事で引用・ご紹介した公開情報 (再掲)</h3><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-mfa-registration-campaign">Microsoft Authenticator を設定してもらうための登録キャンペーンを実行する方法 - Microsoft Authenticator</a></li><li><a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752">認証に電話網を使うのはそろそろやめよう (It’s Time to Hang Up on Phone Transports for Authentication)</a></li></ul><h3 id="登録キャンペーンのアップデートの背景に関する公開情報"><a href="#登録キャンペーンのアップデートの背景に関する公開情報" class="headerlink" title="登録キャンペーンのアップデートの背景に関する公開情報"></a>登録キャンペーンのアップデートの背景に関する公開情報</h3><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-default-enablement#microsoft-managed-settings">Microsoft によって管理される設定 - Microsoft Entra ID の認証方法の保護</a></li><li><a href="https://jpazureid.github.io/blog/azure-active-directory/advancing-modern-strong-authentication/">登録キャンペーンによる先進的で強力な認証の推進 | Japan Azure Identity Support Blog</a></li></ul><p>上記の内容が少しでもお客様のご参考となりましたら幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは。Azure Identity サポート チームです。&lt;br&gt;現在、Microsoft Entra ID へのサインイン時に以下のような画面が表示され Microsoft Authenticator アプリのインストールが求められるというお問い合わせを多くいただい</summary>
      
    
    
    
    
    <category term="Azure AD" scheme="https://jpazureid.github.io/blog/tags/Azure-AD/"/>
    
    <category term="MFA" scheme="https://jpazureid.github.io/blog/tags/MFA/"/>
    
    <category term="Microsoft Authenticator" scheme="https://jpazureid.github.io/blog/tags/Microsoft-Authenticator/"/>
    
  </entry>
  
  <entry>
    <title>グループ向けの PIM と条件付きアクセスとの統合機能が一般公開されました！</title>
    <link href="https://jpazureid.github.io/blog/azure-active-directory/pim-for-group-ga/"/>
    <id>https://jpazureid.github.io/blog/azure-active-directory/pim-for-group-ga/</id>
    <published>2023-10-19T00:00:00.000Z</published>
    <updated>2023-12-09T07:21:28.424Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、 Azure ID チームの小出です。</p><p>本記事は、2023 年 10 月 3 日に公開された <a href="https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/just-in-time-access-to-groups-and-conditional-access-integration/ba-p/2466926">Just-in-time access to groups and Conditional Access integration in Privileged Identity Management</a> の記事を日本語に分かりやすくおまとめしなおした記事となります。ご不明点などございましたら、お気軽にサポートまでお問い合わせをいただけますと幸いです。</p><hr><p>今回、 PIM の機能に 2 つの新しい機能が追加され、下記 2 つの機能が一般公開 (GA) されました。</p><ul><li>グループ向けの PIM</li><li>PIM における条件付きアクセスとの統合</li></ul><p>今回は新しく一般公開された機能について、詳細をご紹介いたします。</p><h2 id="グループ向けの-PIM"><a href="#グループ向けの-PIM" class="headerlink" title="グループ向けの PIM"></a>グループ向けの PIM</h2><p>グループ向けの  PIM は、グループの所有者ロールおよびメンバー ロールを必要な時に必要な時間だけ付与するという JIT (Just-In-Time) アクセスの機能です。長らくプレビューとして利用可能だった機能で、当時は特権アクセス グループと呼ばれていましたが、現在の名称は「グループ向けの PIM」 です。</p><p>通常の PIM では、Azure AD ロールや RBAC をベースに、ユーザーもしくはグループに資格のある割り当てを付与し、必要な時だけアクティブ化すると、そのロールの機能を利用できるようになるといった考え方をします。グループ向けの PIM は、上記のようにロールの有無を制御するのではなく、グループの所属状況を制御する方法です。</p><p>具体的に、下記図を利用して説明します。</p><p> <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga1.png"></p><p>上記の図において PIM-managed group と記載されているのが、グループ向けの PIM を利用しているグループです。通常のグループの所有者やメンバーは、以下の画面にある [メンバー] や [所有者] のメニューを使用して管理されます。グループ向けの PIM を利用したい場合、下記画面からグループごとに有効化します。</p><p> <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga2.png"></p><p>グループに対してこの「グループ向けの PIM」機能を有効にすると、下記のような画面が表示され、通常の PIM の画面と同じように割り当ての追加や設定を行うことができます。</p><p> <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga3.png"></p><p> PIM-managed group と記載されている上の図に戻ります。図の内に表示されているユーザーはそれぞれ下記のとおりです。</p><ul><li>Member1 は、PIM-managed group のメンバーです。アクティブなメンバーのため、いつでもグループのメンバーとして、グループ画面の [メンバー] に表示されます。</li><li>Member2 と 3 は、資格のあるメンバーです。そのため、グループ画面の [メンバー] には通常表示されません。このグループの正式なメンバーとなりたいときにだけ、 PIM でグループのアクティブ化を行うと、正式なメンバーに一時的になることができます。これらのメンバーのグループへの割り当てを管理したい場合は、[Privileged Identity Management] の画面からおこなう必要があります。</li><li>Member3 と 4 は、資格のある所有者です。 PIM でグループのアクティブ化を行うと、所有者の権限を得ることが可能となります。上記メンバー ロールと同様に、所有者ロールも JIT で管理することができるようになります。</li></ul><p>通常の PIM では、Azure AD ロールと RBAC のみ管理できましたが、グループ向けの PIM はグループのメンバーと所有者を管理 (JIT アクセスの付与) を行えます。このため、Microsoft Intune や Microsoft 以外のアプリケーションのロールやサービスなど、グループを権限の付与に使用しているものであればグループ向けの PIM を活用することができます。</p><p>この度 GA したグループ向けの PIM では:</p><ul><li>ロール割り当て可能なグループおよびロール割り当て不可能なグループの両方がサポートされます (プレビュー時代、ロール割り当て可能なグループのみ利用できる機能でしたが、現在はロール割り当て可能なグループかどうかにかかわらず利用できます。)</li><li>セキュリティ グループと Microsoft 365 グループがサポートされます。</li><li>以前に存在していた 500 グループの上限は撤廃されました。</li></ul><p>グループ向けの PIM については、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/privileged-identity-management/concept-pim-for-groups">こちらの公開情報</a> も併せてご確認ください。</p><p>また、グループ向けの PIM を利用すると、Microsoft Defender や Intune の権限を管理することもできます。英語の記事ではございますが、下記にてこのシナリオに特化した手順の記載もありますので併せてご覧ください。</p><p><a href="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/configure-just-in-time-access-to-m365-defender/ba-p/3764564">Configure Just-in-Time Access to M365 Defender</a></p><p><a href="https://techcommunity.microsoft.com/t5/intune-customer-success/configuring-microsoft-intune-just-in-time-admin-access-with/ba-p/3843972">Configuring Microsoft Intune just-in-time admin access with Azure AD PIM for Groups</a></p><h2 id="条件付きアクセス認証コンテキストを利用した-PIM-の管理"><a href="#条件付きアクセス認証コンテキストを利用した-PIM-の管理" class="headerlink" title="条件付きアクセス認証コンテキストを利用した PIM の管理"></a>条件付きアクセス認証コンテキストを利用した PIM の管理</h2><p>これまで PIM のアクティブ化においては、 MFA や承認を要求することはできましたが、それ以上の細かいポリシーを適用することができませんでした。今回用意された条件付きアクセス認証コンテキストを利用すると、PIM の動作に対して条件付きアクセスが提供する細やかなポリシーを適用することができます。</p><p> <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga4.png"></p><p>具体的には、下記のような制御を実施可能です。</p><ul><li>条件付きアクセスの機能を利用して、強力な最新の認証方法 (高い認証強度) を要求する</li><li>ロールのアクティブ化に際し、準拠したデバイスからの操作を必須にする</li><li>GPS ベースのネームド ロケーションを利用し、位置情報を検証する</li><li>Identity Protection の機能を活用し、危険なユーザーはアクティブ化できないようにする</li></ul><p>具体的な活用方法を紹介します。この機能は Azure AD ロール、Azure RBAC、グループ向けの PIM すべてで利用可能です。</p><ol><li><p>Azure ポータルより、[条件付きアクセス] - [認証コンテキスト] の画面を開き、新しい認証コンテキストを追加します。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga5.png"></p></li><li><p>条件付きアクセス ポリシーを構成し、ターゲット リソースの項目にて、作成した認証コンテキストを選択します。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga6.png"></p></li><li><p>条件付きアクセス ポリシーで要求させたい操作を [許可] の画面で選択します。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga7.png"></p></li><li><p>PIM の設定画面を開き、[アクティブ化で必要] の項目にて [Azure AD 条件つきアクセス認証コンテキスト] を選択し、作成した認証コンテキストを指定します。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga8.png"></p></li><li><p>この状態で資格のある割り当てを持つユーザーがアクティブ化をしようとすると、下記のように追加認証が要求されます。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga9.png"></p></li><li><p>警告部分をクリックすると、 MFA 等が要求されるので操作を行います。MFA など追加認証が完了すると、アクティブ化操作を行えるようになります。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga10.png"></p></li><li><p>アクティブ化をクリックすると、他の設定項目などにもよりますが、アクティブ化を行うことが可能です。</p><p>  <img src="/blog/azure-active-directory/pim-for-group-ga/pim-for-group-ga11.png"></p></li></ol><p>認証コンテキストの詳細は、<a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/concept-conditional-access-cloud-apps#configure-authentication-contexts">こちらの公開情報</a> も併せてご確認ください。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、 Azure ID チームの小出です。&lt;/p&gt;
&lt;p&gt;本記事は、2023 年 10 月 3 日に公開された &lt;a href=&quot;https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog</summary>
      
    
    
    
    
    <category term="PIM" scheme="https://jpazureid.github.io/blog/tags/PIM/"/>
    
  </entry>
  
</feed>
